INSERT INTO foods (barcode, name, generic_name, brand, category, quantity, packaging, labels, origins, manufacturing_places, ingredients_text, allergens, traces, energy_kj, calories, fat_g, saturated_fat_g, carbs_g, sugars_g, fiber_g, protein_g, salt_g, sodium_mg, alcohol_g, monounsaturated_fat_g, polyunsaturated_fat_g, trans_fat_g, cholesterol_mg, omega3_g, added_sugars_g, starch_g, polyols_g, vitamin_a_ug, vitamin_d_ug, vitamin_e_mg, vitamin_k_ug, vitamin_c_mg, vitamin_b1_mg, vitamin_b2_mg, vitamin_b6_mg, vitamin_b9_ug, vitamin_b12_ug, vitamin_pp_mg, pantothenic_acid_mg, potassium_mg, calcium_mg, phosphorus_mg, iron_mg, magnesium_mg, zinc_mg, copper_mg, manganese_mg, selenium_ug, iodine_ug, caffeine_mg, choline_mg, nutriscore_grade, nutriscore_score, nova_group, ecoscore_grade, ecoscore_score, food_groups, source_supermarket, data_source, serving_size, serving_unit, is_global)
VALUES ('8414807543998', 'Ketchup Light', NULL, 'Consum', 'Condimentos', NULL, NULL, 'Sin gluten, Con edulcorantes', NULL, NULL, 'Puré de tomate (140 gramos de tomate para preparar 100 gramos de kétchup), azúcar, vinagre, almidon modificado de maiz, sal, conservadores: sorbato potásico y benzoato sódico, aroma natural y edulcorante: glucósidos de esteviol. Puede contener trazas de mostaza, leche y huevo.', NULL, 'Huevos, Leche, Mostaza', NULL, 72.0, 0.3, 0.1, 15.0, 10.0, 0.7, 1.2, 1.2, 0.48, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'b', 2, 4, 'b', 74, 'en:dressings-and-sauces', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807526281', 'Margarina vegetal 3/4', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', '500 g', NULL, 'Sin gluten', NULL, NULL, 'Agua, aceite vegetal (girasol), grasas vegetales (palma, coco), leche.desnatada en polvo, emulgente (E472c), sal (0.5%), conservador (E202), vitaminas (vitamina E, vitamina A, vitamina D), colorante (carotenos), aromas (leche); acidulante (äcido citrico), aromas.', 'Leche', NULL, NULL, 543.0, 60.0, 15.0, 0.5, 0.5, NULL, 0.5, 0.46, 0.184, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 9, 4, 'c', 49, 'en:salty-and-fatty-products', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807501561', 'Mejillones en Escabeche', NULL, 'Consum', 'Productos del mar', '111 g', NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, 158.0, 7.5, 1.1, 5.0, 0.0, NULL, 18.1, 1.98, 0.792, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 11, NULL, 'e', 24, 'en:fish-and-seafood', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807544971', 'Rosquilletas con chocolate', NULL, 'Consum', 'Botanas', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 497.0, 25.0, 4.6, 60.0, 12.0, NULL, 8.3, 0.83, 0.332, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 17, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807520395', 'Panecillos ajo y perejil', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 482.0, 22.0, 2.2, 61.0, 4.0, NULL, 8.3, 1.2, 0.48, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 14, NULL, 'b', 72, 'en:bread', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807527400', 'kids fresa', NULL, 'Consum', 'Bebidas', NULL, NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, 56.0, 0.5, 0.30000001192093, 10.0, 10.0, NULL, 2.9000000953674, 0.12999999523163, 0.052, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 6, NULL, 'u', NULL, 'en:milk-and-yogurt', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807546098', 'Leche desnatada eco', NULL, 'Consum', 'Lácteos', NULL, NULL, 'Ecológico, Ecológico UE, ES-ECO-022-GA', NULL, NULL, 'LECHE DESNATADA DE PRODUCCIÓN Ecológica UHT ORIGEN DE LA LECHE: ESPAÑA', NULL, NULL, NULL, 37.0, 0.5, 0.3, 4.8, 4.8, NULL, 3.2, 0.13, 0.052, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 110.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'b', -1, NULL, 'b', 61, 'en:milk-and-yogurt', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807545329', 'Smoothie Samba', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 45.0, 0.3, 0.0, 9.2, 9.1, NULL, 0.5, 0.03, 0.012, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 11, NULL, 'd', 39, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807530646', 'Tortilla de patata', 'Comida preparada refrigerada', 'Consum', 'Comidas preparadas', NULL, NULL, 'Sin lactosa', NULL, NULL, NULL, NULL, NULL, NULL, 121.0, 7.5, 1.4, 8.0, 1.3, NULL, 4.9, 1.3, 0.52, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 6, NULL, 'c', 56, 'en:one-dish-meals', 'Consum', 'open_food_facts', 100, 'g', true), ('2614089001254', 'MINI CARACOLA CHOCOLATE', NULL, 'consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 512.0, 31.2, 14.8, 49.0, 16.7, NULL, 6.9, 0.99, 0.396, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807518606', 'Bases de pizza ultracongelada', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', NULL, NULL, 'Sin colorantes', NULL, NULL, NULL, NULL, NULL, NULL, 311.0, 5.0, 0.6, 57.0, 3.0, NULL, 8.5, 1.5, 0.6, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 7, NULL, 'b', 71, 'en:cereals-and-potatoes', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807502544', 'Manzanilla Camamilla consum', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'a', 80, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807546005', 'Pate Campanya', NULL, 'Consum', NULL, '160 g', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 343.0, 33.0, 12.3, 0.5, 0.5, NULL, 11.0, 1.8, 0.72, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807540805', 'ISO GO!', NULL, 'consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 19.0, 0.0, 0.0, 4.9, 4.9, NULL, 0.0, 0.08, 0.032, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('2603118001006', 'PALITO SOBRASADA', NULL, 'Consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 424.0, 23.4, 4.2, 42.2, 2.0, NULL, 10.0, 1.97, 0.788, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('2603301000502', 'Croissant artesano 75g', NULL, 'consum', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 454.0, 28.1, 14.0, 42.8, 7.9, NULL, 7.4, 0.94, 0.376, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807100139', 'Helado Straciatella', NULL, 'Consum', NULL, '480 g', NULL, 'Agricultura sustentable, Certificado UTZ, UTZ Certified Cocoa', NULL, NULL, NULL, NULL, NULL, NULL, 224.0, 8.6, 6.5, 33.0, 28.0, NULL, 2.7, 0.13, 0.052, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807534972', 'Mostaza', NULL, 'Consum', 'Condimentos', '300 g', NULL, 'Sin gluten', NULL, NULL, 'Agua, vinagre, mostaza (14%), sal, fibra de mostaza, especias, estabilizantes: goma guar y goma xantana, aceite vegetai&quot;, colorante: E-150d, antioxidante: E223 (sulfitos), acidulante: ácido cítrico, conservadores sorbato potásico y benzoato sódico. Alérgenos: Contiene sulfitos.', 'Mostaza, Dióxido de azufre y sulfitos', NULL, NULL, 102.0, 6.0, 0.3, 6.3, 1.1, 3.3, 3.9, 1.3, 0.52, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 5, 4, 'c', 55, 'en:dressings-and-sauces', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807547958', 'Palmito entero', NULL, 'consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 30.0, 0.0, 0.0, 5.0, 1.0, NULL, 2.0, 0.5, 0.2, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807540379', 'Aceite de oliva virgen extra primera cosecha', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', '500 ml', NULL, NULL, NULL, NULL, 'aceite de oliva', NULL, NULL, NULL, 900.0, 100.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'b', 1, 2, 'e', 27, 'en:fats', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807544360', 'Zumo de manzana', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 41.0, 0.10000000149012, 0.0, 9.8999996185303, 9.8999996185303, NULL, 0.0, 0.10000000149012, 0.04, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 5, NULL, 'c', 50, 'en:fruit-juices', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807529473', 'Jamón serrano hembra finas lonchas', NULL, 'Consum', 'Productos a base de carne', NULL, NULL, 'Sin gluten, Sin lactosa, Especialidad tradicional garantizada', NULL, NULL, NULL, NULL, NULL, NULL, 232.0, 12.0, 4.8, 0.1, 0.1, 0.1, 31.0, 5.0, 2.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 26, NULL, 'f', -5, 'en:processed-meat', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807512482', 'Jamon serrano hembra gran reserva', NULL, 'Consum', 'Productos a base de carne', NULL, NULL, 'Sin gluten, Sin lactosa, Especialidad tradicional garantizada', NULL, NULL, NULL, NULL, NULL, NULL, 232.0, 12.0, 4.8, 0.1, 0.1, 0.1, 31.0, 5.0, 2.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 26, NULL, 'f', -5, 'en:processed-meat', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807545763', 'Yogur de vaca ecológico natural', NULL, 'Consum', 'Lácteos', NULL, NULL, 'Ecológico, Ecológico UE', NULL, NULL, NULL, NULL, NULL, NULL, 60.0, 3.2, 2.2, 4.6, 3.4, NULL, 3.1, 0.1, 0.04, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'b', 1, NULL, 'a', 87, 'en:milk-and-yogurt', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807537874', 'Midi Cono', NULL, 'Consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 364.0, 22.0, 14.0, 37.0, 26.0, NULL, 3.8, 0.3, 0.12, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true)
ON CONFLICT (barcode) WHERE barcode IS NOT NULL DO UPDATE SET
    name = EXCLUDED.name,
    generic_name = COALESCE(EXCLUDED.generic_name, foods.generic_name),
    brand = COALESCE(EXCLUDED.brand, foods.brand),
    category = COALESCE(EXCLUDED.category, foods.category),
    ingredients_text = COALESCE(EXCLUDED.ingredients_text, foods.ingredients_text),
    allergens = COALESCE(EXCLUDED.allergens, foods.allergens),
    calories = COALESCE(EXCLUDED.calories, foods.calories),
    protein_g = COALESCE(EXCLUDED.protein_g, foods.protein_g),
    carbs_g = COALESCE(EXCLUDED.carbs_g, foods.carbs_g),
    fat_g = COALESCE(EXCLUDED.fat_g, foods.fat_g),
    fiber_g = COALESCE(EXCLUDED.fiber_g, foods.fiber_g),
    nutriscore_grade = COALESCE(EXCLUDED.nutriscore_grade, foods.nutriscore_grade),
    nova_group = COALESCE(EXCLUDED.nova_group, foods.nova_group),
    updated_at = now();