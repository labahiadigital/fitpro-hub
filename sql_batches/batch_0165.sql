INSERT INTO foods (barcode, name, generic_name, brand, category, quantity, packaging, labels, origins, manufacturing_places, ingredients_text, allergens, traces, energy_kj, calories, fat_g, saturated_fat_g, carbs_g, sugars_g, fiber_g, protein_g, salt_g, sodium_mg, alcohol_g, monounsaturated_fat_g, polyunsaturated_fat_g, trans_fat_g, cholesterol_mg, omega3_g, added_sugars_g, starch_g, polyols_g, vitamin_a_ug, vitamin_d_ug, vitamin_e_mg, vitamin_k_ug, vitamin_c_mg, vitamin_b1_mg, vitamin_b2_mg, vitamin_b6_mg, vitamin_b9_ug, vitamin_b12_ug, vitamin_pp_mg, pantothenic_acid_mg, potassium_mg, calcium_mg, phosphorus_mg, iron_mg, magnesium_mg, zinc_mg, copper_mg, manganese_mg, selenium_ug, iodine_ug, caffeine_mg, choline_mg, nutriscore_grade, nutriscore_score, nova_group, ecoscore_grade, ecoscore_score, food_groups, source_supermarket, data_source, serving_size, serving_unit, is_global)
VALUES ('8414807539861', 'Digestive avena', 'Galletas con avena y trigo', 'Consum', 'Botanas', '425 g', 'Caja', 'Fuente de fibra alimentaria, Punto Verde, Con aceite de girasol', NULL, NULL, 'Copos de _avena_ 44%, harina de _trigo_ 20%, aceite girasol alto oleico 18%, azúcar, salvado de _trigo_ 5%, jarabe de glucosa y fructosa, gasificantes (carbonato ácido de sodio, carbonato ácido de amonio), sal.', 'Gluten, Avena', 'Leche, Mostaza, Soja', 1996.0, 477.0, 21.0, 2.3, 61.0, 18.0, 6.8, 7.5, 1.1, 0.44, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 13, 4, 'c', 55, 'en:biscuits-and-cakes', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807550033', 'Café con leche', 'Preparado a base de leche en polvo y café solubre en cápsulas', 'Consum', 'Bebidas y preparaciones de bebidas', '160 g', NULL, 'Punto Verde', 'España', NULL, '_Leche_ en polvo 75%, café soluble 25%.', 'Leche', NULL, 1825.0, 442.0, 20.0, 13.0, 38.0, 29.0, NULL, 24.0, 0.85, 0.34, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 27, 3, 'f', -12, 'en:unsweetened-beverages', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807526434', 'Queso', NULL, 'Consum', NULL, '150 g', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 384.0, 32.0, 21.0, 16.0, 0.0, NULL, 25.0, 15.0, 6.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807536495', 'Moras', 'Caramelos de goma', 'Consum', 'Botanas', '150 g', NULL, 'Sin gluten, No recomendado para ciertas personas, Punto Verde, No recomendado a niños menores de 3 años', NULL, NULL, 'Azúcar, jarabe de glucosa, agua, gelatina, acidulante (E330), gelificante (pectina), acidulante (E270), corrector de acidez (E325), aromas, concentrados (zanahoria, cártamo, baya de saúco, limón), colorante (E153).', NULL, 'Leche', 1420.0, 334.0, 0.0, 0.0, 80.0, 69.0, NULL, 3.5, 0.1, 0.04, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 19, 4, 'd', 42, 'en:sweets', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807543141', 'Anchoa del Cantábrico', NULL, 'Consum', 'Productos del mar', NULL, NULL, 'Sostenible, Pesca sostenible, Certificado MSC de pesca sostenible', NULL, NULL, NULL, NULL, NULL, NULL, 175.0, 7.6, 1.0, 0.0, 0.0, NULL, 26.6, 9.0, 3.6, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 22, NULL, 'b', 72, 'en:fatty-fish', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807536662', 'Digest', NULL, 'Consum', NULL, '30 g', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807543240', 'Arroz de Marisco', NULL, 'Consum', NULL, NULL, NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, 132.0, 3.8, 0.6, 18.4, 0.4, NULL, 4.7, 1.07, 0.428, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807100542', 'Tres chocolates', NULL, 'Consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 213.0, 8.1, 5.6, 31.0, 28.0, NULL, 3.1, 0.16, 0.064, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807548979', 'Bocadillo de agua', NULL, 'consum', NULL, '2 x 130 g', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 230.0, 0.8, 0.2, 46.6, 0.2, NULL, 8.1, 1.43, 0.572, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807519771', 'Pizza fresca jamón y queso al horno de piedra', 'Pizza fresca jamón y queso. Plato preparado refrigerado', 'Consum', 'Comidas preparadas', '400g', NULL, 'Punto Verde', NULL, NULL, 'Guarnición (queso mozzarella 22% (_leche_ pasteurizada, sal, fermentos, cuajo, antioxidante (E330)), jamón cocido extra 20% (jamón de cerdo, agua, gelificante (E407), azúcar, estabilizante (E451i), sal, antioxidantes (E331ii, E316), conservadores (E250, E262i)), salsa de tomate (tomate, agua, aceite de oliva, sal, azúcar, especias), especias), base (harina de _trigo_ (_gluten_), agua, aceite de girasol, sal, azúcar, levadura, gasificantes (E450i, E500ii), almidón de _trigo_ (_gluten_)).', 'Gluten, Leche', 'Huevos, Mostaza, Soja', 921.0, 219.0, 8.0, 3.9, 25.0, 2.6, 1.6, 11.0, 1.7, 0.68, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 13, 4, 'd', 40, 'en:pizza-pies-and-quiches', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807545213', 'Croquetas jamón iberico', NULL, 'Consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 226.0, 12.0, 4.0, 21.0, 0.0, NULL, 8.0, 1.0, 0.4, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('2602475002824', 'Lomo adobado extra', NULL, 'Consum', NULL, NULL, NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, 109.0, 3.4, 1.2, 0.7, 0.7, NULL, 19.0, 1.9, 0.76, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807502964', 'Nachos de maíz tex mex', NULL, 'Consum', 'Botanas', NULL, NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, 533.0, 29.8, 2.9, 58.4, 1.06, NULL, 6.77, 1.6, 0.64, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 15, NULL, 'u', NULL, 'en:appetizers', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807545817', 'Pimiento morrón entero', 'Pimiento rojo entero al natural', 'Consum', 'Alimentos y bebidas de origen vegetal', '240 g', NULL, 'Punto Verde', 'España', NULL, 'Pimiento, agua, sal, acidulante (ácido cítrico).', NULL, NULL, 136.0, 32.0, 0.5, 0.0, 5.2, 5.1, 1.5, 1.19, 0.2, 0.08, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -4, 3, 'a', 85, 'en:vegetables', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807545930', 'Sardinillas en aceite de oliva', 'Sardina pequeña en aceite de oliva', 'Consum', 'Productos del mar', '180g', NULL, 'Omega-3, Fuente de calcio, Punto Verde, Source of omega-3', NULL, NULL, 'Sardinas (_pescado_), aceite de oliva, sal.', 'Pescado', NULL, 963.0, 231.0, 15.0, 3.4, 0.0, 0.0, NULL, 24.0, 1.3, 0.52, NULL, NULL, NULL, NULL, NULL, 1480.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 423.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 11, 3, 'e', 15, 'en:fatty-fish', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807532909', 'Barra de pan', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', '2 x 250 g', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 265.0, 1.5, 0.3, 52.0, 2.2, NULL, 9.5, 1.32, 0.528, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 6, NULL, 'u', NULL, 'en:bread', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807512376', 'Anillas a la romana', NULL, 'Consum', 'Productos del mar', '400 g', NULL, 'Sin grasas hidrogenadas', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, 'en:fish-and-seafood', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807551818', 'Yogur natural azucarado', NULL, 'consum', 'Lácteos', '250 g', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 90.0, 3.5, 2.3, 11.0, 11.0, NULL, 3.6, 0.1, 0.04, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 5, NULL, 'b', 67, 'en:milk-and-yogurt', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807543936', 'Boqueron en vinagre del cantabrico', NULL, 'Consum', NULL, NULL, NULL, 'Sostenible, Pesca sostenible, Certificado MSC de pesca sostenible', NULL, NULL, NULL, NULL, NULL, NULL, 150.0, 6.9, 1.2, 1.5, 0.0, NULL, 21.0, 4.4, 1.76, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807548030', 'Manzanilla con anís', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 1.0, 0.0, 0.0, 0.2, 0.0, NULL, 0.1, 0.0, 0.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'b', 0, NULL, 'a', 80, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('2604563004284', 'Pollo', NULL, 'Consum', 'Productos a base de carne', NULL, NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, 388.0, 93.0, 1.3, 0.6, 0.7, 0.7, NULL, 19.6, 1.22, 0.488, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', 0, NULL, 'e', 22, 'en:poultry', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807520272', 'Pizza atún y cebolla', NULL, 'Consum', 'Congelados', '370g', NULL, 'Punto Verde, 90 % Cartoncillo reciclado, Recicla-amarillo, Recicla-azul', 'Alquerías, Murcia', NULL, 'Harina de TRIGO, salsa de tomate (puré de tomate, agua, azúcar, aceite de girasol, almidón modificado de maíz, sal, aceite de oliva virgen extra y especias), ATÚN 15,6%, aceite de girasol, sal, agua, QUESO edam (8,1%), QUESO mozzarella (5,4%), cebolla (2,7%), aceite de girasol, alcaparras, sal, levadura, azúcar , orégano. PUEDE CONTENER SOJA Y MOSTAZA.', 'Pescado, Gluten, Leche', 'Mostaza, Soja', NULL, 238.0, 9.5, 2.3, 25.0, 2.1, 2.2, 12.0, 1.3, 0.52, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 6, 4, 'c', 56, 'en:pizza-pies-and-quiches', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807537812', 'Jamón Serrano Hembra', NULL, 'Consum', 'Productos a base de carne', NULL, NULL, 'Sin gluten, Sin lactosa, Especialidad tradicional garantizada, Recicla-amarillo', NULL, NULL, NULL, NULL, NULL, NULL, 265.0, 15.0, 5.0, 0.5, 0.5, NULL, 32.0, 4.75, 1.9, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 27, NULL, 'f', -5, 'en:processed-meat', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807534613', 'Nueces mondadas', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', '150 g', NULL, 'Sin gluten, Fuente de fibra alimentaria', NULL, NULL, NULL, NULL, NULL, NULL, 595.0, 63.28, 7.42, 3.3, 2.6, 5.2, 14.0, 0.0, 0.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'b', -4, NULL, 'f', 13, 'en:nuts', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807517524', 'Tacos de jamón y paleta curados', NULL, 'Consum', 'Productos a base de carne', '150 g', NULL, 'Sin gluten, Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 256.0, 15.0, 6.0, 0.3, 0.3, NULL, 30.0, 5.0, 2.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 28, NULL, 'f', -5, 'en:processed-meat', 'Consum', 'open_food_facts', 100, 'g', true)
ON CONFLICT (barcode) WHERE barcode IS NOT NULL DO UPDATE SET
    name = EXCLUDED.name,
    generic_name = COALESCE(EXCLUDED.generic_name, foods.generic_name),
    brand = COALESCE(EXCLUDED.brand, foods.brand),
    category = COALESCE(EXCLUDED.category, foods.category),
    ingredients_text = COALESCE(EXCLUDED.ingredients_text, foods.ingredients_text),
    allergens = COALESCE(EXCLUDED.allergens, foods.allergens),
    calories = COALESCE(EXCLUDED.calories, foods.calories),
    protein_g = COALESCE(EXCLUDED.protein_g, foods.protein_g),
    carbs_g = COALESCE(EXCLUDED.carbs_g, foods.carbs_g),
    fat_g = COALESCE(EXCLUDED.fat_g, foods.fat_g),
    fiber_g = COALESCE(EXCLUDED.fiber_g, foods.fiber_g),
    nutriscore_grade = COALESCE(EXCLUDED.nutriscore_grade, foods.nutriscore_grade),
    nova_group = COALESCE(EXCLUDED.nova_group, foods.nova_group),
    updated_at = now();