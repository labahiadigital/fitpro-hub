INSERT INTO foods (barcode, name, generic_name, brand, category, quantity, packaging, labels, origins, manufacturing_places, ingredients_text, allergens, traces, energy_kj, calories, fat_g, saturated_fat_g, carbs_g, sugars_g, fiber_g, protein_g, salt_g, sodium_mg, alcohol_g, monounsaturated_fat_g, polyunsaturated_fat_g, trans_fat_g, cholesterol_mg, omega3_g, added_sugars_g, starch_g, polyols_g, vitamin_a_ug, vitamin_d_ug, vitamin_e_mg, vitamin_k_ug, vitamin_c_mg, vitamin_b1_mg, vitamin_b2_mg, vitamin_b6_mg, vitamin_b9_ug, vitamin_b12_ug, vitamin_pp_mg, pantothenic_acid_mg, potassium_mg, calcium_mg, phosphorus_mg, iron_mg, magnesium_mg, zinc_mg, copper_mg, manganese_mg, selenium_ug, iodine_ug, caffeine_mg, choline_mg, nutriscore_grade, nutriscore_score, nova_group, ecoscore_grade, ecoscore_score, food_groups, source_supermarket, data_source, serving_size, serving_unit, is_global)
VALUES ('2302791004686', 'Filete de pechuga de pollo de campo', NULL, 'mercadona', NULL, NULL, NULL, '100% vegetal', NULL, NULL, NULL, NULL, NULL, NULL, 110.0, 2.1, 0.7, 0.0, 0.0, NULL, 22.0, 0.14, 0.056, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302791004679', 'Filete de pechuga pollo de campo', NULL, 'mercadona', NULL, NULL, NULL, '100% vegetal', NULL, NULL, NULL, NULL, NULL, NULL, 106.0, 1.3, 0.4, 0.0, 0.0, NULL, 23.0, 0.1, 0.04, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302791004457', 'Pollo de campo', NULL, 'mercadona', NULL, NULL, NULL, '100% vegetal', NULL, NULL, NULL, NULL, NULL, NULL, 102.0, 1.1, 0.37, 0.5, 0.5, NULL, 23.1, 0.13, 0.052, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302791003870', 'Filete de pechuga de pollo rural', NULL, 'mercadona', 'Productos a base de carne', NULL, NULL, '100% vegetal', NULL, NULL, NULL, NULL, NULL, NULL, 108.0, 1.5, 0.5, 0.5, 0.5, NULL, 23.6, 0.1, 0.04, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -6, NULL, 'e', 22, 'en:poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302791003818', 'Pollo de Campo', NULL, 'mercadona', NULL, NULL, NULL, '100% vegetal', NULL, NULL, NULL, NULL, NULL, NULL, 130.0, 5.6, 1.9, 0.5, 0.0, NULL, 20.0, 0.26, 0.104, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302783003185', 'Cuartos traseros de pollo', NULL, 'mercadona', NULL, NULL, NULL, '100% vegetal', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302782007917', 'Pollo entero rural', NULL, 'mercadona', NULL, NULL, NULL, '100% vegetal', NULL, NULL, NULL, NULL, NULL, NULL, 503.0, 4.0, 1.3, 0.0, 0.0, NULL, 21.0, 0.2, 0.08, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302782007528', 'Pollo de campo entero', NULL, 'mercadona', NULL, NULL, NULL, '100% vegetal', NULL, NULL, NULL, NULL, NULL, NULL, 446.0, 1.2, 0.4, 0.0, 0.0, NULL, 24.0, 0.2, 0.08, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2304900002712', 'Chuletas de aguja', NULL, 'mercadona', 'Productos a base de carne', NULL, NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, 186.0, 12.4, 4.9, 0.9, 0.5, NULL, 17.8, 0.2, 0.08, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 4, NULL, 'u', NULL, 'en:meat-other-than-poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('230582740011003600003960', 'Serra a Ganivet', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 299.5, 18.7, 6.8, 1.0, 0.5, NULL, 31.8, 3.6, 1.44, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('232849160000100155001550', 'Medias noches', NULL, 'Mercadona', 'Alimentos y bebidas de origen vegetal', NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 349.60000610352, 12.0, 6.5, 62.0, 11.0, NULL, 8.3999996185303, 1.2000000476837, 0.48, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 19, NULL, 'u', NULL, 'en:bread', 'Mercadona', 'open_food_facts', 100, 'g', true), ('8402001017605', 'Chicle', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 23.0, NULL, NULL, 6.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302784005003', 'Alas pollo', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 133.0, 5.4, 1.8, 0.4, 0.2, NULL, 21.0, 0.23, 0.092, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2325243001668', 'Patas limpias de pollo', NULL, 'mercadona', 'Productos a base de carne', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 732.0, 10.0, 2.2, 0.0, 0.0, NULL, 21.0, 0.38, 0.152, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 12, NULL, 'e', 22, 'en:poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2304351005867', 'Solimillo Romero Mercadona', NULL, 'mercadona', NULL, NULL, NULL, 'Sin lactosa', NULL, NULL, NULL, NULL, NULL, NULL, 95.9, 2.3, 0.82, 1.2, 1.2, NULL, 17.6, 1.3, 0.52, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2304388004338', 'Cordon Blue', NULL, 'mercadona', 'Productos a base de carne', '573 kg', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 138.0, 2.82, 1.3, 13.13, 2.6, NULL, 14.98, 1.05, 0.42, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'b', 1, NULL, 'e', 18, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302862002924', 'Longaniza pollo fresca', NULL, 'mercadona', 'Productos a base de carne', NULL, NULL, 'Sin lactosa', NULL, NULL, NULL, NULL, NULL, NULL, 130.0, 6.0, 1.8, 0.8, 0.5, NULL, 16.0, 1.8, 0.72, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 4, NULL, 'u', NULL, 'en:meat-other-than-poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302849003586', 'Filete de lomo extar-tierno', NULL, 'mercadona', NULL, NULL, NULL, 'Sin gluten, Sin lactosa', NULL, NULL, NULL, NULL, NULL, NULL, 111.0, 3.4, 1.2, 1.2, 0.7, NULL, 18.8, 1.8, 0.72, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('232835640000100150001504', 'Pan multifibras', NULL, 'Mercadona', 'Alimentos y bebidas de origen vegetal', '600 g', NULL, 'Sin azúcares añadidos, Sin lactosa', NULL, NULL, 'Harina de trigo ( gluten), agua, fibras vegetales (7.8 %) de las cuales: salvado de trigo ( gluten) (5.9 %) , fibra de trigo ( gluten ) (0.6%), fibra de avena ( (gluten ) (0.6 % ), fibra procedente de achicoria (0.5 %), fibra de manzana (0.1 % ), fibra de guisante( 0.1 %)), sal, levadura, aceite de girasol, mejorante panario ( harina de trigo( gluten ), conservador E-200, antioxidante E-300, masa madre de centeno inactiva ( gluten ) (0.2 %) y harina de centeno ( gluten ), gluten, conservador E-282.', 'Gluten', 'Granos de sésamo', NULL, 250.0, 2.5, 0.40000000596046, 43.299999237061, 2.0999999046326, 6.7, 10.10000038147, 0.93000000715256, 0.372, NULL, 0.5, 1.6, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -1, 4, 'b', 70, 'en:bread', 'Mercadona', 'open_food_facts', 100, 'g', true), ('8480000136060', 'Refresco sin gas manzana', 'Bebida refrescante de zumo de manzana, con azúcar y edulcorante', 'Mercadona', 'Bebidas y preparaciones de bebidas', '1,5 l', 'Green dot', 'Punto Verde, Con edulcorantes', NULL, NULL, 'Agua mineral 86%, zumo de manzana a partir de concentrado 10%, azúcar, acidulantes (ácido málico, ácido cítrico), extracto de manzana 0,03%, antioxidante (ácido ascórbico), edulcorante (sucralosa), aromas.', NULL, NULL, 60.0, 14.0, 0.0, 0.0, 3.5, 3.5, 0.0, 0.0, 0.0, 0.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 7, 4, 'd', 44, 'en:sweetened-beverages', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2301094002108', 'Chorizo oreado', NULL, 'mercadona', 'Productos a base de carne', NULL, NULL, 'Sin gluten, Sin lactosa', NULL, NULL, 'Carne y grasa de cerdo, pimentón, sal, sacarosa, especias, almidón, ajo, fibra guisante, reguladores de la acidez (E-262, E-325), aromas naturales, antioxidante E-30, colorante E-120. Tripa natural.', NULL, NULL, NULL, 400.0, 35.0, 14.0, 0.5, 0.0, NULL, 14.0, 2.0, 0.8, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 23, 4, 'e', 15, 'en:processed-meat', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2301009002179', 'Longaniza magro fresca', NULL, 'mercadona', 'Productos a base de carne', NULL, NULL, 'Sin gluten, Sin lactosa', NULL, NULL, 'Carne de cerdo (80%), agua, almidón (maíz), sal, fibra vegetal, dextrosa, acidulante E-262, especias, antioxidantes (E-300, E-331) conservador E-221 (sulfito), colorante E-120. Tripa natural.', 'Dióxido de azufre y sulfitos', NULL, 921.0, 222.0, 18.0, 6.0, 2.0, 0.5, 0.0, 13.0, 1.8, 0.72, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 15, 4, 'u', NULL, 'en:processed-meat', 'Mercadona', 'open_food_facts', 100, 'g', true), ('236841550000100625001504', 'Berlina rellena de crema', NULL, 'Mercadona', 'Botanas', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 235.8, 11.0, 4.2, 31.0, 14.0, NULL, 3.2, 0.7, 0.28, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 12, NULL, 'u', NULL, 'en:biscuits-and-cakes', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302711004888', 'Carne vacuno', NULL, 'mercadona', 'Productos a base de carne', NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 122.0, 3.5, 1.5, 0.4, 0.4, NULL, 23.0, 0.2, 0.08, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', 0, NULL, 'u', NULL, 'en:meat-other-than-poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2304384002697', 'Medallones de Pavo', NULL, 'mercadona', 'Productos a base de carne', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 99.0, 0.5, 0.1, 0.5, 0.5, NULL, 24.7, 0.173, 0.0692, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -6, NULL, 'e', 22, 'en:poultry', 'Mercadona', 'open_food_facts', 100, 'g', true)
ON CONFLICT (barcode) WHERE barcode IS NOT NULL DO UPDATE SET
    name = EXCLUDED.name,
    generic_name = COALESCE(EXCLUDED.generic_name, foods.generic_name),
    brand = COALESCE(EXCLUDED.brand, foods.brand),
    category = COALESCE(EXCLUDED.category, foods.category),
    ingredients_text = COALESCE(EXCLUDED.ingredients_text, foods.ingredients_text),
    allergens = COALESCE(EXCLUDED.allergens, foods.allergens),
    calories = COALESCE(EXCLUDED.calories, foods.calories),
    protein_g = COALESCE(EXCLUDED.protein_g, foods.protein_g),
    carbs_g = COALESCE(EXCLUDED.carbs_g, foods.carbs_g),
    fat_g = COALESCE(EXCLUDED.fat_g, foods.fat_g),
    fiber_g = COALESCE(EXCLUDED.fiber_g, foods.fiber_g),
    nutriscore_grade = COALESCE(EXCLUDED.nutriscore_grade, foods.nutriscore_grade),
    nova_group = COALESCE(EXCLUDED.nova_group, foods.nova_group),
    updated_at = now();