INSERT INTO foods (barcode, name, generic_name, brand, category, quantity, packaging, labels, origins, manufacturing_places, ingredients_text, allergens, traces, energy_kj, calories, fat_g, saturated_fat_g, carbs_g, sugars_g, fiber_g, protein_g, salt_g, sodium_mg, alcohol_g, monounsaturated_fat_g, polyunsaturated_fat_g, trans_fat_g, cholesterol_mg, omega3_g, added_sugars_g, starch_g, polyols_g, vitamin_a_ug, vitamin_d_ug, vitamin_e_mg, vitamin_k_ug, vitamin_c_mg, vitamin_b1_mg, vitamin_b2_mg, vitamin_b6_mg, vitamin_b9_ug, vitamin_b12_ug, vitamin_pp_mg, pantothenic_acid_mg, potassium_mg, calcium_mg, phosphorus_mg, iron_mg, magnesium_mg, zinc_mg, copper_mg, manganese_mg, selenium_ug, iodine_ug, caffeine_mg, choline_mg, nutriscore_grade, nutriscore_score, nova_group, ecoscore_grade, ecoscore_score, food_groups, source_supermarket, data_source, serving_size, serving_unit, is_global)
VALUES ('8480000232090', 'compy supreme', NULL, 'mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2303024003568', 'Piña natural rodajas', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 58.0, 0.0, 0.0, 14.0, 10.0, 1.2, 0.5, 0.0, 0.0, NULL, NULL, NULL, NULL, NULL, NULL, 0.0, 0.0, NULL, 0.0, NULL, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, NULL, NULL, NULL, NULL, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, NULL, 0.0, 0.0, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('8480000202109', 'Yogur natural 0%', NULL, 'Mercadona', 'Lácteos', '6, 750 g', 'Plástico', 'Sin gluten', 'España', NULL, 'Leche fresca pasteurizada desnatada,  proteínas de la leche,  leche en polvo desnatada,  fermentos lácteos.', 'Leche', NULL, 153.0, 36.0, 0.1, 0.0, 4.5, 4.5, NULL, 4.3, 0.13, 0.052, NULL, NULL, NULL, NULL, NULL, NULL, 0.0, 0.0, NULL, 0.0, NULL, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, NULL, NULL, NULL, 120.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, NULL, 0.0, 0.0, 'a', 0, 4, 'a', 80, 'en:milk-and-yogurt', 'Mercadona', 'open_food_facts', 100, 'g', true), ('8480000301383', 'Cocktail mezcla aperitivos', NULL, 'Hacendado, Mercadona', 'Snacks', '100 g', NULL, NULL, NULL, NULL, 'Farinhas de cereais 30% (farinha de trigo, farinha de arroz, farinha de milho, farinha de centeio), fécula de batata, óleo de girassol, farinha de batata, amido de trigo, sal, cebola em pó, açúcar, aromas, aromatizantes de fumo, intensificadores de sabor (E621, E635), corantes alimentares (concentrado de rabanete, cenoura, couve roxa, beterraba e tomate), cúrcuma, corantes (extrato de pimentão, carotenos, caramelo de sulfito de amónio), regulador de acidez (E338). Pode conter soja, mostarda, leite e derivados do leite (incluindo lactose).', NULL, NULL, NULL, 468.0, 24.2, NULL, 57.2, NULL, 1.9, 4.2, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, 4, 'u', NULL, 'en:appetizers', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2304353005728', 'Solomillo setas', NULL, 'mercadona', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 124.3, 5.5, 1.9, 1.1, 1.1, NULL, 17.6, 1.7, 0.68, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302844003499', 'Pechuga empanada marinada', NULL, 'mercadona', 'Productos a base de carne', NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 136.0, 1.2, 0.4, 17.8, 1.4, NULL, 13.5, 1.4, 0.56, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'b', 2, NULL, 'e', 22, 'en:poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2350965004390', 'Queso De Mezcla Madurado', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 431.0, 36.0, 25.0, 1.8, NULL, NULL, 25.0, 1.77, 0.708, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2313706005995', 'Pollo Asado Con Salsa', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 183.0, 10.0, 2.1, 0.8, 0.5, NULL, 22.0, 0.7875, 0.315, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2380196003091', 'Lombinhos de frango', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 172.0, 6.3, 0.9, 11.7, 0.6, NULL, 17.0, 1.475, 0.59, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('8480000233325', 'Aceite de oliva virgen extra edición limitada sin filtrar', NULL, 'Hacendado, Mercadona', 'Alimentos y bebidas de origen vegetal', NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 822.0, 91.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.4, 0.16, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'b', 1, 2, 'e', 27, 'en:fats', 'Mercadona', 'open_food_facts', 100, 'g', true), ('8480000093691', 'Pan de molde 100% integral', NULL, 'Mercadona', 'Plant-based foods and beverages', NULL, NULL, 'Source of fibre, Green Dot, High fibres, No added sugar, No lactose', NULL, NULL, 'Harina integral de trigo (51%), agua, harina integral de avena (5,7%), copos de avena (4%), semillas de girasol (2%), semillas de sésamo (2%), levadura, sal, mejorante panario (gluten de trigo, harina integral de trigo, emulgente (E-472e), antioxidante (E-300)), masa madre de trigo, aceite de girasol, conservadores (E-282, E-200), salvado de avena, goma guar, harina de arroz, almidón de maíz.   Trazas: Puede contener soja y mostaza.', 'Gluten, Sesame seeds', 'Mustard, Soybeans', NULL, 75.0, 1.4, 0.2, 11.0, 0.8, 2.5, 3.4, 0.275, 0.11, NULL, NULL, NULL, NULL, NULL, NULL, 0.0, 0.0, NULL, 0.0, NULL, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, NULL, NULL, NULL, NULL, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, NULL, 0.0, 0.0, 'a', -2, 4, 'b', 70, 'en:bread', 'Mercadona', 'open_food_facts', 100, 'g', true), ('8402001024931', 'Fruta y leche mediterráneo sin azúcares añadidos', NULL, 'Mercadona', 'Bebidas y preparaciones de bebidas', '200ml', NULL, 'FSC, FSC Mixto', NULL, NULL, NULL, NULL, NULL, 66.0, 15.0, NULL, NULL, 3.3, 3.2, 0.3, 0.4, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'e', 17, 'en:milk-and-yogurt', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2304900005232', 'Chuletas De Aguja', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 129.0, 5.8, 2.2, 0.0, NULL, NULL, 19.0, 0.1875, 0.075, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('8436021411471', 'Burger meat vacuno y cerdo ajo y perejil', 'Preparado de carne´', 'Mercadona', 'Productos a base de carne', '240 g', NULL, 'Sin gluten, Punto Verde, Sin lactosa, Sin soja, Recicla amarillo', NULL, NULL, 'Carne de vacuno 42%, carne de cerdo 42%, agua, maíz, sal, fibra vegetal (contiene guisante) almidón, perejil 0,4%, ajo 0,3%, colorante (E-120), antioxidantes (E-301, E-331), aromas, conservador(E-221)(sulfito) y especias.', 'Dióxido de azufre y sulfitos', NULL, 899.0, 216.0, 16.0, 6.3, 3.1, 0.5, 0.0, 15.0, 2.5, 1.0, 0.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 20, 4, 'u', NULL, 'en:sandwiches', 'Mercadona', 'open_food_facts', 100, 'g', true), ('8411396001557', 'Empanado Picante (Pollo)', 'Pechuga de pollo', 'Mercadona', 'Productos a base de carne', '4 x 90 g', NULL, 'Sin gluten, Punto Verde, Sin lactosa, Recicla amarillo', NULL, 'Sevilla,España', 'Carne de pollo (53%), agua, fibra vegetal, sal, aromas, estabilizantes (carragenanos y goma garrofín). Cobertura (35%): Harina de maíz, pan rallado (harina de arroz, dextrosa, sal y extractos de especias), aceite de girasol, especias, sal, almidón, extractos de especias, gasificantes (difosfatos y carbonatos sódicos) y azúcar.', NULL, NULL, 874.0, 209.0, 12.0, 2.3, 9.4, 0.5, 0.0, 15.6, 1.8, 0.72, 0.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 12, 4, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2303682006079', 'Pechuga entera', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 108.0, 1.7, 0.5, 0.9, 0.7, NULL, 22.3, 0.3, 0.12, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('8480000051684', 'Morcilla de Caldera', NULL, 'Mercadona', 'Productos a base de carne', NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 302.0, 17.2, 3.0, 27.5, 5.5, NULL, 9.3, 1.9, 0.76, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 15, NULL, 'f', -8, 'en:processed-meat', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2323305003834', 'Chuletas De Sajonia', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 112.0, 6.3, 2.7, 3.2, 1.0, NULL, 11.0, 1.8675, 0.747, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('8413838120215', '12 Huevos frescos XL', NULL, 'Mercadona', 'Farming products', '12 pcs', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 150.0, 11.1, 3.1, 0.5, 0.5, NULL, 12.5, 0.355, 0.142, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', 0, NULL, 'd', 31, 'en:eggs', 'Mercadona', 'open_food_facts', 100, 'g', true), ('8423462700004', 'Huevos Frescos super grandes', NULL, 'Mercadona', 'Productos agrícolas', '12 pcs', NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 150.0, 11.1, 3.1, 0.0, NULL, NULL, 12.5, 0.1375, 0.055, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -1, NULL, 'd', 31, 'en:eggs', 'Mercadona', 'open_food_facts', 100, 'g', true), ('8423462100293', 'Huevos Frescos', NULL, 'Mercadona', 'Productos agrícolas', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 150.0, 11.1, 3.1, 0.0, NULL, NULL, 12.5, 0.00035, 0.00014, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -1, NULL, 'd', 31, 'en:eggs', 'Mercadona', 'open_food_facts', 100, 'g', true), ('8422287123203', 'Huevos Frescos', NULL, 'Mercadona', 'Productos agrícolas', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 150.0, 11.1, 3.1, 0.5, NULL, NULL, 12.5, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'd', 31, 'en:eggs', 'Mercadona', 'open_food_facts', 100, 'g', true), ('8424045526721', 'Cerdo Burger Meat Patty', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 161.0, 10.2, 3.7, 1.3, NULL, NULL, 15.2, 4.15, 1.66, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('8402001030277', 'Lomo De Pavo', NULL, 'Mercadona', 'es:A', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 215.0, 5.8, 2.8, 0.7, 0.7, NULL, 40.0, 3.835, 1.534, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 23, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2387197005710', 'Atún De Aleta Amarilla', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 91.0, 1.0, 0.4, 0.5, 0.1, NULL, 20.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true)
ON CONFLICT (barcode) WHERE barcode IS NOT NULL DO UPDATE SET
    name = EXCLUDED.name,
    generic_name = COALESCE(EXCLUDED.generic_name, foods.generic_name),
    brand = COALESCE(EXCLUDED.brand, foods.brand),
    category = COALESCE(EXCLUDED.category, foods.category),
    ingredients_text = COALESCE(EXCLUDED.ingredients_text, foods.ingredients_text),
    allergens = COALESCE(EXCLUDED.allergens, foods.allergens),
    calories = COALESCE(EXCLUDED.calories, foods.calories),
    protein_g = COALESCE(EXCLUDED.protein_g, foods.protein_g),
    carbs_g = COALESCE(EXCLUDED.carbs_g, foods.carbs_g),
    fat_g = COALESCE(EXCLUDED.fat_g, foods.fat_g),
    fiber_g = COALESCE(EXCLUDED.fiber_g, foods.fiber_g),
    nutriscore_grade = COALESCE(EXCLUDED.nutriscore_grade, foods.nutriscore_grade),
    nova_group = COALESCE(EXCLUDED.nova_group, foods.nova_group),
    updated_at = now();