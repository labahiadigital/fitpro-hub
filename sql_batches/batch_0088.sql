INSERT INTO foods (barcode, name, generic_name, brand, category, quantity, packaging, labels, origins, manufacturing_places, ingredients_text, allergens, traces, energy_kj, calories, fat_g, saturated_fat_g, carbs_g, sugars_g, fiber_g, protein_g, salt_g, sodium_mg, alcohol_g, monounsaturated_fat_g, polyunsaturated_fat_g, trans_fat_g, cholesterol_mg, omega3_g, added_sugars_g, starch_g, polyols_g, vitamin_a_ug, vitamin_d_ug, vitamin_e_mg, vitamin_k_ug, vitamin_c_mg, vitamin_b1_mg, vitamin_b2_mg, vitamin_b6_mg, vitamin_b9_ug, vitamin_b12_ug, vitamin_pp_mg, pantothenic_acid_mg, potassium_mg, calcium_mg, phosphorus_mg, iron_mg, magnesium_mg, zinc_mg, copper_mg, manganese_mg, selenium_ug, iodine_ug, caffeine_mg, choline_mg, nutriscore_grade, nutriscore_score, nova_group, ecoscore_grade, ecoscore_score, food_groups, source_supermarket, data_source, serving_size, serving_unit, is_global)
VALUES ('2302715002996', 'Lomo adobado', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 117.0, 3.6, 1.4, 0.8, 0.5, NULL, 20.4, 1.7, 0.68, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('6878883001841', 'manzana gala bolsa', NULL, 'mercadona', 'Alimentos y bebidas de origen vegetal', '1.325kg', 'Bolsa', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'a', 83, 'en:fruits', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302833003622', 'Pechuga finas hierbas', NULL, 'mercadona', 'Productos a base de carne', NULL, NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, 86.5, 1.1, 0.4, 1.2, 0.1, NULL, 17.6, 2.0, 0.8, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 3, NULL, 'e', 22, 'en:poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2304251004526', 'Filete de pechuga pollo', NULL, 'mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 106.0, 3.0, 0.5, 0.0, 0.0, 0.0, 0.2, 0.0, 0.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2301009002827', 'Longaniza Magro Fresca', NULL, 'mercadona', NULL, NULL, NULL, 'Sin gluten, Sin lactosa', NULL, NULL, NULL, NULL, NULL, NULL, 222.0, 18.0, 6.0, 2.0, 0.5, NULL, 13.0, 1.8, 0.72, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302787003785', 'FILETE DD PECHUGA DE POLLO', NULL, 'Mercadona', 'Productos a base de carne', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 104.0, 1.8, 0.5, 0.0, 0.0, NULL, 22.0, 0.16, 0.064, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -6, NULL, 'e', 22, 'en:poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302786003823', 'Solomillo pollo', NULL, 'mercadona', 'Productos a base de carne', '0.511 kg', 'Plástico, en:Tray', NULL, NULL, 'Spain', NULL, NULL, NULL, 400.0, 94.0, 0.13, 0.07, 0.5, 0.5, NULL, 20.3, 0.2, 0.08, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -6, NULL, 'e', 27, 'en:poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302807003320', 'Vacuno a tacos', NULL, 'Mercadona', 'Productos a base de carne', '0.484', 'Plástico', NULL, 'España', 'España', NULL, NULL, NULL, NULL, 119.0, 3.5, 1.4, 0.5, 0.5, NULL, 21.0, 0.19, 0.076, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -5, NULL, 'u', NULL, 'en:meat-other-than-poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2304176002843', 'Medallones de solomillo marinado', NULL, 'Mercadona', 'Productos a base de carne', NULL, 'Plástico', 'Sin gluten, Sin lactosa', NULL, NULL, 'Solomillo cerdo (75,7%), agua, sal, jarabe de glucosa, almidón, extracto de levadura, proteina de cerdo, estabilizantes (E-407, E-415), fibra vegetal, antioxidante (E-301).', NULL, NULL, 421.0, 100.0, 3.2, 1.1, 0.4, 0.4, NULL, 17.4, 1.0, 0.4, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 4, 4, 'u', NULL, 'en:fish-meat-eggs', 'Mercadona', 'open_food_facts', 100, 'g', true), ('8437008870069', 'Mollete 3 uds', 'Mollete', 'Mercadona', 'Alimentos y bebidas de origen vegetal', '315 g', 'Plástico', NULL, 'Manilva (Málaga)', 'Andalucia', 'Harina de trigo (gluten), agua, sal, levadura y complementos del pan: harina de centeno (gluten), gluten masa madre deshidratada, lecitina de soja, harina de malta (gluten), antioxidante E-300 y enzimas', 'Gluten, Soja', 'Gluten', NULL, 254.0, 1.1, 0.2, 53.0, 1.8, 3.5, 7.5, 1.2, 0.48, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 4, 4, 'u', NULL, 'en:bread', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302794003914', 'Filete de pechuga de pavo', NULL, 'mercadona', 'Productos a base de carne', NULL, 'Plástico', NULL, NULL, NULL, NULL, NULL, NULL, 473.6, 113.2, 2.0, 0.72, 0.0, 0.0, NULL, 23.8, 0.35, 0.14, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -5, NULL, 'e', 27, 'en:poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('8480000833891', 'Pan para hornear', 'Baguettes precocidas', 'Mercadona', 'Alimentos y bebidas de origen vegetal', '300g', 'Bolsa, Green dot', 'No volver a congelar, Punto Verde', NULL, 'Germany', 'Harina de _trigo_, agua, levadura, sal yodada (sal, yodato de potásico), dextrosa, corrector de acidez (acetatos de sodio).', 'Gluten', NULL, 1055.0, 249.0, 1.0, 0.5, 50.0, 3.1, 2.5, 8.7, 1.2, 0.48, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 5, 4, 'u', NULL, 'en:bread', 'Mercadona', 'open_food_facts', 100, 'g', true), ('8437011917010', 'Pan campeón del mundo', 'Pan', 'Mercadona', 'Aliments i begudes amb base vegetal', '750 g', 'en:Fresh, Mercadona', NULL, NULL, 'back-shop tiefkühl gmbh', 'Productos de cereales (harina de trigo, harina integral de trigo, harina de centeno, copos de avena), agua, masa madre natural (agua, harina integral de centeno, harina de centeno), semillas de girasol, semillas de lino, semillas de sésamo, levadura, amapola, sal, espesante (E-412), emulgente (E-471), proteína de trigo, jarabe de caramelo, jarabe de azúcar invertido.', 'en:Gluten, en:Sesame seeds', 'en:Gluten', NULL, 241.0, 5.6, 0.9, 36.0, 1.2, 5.8, 8.3, 1.1, 0.44, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'b', 2, 1, 'u', NULL, 'en:bread', 'Mercadona', 'open_food_facts', 100, 'g', true), ('8480000832757', 'Pan de trigo espelta 100%', 'Pan de espelta', 'Mercadona', 'Alimentos y bebidas de origen vegetal', '270g', 'Plástico, Papel, Bolsa', 'PEFC', NULL, 'Valencia,España', 'Harina de trigo espelta (47,4%) (gluten), agua, harina de trigo espelta integral (11,8%) (gluten), masa madre natural de trigo espelta (3,0%) (gluten), levadura, sal y complemento panario (harina de trigo espelta malteada (gluten), emulgente: E-472e y extracto de levadura).', 'Gluten', NULL, NULL, 264.0, 2.3, 0.5, 49.0, 2.0, 3.2, 10.0, 1.3, 0.52, NULL, 0.4, 1.4, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 4, 4, 'u', NULL, 'en:bread', 'Mercadona', 'open_food_facts', 100, 'g', true), ('232847800000100295002957', 'Empanada de verdura', NULL, 'Mercadona', 'Empanadas', '560 g', 'Papel plastico', 'Punto Verde', NULL, 'ORENSE', 'HARINA DE TRIGO GLUTEN, CALABACÍN (13,3 %), CEBOLLA (13,3%) (CEBOLLA ACEITE DE OLIVA, SAL, ESPESANTÉS É412 E410), PIMIENTO (12,1%) (PIMIENTO, AGUA, SÁL, ACIDULANTE E330), CHAMPINONES (6,3%) (CHAMPIÑONÉS AGUA, SÁL), VINO BLANCO SULFITOS, AGUA, ACEITE DE GIRASOL, ACEITE DE OLIVA, FÉCULA DE PATATA,SAL, AZÚCAR ESPECIAS (CURRY), LEVADURA', NULL, 'Apio, Crustáceos, Huevos, Pescado, Altramuces, Leche, Moluscos, Mostaza, Frutos de cáscara, Cacahuetes, Soja', 807.7, 192.3, 6.7, 0.8, 29.0, 2.1, NULL, 4.0, 1.7, 0.68, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 8, 3, 'u', NULL, 'en:pizza-pies-and-quiches', 'Mercadona', 'open_food_facts', 100, 'g', true), ('236839950000100344002755', 'Pa de pessic iogurt', NULL, 'MERCADONA', 'Botanas', '800 g', 'Plástico', 'Sin conservantes, Sin colorantes', NULL, 'SANT JULIA DE LLOR I BONMATÍ (GIRONA)', 'Harina de trigo (gluten), azúcar, huevo líquido pasteurizado, aceite refinado de girasol, yogurt natural 12% (leche entera pasteurizada, nata (leche), proteina de leche, fermentos lacticos (leche)), humectante (glicerina), ralladura de limon, gasificantes (E-500ii, E-4501), sal, espesante (goma xantana)', 'Huevos, Gluten, Leche', 'Frutos de cáscara, Soja', NULL, 394.0, 19.0, 2.9000000953674, 49.0, 25.0, 1.1, 6.3000001907349, 1.4, 0.56, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 19, 4, 'c', 45, 'en:biscuits-and-cakes', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302715003191', 'Lomo adobado', NULL, 'mercadona', NULL, NULL, NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, 117.0, 3.6, 1.38, 0.8, 0.5, NULL, 20.4, 1.7, 0.68, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('8437007122787', 'Arroz Tikka Masala', NULL, 'mercadona', 'Comidas preparadas', '300 g', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 136.0, 3.4, 0.6, 20.0, 1.0, NULL, 5.7, 1.5, 0.6, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 6, NULL, 'u', NULL, 'en:one-dish-meals', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302862003167', 'Longaniza Pollo Fresca', NULL, 'mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 130.0, 6.0, 1.8, 0.8, 0.5, NULL, 16.0, 1.8, 0.72, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2304384003151', 'Medallon de solomillo pavo', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 112.0, 0.7, 0.25, 0.0, 0.0, NULL, 26.0, 0.1, 0.04, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302836004008', 'Pechuga pimentón', NULL, 'mercadona', NULL, NULL, NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, 83.2, 0.0, 0.0, 1.2, 0.0, NULL, 19.6, 1.22, 0.488, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302844003307', 'Pechuga empanada marinada', NULL, 'mercadona', 'Productos a base de carne', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 136.0, 1.2, 0.4, 17.8, 1.4, NULL, 13.5, 1.4, 0.56, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'b', 2, NULL, 'e', 22, 'en:poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('230582780010406500006760', 'Jamón cebo mercadona', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 397.1, 29.5, 9.7, 1.0, 0.5, NULL, 31.9, 3.5, 1.4, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302839004173', 'PINCHOS SIN VARILLA', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 103.0, 27.0, 1.0, 2.0, 0.5, NULL, 17.7, 2.45, 0.98, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('230582670008802200001941', 'Salchichón ibérico', NULL, 'Mercadona', 'Productos a base de carne', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 492.6, 42.6, 17.4, 1.8, 1.6, NULL, 25.6, 3.3, 1.32, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 32, NULL, 'u', NULL, 'en:processed-meat', 'Mercadona', 'open_food_facts', 100, 'g', true)
ON CONFLICT (barcode) WHERE barcode IS NOT NULL DO UPDATE SET
    name = EXCLUDED.name,
    generic_name = COALESCE(EXCLUDED.generic_name, foods.generic_name),
    brand = COALESCE(EXCLUDED.brand, foods.brand),
    category = COALESCE(EXCLUDED.category, foods.category),
    ingredients_text = COALESCE(EXCLUDED.ingredients_text, foods.ingredients_text),
    allergens = COALESCE(EXCLUDED.allergens, foods.allergens),
    calories = COALESCE(EXCLUDED.calories, foods.calories),
    protein_g = COALESCE(EXCLUDED.protein_g, foods.protein_g),
    carbs_g = COALESCE(EXCLUDED.carbs_g, foods.carbs_g),
    fat_g = COALESCE(EXCLUDED.fat_g, foods.fat_g),
    fiber_g = COALESCE(EXCLUDED.fiber_g, foods.fiber_g),
    nutriscore_grade = COALESCE(EXCLUDED.nutriscore_grade, foods.nutriscore_grade),
    nova_group = COALESCE(EXCLUDED.nova_group, foods.nova_group),
    updated_at = now();