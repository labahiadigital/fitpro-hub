INSERT INTO foods (barcode, name, generic_name, brand, category, quantity, packaging, labels, origins, manufacturing_places, ingredients_text, allergens, traces, energy_kj, calories, fat_g, saturated_fat_g, carbs_g, sugars_g, fiber_g, protein_g, salt_g, sodium_mg, alcohol_g, monounsaturated_fat_g, polyunsaturated_fat_g, trans_fat_g, cholesterol_mg, omega3_g, added_sugars_g, starch_g, polyols_g, vitamin_a_ug, vitamin_d_ug, vitamin_e_mg, vitamin_k_ug, vitamin_c_mg, vitamin_b1_mg, vitamin_b2_mg, vitamin_b6_mg, vitamin_b9_ug, vitamin_b12_ug, vitamin_pp_mg, pantothenic_acid_mg, potassium_mg, calcium_mg, phosphorus_mg, iron_mg, magnesium_mg, zinc_mg, copper_mg, manganese_mg, selenium_ug, iodine_ug, caffeine_mg, choline_mg, nutriscore_grade, nutriscore_score, nova_group, ecoscore_grade, ecoscore_score, food_groups, source_supermarket, data_source, serving_size, serving_unit, is_global)
VALUES ('8414807502957', 'Ruedas de patata', 'Aperitivo de harina de patata frito', 'Consum', 'Botanas', '80 g', 'Bolsa de plástico, Green dot', 'Sin gluten, Punto Verde', NULL, 'Spain', 'Fécula de patata (70,36%), aceite de maíz, gránulos de patata (10%), sal, potenciador de sabor (E-621), cúrcuma.', NULL, 'Leche', 1947.0, 464.0, 17.7, 2.6, 74.2, 0.3, 0.8, 1.5, 2.0, 0.8, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 16, 4, 'b', 72, 'en:appetizers', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807500465', 'Miel de romero', 'Miel de Romero', 'Consum', 'Desayunos', '350g', 'Envase de Plastico', 'Sin gluten', 'España', 'Alzira,España', 'Miel de Romero 100%', NULL, 'Ninguno', 1367.0, 332.0, 0.0, 0.0, 83.0, 74.3, 0.0, 0.0, 0.0, 0.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 19, 2, 'a', 85, 'en:sweets', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807503312', 'Patatas light', 'Aperitivo de harina de patata frito', 'Consum', 'Alimentos y bebidas de origen vegetal', '130g', 'Green dot', 'Bajo o sin grasas, Bajo en grasas, Sin gluten, Reducido en grasas, 50% menos de grasa, Punto Verde', NULL, 'Spain', 'Patata deshidratada (49,3%), fécula de patata (31,2%), aceite de maíz, sal.', 'Dióxido de azufre y sulfitos', 'Leche', 1943.0, 463.0, 18.0, 1.8, 67.0, 0.5, 1.9, 7.0, 1.5, 0.6, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 13, 3, 'b', 68, 'en:appetizers', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807531209', 'Mezcla de coles', 'Ensalada lista para consumir', 'Consum', 'Comidas preparadas', '300g', 'Green dot', 'Punto Verde', NULL, 'Spain', 'Repollo, col lombarda.', NULL, NULL, 112.0, 27.0, 0.1, 0.0, 3.9, 3.4, 2.4, 1.3, 0.05, 0.02, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 42.7, NULL, NULL, NULL, 35.5, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -5, 3, 'u', NULL, 'en:one-dish-meals', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807502940', 'Palitos de patata', 'Aperitivo de harina de patata frito', 'Consum', 'Alimentos y bebidas de origen vegetal', '75g', 'Green Dot', 'Sin gluten, Punto Verde, Con aceite de girasol', NULL, 'Spain', 'Fécula de patata (57,6%), aceite de girasol alto oleico (17,4%), puré de patata (15%), almidón modificado de patata (6%), aroma (sustancias aromatizantes, potenciadores de sabor (E-621, E-635), sal, acidulante (E-330), colorante (E-150D)).', NULL, 'Leche', 1936.0, 461.0, 17.4, 2.6, 73.6, 0.5, 1.9, 1.5, 1.88, 0.752, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 16, 4, 'b', 68, 'en:appetizers', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807529541', '100% integral sin azúcares añadidos', 'Pan de molde integral sin azúcares añadidos', 'Consum', 'Alimentos y bebidas de origen vegetal', '460g', 'Green Dot', 'Fuente de fibra alimentaria, Punto Verde, Rico en fibra, Sin azúcares añadidos, Con aceite de girasol', NULL, 'Spain', 'Harina integral de _trigo_ (_gluten_), agua, levadura, aceite de girasol (2%), sal, fibra de _avena_ (_gluten_), emulgentes (E-481, E-471), inulina, conservadores (E-282, E-200), _gluten de trigo_, harina de haba, estabilizante (E-412), aroma.', 'Gluten, Avena', 'Huevos, Leche, Frutos de cáscara, Granos de sésamo, Soja', 1062.0, 252.0, 4.2, 0.8, 41.0, 1.6, 6.7, 9.2, 1.4, 0.56, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'b', 2, 4, 'b', 70, 'en:bread', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807530431', 'Masa de hojaldre redonda', 'Masa hojaldre', 'Consum', 'Alimentos y bebidas de origen vegetal', '230g', 'Envase en cartón', 'Punto Verde', NULL, 'Spain', 'Harina de _trigo_ (_gluten_), materia grasa vegetal (grasa de palma, aceite de girasol), agua, alcohol etílico, sal, zumo de limón concentrado, agente de tratamiento de la harina (L-cisteina). Puede contener trazas de leche.', 'Gluten', 'Leche', 1648.0, 395.0, 23.4, 10.7, 36.5, 0.8, 1.1, 5.9, 0.96, 0.384, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 18, 3, 'd', 33, 'en:cereals', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807548375', 'Pipas tostadas sin sal', 'Pipas de girasol tostadas sin sal', 'Consum', 'Alimentos y bebidas de origen vegetal', '175g', NULL, 'Bajo en sal o sin sal, Sin gluten, No recomendado para ciertas personas, Punto Verde, Sin sal, No recomendado a niños menores de 3 años, Fuente de fósforo, Fuente de vitamina E', NULL, 'Spain', 'Pipas de girasol.', NULL, 'Leche, Frutos de cáscara, Cacahuetes', NULL, 642.0, 54.8, 5.1, 4.7, 3.4, 9.2, 27.9, 0.012, 0.0048, NULL, NULL, 491.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 37.8, NULL, NULL, 0.33, 238.0, NULL, NULL, 0.29, NULL, NULL, NULL, NULL, 1158.0, 6.81, 129.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -11, 1, 'd', 43, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807538796', 'Roller al cacao', 'Producto de pastelería y repostería', 'Consum', 'Botanas', '150g', NULL, 'Punto Verde', NULL, 'Spain', 'Cobertura especial con grasa vegetal (37%) (azúcar, grasas vegetales (palmiste, palma) en proporción variable, cacao desgrasado en polvo (16%), emulgente (lecitina de _soja_), aroma), azúcar, harina de _trigo_ (_gluten_), jarabe de glucosa y fructosa, _huevo_, grasas vegetales (palma, coco) en proporción variable, humectantes (sorbitol, glicerina), dextrosa, clara de _huevo_, aceites vegetales (girasol, soja) en proporción variable, suero de _leche_ en polvo, gasificantes (difosfatos y carbonatos de sodio), emulgente (E-471), conservador (E-202), sal, correctores de acidez (E-262, E-270), colorante (carotenos), aroma.', 'Huevos, Gluten, Leche, Soja', 'Frutos de cáscara, Granos de sésamo', 1827.0, 436.0, 19.0, 14.0, 61.0, 43.0, 2.8, 3.8, 0.382, 0.1528, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 28, 4, 'u', NULL, 'en:biscuits-and-cakes', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807542571', 'Batido sabor vainilla', 'Batido sabor vainilla esterilizado', 'Consum', 'Bebidas', '1 L', NULL, 'Bajo o sin grasas, Bajo en grasas, Sin gluten, Contiene leche, Punto Verde', NULL, 'Spain', '_Leche_ semidesnatada, permeado lácteo reconstituido (_leche_), azúcar, emulgente (E-472c), yema de _huevo_, colorante (E-160 a (ii)), antioxidante (E-300), aroma.', 'Huevos, Leche', NULL, 253.0, 60.0, 1.0, 0.7, 11.0, 11.0, NULL, 1.6, 0.127952755905512, 0.0511811023622048, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 12, 4, 'd', 34, 'en:sweetened-beverages', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807543806', 'Kids: agua Fuente Arquillo', NULL, 'Consum', 'Bebidas', '33 cl', '1', NULL, NULL, 'Albacete', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', 0, 1, 'n', NULL, 'en:waters-and-flavored-waters', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807539977', 'Galletas con chocolate con leche', 'Galletas', 'Consum', 'Botanas', '150 g', NULL, NULL, NULL, NULL, 'Galleta 52% (harina de _trigo_ (_gluten_), azúcar, aceite vegetal (girasol alto oleico), jarabe de glucosa-fructosa, _leche_ desnatada en polvo, gasificantes (carbonato ácido de amonio, carbonato ácido de sodio, difosfato disódico), sal, emulgente (lecitinas (girasol)), aroma), chocolate 48% (azúcar, manteca de cacao, _leche_ desnatada en polvo, pasta de cacao, suero de _leche_ en polvo, mantequilla (_leche_), pasta de _avellana_, emulgente (lecitinas (_soja_)), aroma)', 'Gluten, Leche, Frutos de cáscara, Soja', 'Dióxido de azufre y sulfitos', 2100.0, 501.0, 23.0, 12.0, 66.0, 39.0, 1.6, 5.9, 0.7, 0.28, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 30, 4, 'd', 32, 'en:biscuits-and-cakes', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807547132', 'Margarina ligera', 'Margarina ligera', 'Consum', 'Alimentos y bebidas de origen vegetal', '500 g', NULL, 'Sin gluten, Punto Verde, Fuente de vitamina A, Fuente de vitamina D, Fuente de vitamina E, en:33% less fat', NULL, 'Valencia,España', 'Agua, aceites vegetales (girasol), grasas vegetales (palma, palmiste), _leche_ desnatada en polvo, sal (0,4%), emulgentes (polirricinoleato de poliglicerol), aromas, conservador (sorbato potásico), acidulante (ácido cítrico), colorante (carotenos), vitaminas E, A y D.', 'Leche', NULL, 1494.0, 363.0, 40.0, 12.0, 0.5, 0.5, NULL, 0.5, 0.4, 0.16, NULL, 11.5, 16.5, NULL, NULL, NULL, NULL, NULL, NULL, 853.0, 7.5, 22.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 8, 4, 'c', 49, 'en:salty-and-fatty-products', 'Consum', 'open_food_facts', 100, 'g', true)
ON CONFLICT (barcode) WHERE barcode IS NOT NULL DO UPDATE SET
    name = EXCLUDED.name,
    generic_name = COALESCE(EXCLUDED.generic_name, foods.generic_name),
    brand = COALESCE(EXCLUDED.brand, foods.brand),
    category = COALESCE(EXCLUDED.category, foods.category),
    ingredients_text = COALESCE(EXCLUDED.ingredients_text, foods.ingredients_text),
    allergens = COALESCE(EXCLUDED.allergens, foods.allergens),
    calories = COALESCE(EXCLUDED.calories, foods.calories),
    protein_g = COALESCE(EXCLUDED.protein_g, foods.protein_g),
    carbs_g = COALESCE(EXCLUDED.carbs_g, foods.carbs_g),
    fat_g = COALESCE(EXCLUDED.fat_g, foods.fat_g),
    fiber_g = COALESCE(EXCLUDED.fiber_g, foods.fiber_g),
    nutriscore_grade = COALESCE(EXCLUDED.nutriscore_grade, foods.nutriscore_grade),
    nova_group = COALESCE(EXCLUDED.nova_group, foods.nova_group),
    updated_at = now();