INSERT INTO foods (barcode, name, generic_name, brand, category, quantity, packaging, labels, origins, manufacturing_places, ingredients_text, allergens, traces, energy_kj, calories, fat_g, saturated_fat_g, carbs_g, sugars_g, fiber_g, protein_g, salt_g, sodium_mg, alcohol_g, monounsaturated_fat_g, polyunsaturated_fat_g, trans_fat_g, cholesterol_mg, omega3_g, added_sugars_g, starch_g, polyols_g, vitamin_a_ug, vitamin_d_ug, vitamin_e_mg, vitamin_k_ug, vitamin_c_mg, vitamin_b1_mg, vitamin_b2_mg, vitamin_b6_mg, vitamin_b9_ug, vitamin_b12_ug, vitamin_pp_mg, pantothenic_acid_mg, potassium_mg, calcium_mg, phosphorus_mg, iron_mg, magnesium_mg, zinc_mg, copper_mg, manganese_mg, selenium_ug, iodine_ug, caffeine_mg, choline_mg, nutriscore_grade, nutriscore_score, nova_group, ecoscore_grade, ecoscore_score, food_groups, source_supermarket, data_source, serving_size, serving_unit, is_global)
VALUES ('2302840003844', 'PINCHOS C/VARILLA', NULL, 'mercadona', NULL, NULL, NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, 103.0, 2.7, 1.0, 2.0, 0.5, NULL, 17.7, 2.45, 0.98, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2304353005087', 'Solomillo Setas', NULL, 'mercadona', NULL, NULL, NULL, 'Sin gluten, Sin lactosa', NULL, NULL, NULL, NULL, NULL, NULL, 124.3, 5.5, 1.9, 1.1, 1.1, NULL, 17.6, 1.7, 0.68, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2304351004976', 'Solomillo al romero', NULL, 'mercadona', NULL, NULL, NULL, 'Sin gluten, Sin lactosa', NULL, NULL, NULL, NULL, NULL, NULL, 95.9, 2.3, 0.82, 1.2, 1.2, NULL, 17.6, 1.3, 0.52, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('8436021415011', 'Burget meat pollo', NULL, 'mercadona', NULL, '540 g', NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, 148.0, 7.5, 2.4000000953674, 4.3000001907349, 1.3999999761581, NULL, 16.0, 1.9, 0.76, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2325353002753', 'Solomillo marinado congelado', NULL, 'mercadona', NULL, NULL, NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, 102.0, 1.1, 0.4, 2.7, 0.0, NULL, 20.5, 0.82, 0.328, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2304900002422', 'Chuletas aguja de cerdo', 'Chuletas aguja de cerdo', 'Mercadona', 'Productos a base de carne', '650g', 'Plástico', NULL, NULL, 'spain', 'Chuletas de aguja de cerdo (99,5%), agua, antioxidante E-301 y extracto vegetal. Envasado en atmósfera protectora.', NULL, NULL, 785.5, 189.0, 12.5, 5.0, 1.0, 0.5, NULL, 18.0, 0.2, 0.08, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 4, 1, 'u', NULL, 'en:meat-other-than-poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('8480000225580', 'Bollo pepitas choco', NULL, 'Mercadona', 'Botanas', NULL, NULL, 'Sin gluten, Sin lactosa', NULL, NULL, 'Agua, fibras vegetales, pepitas de chocolate (13%) (azúcar, pasta de cacao, manteca de cacao, lecitina de girasol, aroma natural de vainilla), harina de arroz, almidón de tapioca, aceite de girasol, proteína de arroz, levadura, estabilizantes (E-464, E-415), betacaroteno, sal y aromas, Puede contener trazas de mostaza y sésamo, Temperatura ambiente Mantener en lugar fresco, seco y alejado de los V', NULL, 'Mostaza, Granos de sésamo', NULL, 298.0, 12.6, 3.5, 37.0, 20.3, 10.3, 4.0, 0.9, 0.36, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 11, 4, 'u', NULL, 'en:pastries', 'Mercadona', 'open_food_facts', 100, 'g', true), ('233040790000100170001705', 'Crunchy chicken', NULL, 'Mercadona', 'Productos a base de carne', '2 x 120 g', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 240.0, 13.5, 2.5, 12.5, 1.1, NULL, 17.0, 1.6, 0.64, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 11, NULL, 'e', 22, 'en:poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302807003979', 'Tacos carne de Vacuno', NULL, 'Mercadona', 'Meats and their products', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 119.0, 3.5, 1.4, 0.5, 0.5, NULL, 21.0, 0.19, 0.076, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', 0, NULL, 'u', NULL, 'en:meat-other-than-poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302837003567', 'Chuleta Al Ajillo', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 92.0, 2.3, 0.9, 0.0, NULL, NULL, 18.0, 0.915, 0.366, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2306041004105', 'Longaniza Magra Fresca', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 130.0, 6.0, 1.8, 2.0, 0.5, NULL, 16.0, 1.9675, 0.787, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2303456004652', 'Pincho de pollo', NULL, 'Mercadona', NULL, NULL, NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2301945001939', 'Espinazo', NULL, 'Mercadona', NULL, NULL, NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2325460004497', 'Pechuga Entera Certificada', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 110.0, 2.1, 0.7, 0.0, NULL, NULL, 22.0, 0.1375, 0.055, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('8421610028703', 'Burger meat pollo pavo', 'Preparado de carne', 'Mercadona', 'Productos a base de carne', '500 g', 'Green dot', 'Sin gluten, Punto Verde, Sin lactosa', NULL, 'Spain', 'Carne de pollo 70%, carne de pavo 15%, agua, cereales (harina de arroz), fibra vegetal (guisante), aromas, antioxidantes (E-301, E330), conservador E-221 (_sulfito_), colorante (E-120),', 'Gluten, Dióxido de azufre y sulfitos', NULL, 574.0, 137.0, 6.0, 2.0, 1.0, 0.5, NULL, 19.0, 0.4, 0.16, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -4, 4, 'e', 22, 'en:poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302794004010', 'Filete de pechuga de pavo', NULL, 'Mercadona', 'Productos a base de carne', NULL, NULL, NULL, 'España', 'Sevilla,España', NULL, NULL, NULL, 469.0, 112.1, 1.3, 0.5, 0.0, 0.0, NULL, 25.1, 0.16, 0.064, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -6, NULL, 'd', 30, 'en:poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2304523005152', 'Chuleta de contramuslo de pavo', NULL, 'Mercadona', NULL, NULL, NULL, 'Sin lactosa', NULL, NULL, NULL, NULL, NULL, NULL, 145.0, 7.7, 2.6, NULL, NULL, NULL, 19.0, 0.3, 0.12, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('230582610007604295003261', 'cebo ibérico', NULL, 'Mercadona', 'Productos a base de carne', '42,95', NULL, NULL, NULL, NULL, 'lomo de cerdo de cebo ibérico, sal,especias,azúcar,aceite de oliva,dextrosa,antioxidante y conservadores. Envoltura nocomestible.Puede contener Leche y Soja', 'Leche', 'Soja', 1248.0, 298.35, 15.5, 6.3, 0.7, 0.6, 30.0, 39.1, 3.0, 1.2, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 18, 4, 'u', NULL, 'en:processed-meat', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302862002740', 'Longaniza de pollo fresca', NULL, 'mercadona', 'Productos a base de carne', NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 130.0, 6.0, 1.8, 0.8, 0.5, NULL, 16.0, 1.8, 0.72, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 4, NULL, 'e', 22, 'en:poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2383853001607', 'Pan 100% integral', NULL, 'Mercadona', 'Alimentos y bebidas de origen vegetal', '350 gr', NULL, NULL, NULL, NULL, 'Harina integral de trigo (63%), agua, sal, levadura', 'Gluten', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 19, 3, 'u', NULL, 'en:bread', 'Mercadona', 'open_food_facts', 100, 'g', true), ('8480005639313', 'Croissant pequeño', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 402.777777777778, 22.5000010596381, 10.5555554231008, 40.5555566151937, 9.1666665342119, 2.49999993377262, 8.33333333333333, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2304116003312', 'Butifarra fresca de cerdo', NULL, 'Mercadona', 'Productos a base de carne', NULL, NULL, 'Sin gluten, Sin lactosa', NULL, NULL, NULL, NULL, NULL, NULL, 222.0, 18.0, 6.0, 2.0, 0.5, NULL, 13.0, 1.8, 0.72, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 15, NULL, 'u', NULL, 'en:processed-meat', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2304524005014', 'Filete pechuga pavo', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 112.1, 1.3, 0.5, 0.0, 0.0, NULL, 25.1, 0.16, 0.064, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('230583750007405000003703', 'Jamón bellota', NULL, 'Mercadona', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 1.344, 20.0, 7.2, 1.0, 0.5, NULL, 34.0, 5.4, 2.16, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302862003082', 'Longaniza pollo fresca', NULL, 'Mercadona', NULL, NULL, NULL, 'Sin gluten, Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 130.0, 6.0, 1.8, 0.8, 0.5, NULL, 16.0, 1.8, 0.72, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true)
ON CONFLICT (barcode) WHERE barcode IS NOT NULL DO UPDATE SET
    name = EXCLUDED.name,
    generic_name = COALESCE(EXCLUDED.generic_name, foods.generic_name),
    brand = COALESCE(EXCLUDED.brand, foods.brand),
    category = COALESCE(EXCLUDED.category, foods.category),
    ingredients_text = COALESCE(EXCLUDED.ingredients_text, foods.ingredients_text),
    allergens = COALESCE(EXCLUDED.allergens, foods.allergens),
    calories = COALESCE(EXCLUDED.calories, foods.calories),
    protein_g = COALESCE(EXCLUDED.protein_g, foods.protein_g),
    carbs_g = COALESCE(EXCLUDED.carbs_g, foods.carbs_g),
    fat_g = COALESCE(EXCLUDED.fat_g, foods.fat_g),
    fiber_g = COALESCE(EXCLUDED.fiber_g, foods.fiber_g),
    nutriscore_grade = COALESCE(EXCLUDED.nutriscore_grade, foods.nutriscore_grade),
    nova_group = COALESCE(EXCLUDED.nova_group, foods.nova_group),
    updated_at = now();