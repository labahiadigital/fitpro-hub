INSERT INTO foods (barcode, name, generic_name, brand, category, quantity, packaging, labels, origins, manufacturing_places, ingredients_text, allergens, traces, energy_kj, calories, fat_g, saturated_fat_g, carbs_g, sugars_g, fiber_g, protein_g, salt_g, sodium_mg, alcohol_g, monounsaturated_fat_g, polyunsaturated_fat_g, trans_fat_g, cholesterol_mg, omega3_g, added_sugars_g, starch_g, polyols_g, vitamin_a_ug, vitamin_d_ug, vitamin_e_mg, vitamin_k_ug, vitamin_c_mg, vitamin_b1_mg, vitamin_b2_mg, vitamin_b6_mg, vitamin_b9_ug, vitamin_b12_ug, vitamin_pp_mg, pantothenic_acid_mg, potassium_mg, calcium_mg, phosphorus_mg, iron_mg, magnesium_mg, zinc_mg, copper_mg, manganese_mg, selenium_ug, iodine_ug, caffeine_mg, choline_mg, nutriscore_grade, nutriscore_score, nova_group, ecoscore_grade, ecoscore_score, food_groups, source_supermarket, data_source, serving_size, serving_unit, is_global)
VALUES ('5413056033321', '6 panes de ajo', NULL, 'Mercadona', 'Alimentos y bebidas de origen vegetal', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 315.0, 11.8, 4.7, 44.3, 3.1, NULL, 7.9, 1.55, 0.62, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 14, NULL, 'u', NULL, 'en:bread', 'Mercadona', 'open_food_facts', 100, 'g', true), ('230035050239000103002460', 'Sandía partida', NULL, 'mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('8480000840752', 'Bollo relleno de crema de cacao', NULL, 'Mercadona', 'Botanas', NULL, NULL, 'DO', NULL, NULL, 'Harina de trigo, crema de cacao 25% (azúcar, aceites y grasas vegetales (palma y girasol en proporciones varíables), cacao desgrasado en polvo, pasta de avellana, emulgente (lecitina de soja), aromas), agua, aceites y grasas vegetales (palma y girasol), levadura, azúcar invertido, azucar, sal, emulgentes (E-471, E-472e, E-481), espesantes (E-466), antioxidantes (E-306, E-304, E-300), acidulante (E-330) colorantes (E-160a), conservadores (E-282, E-200, E-202), aromas. Trazas de sésamo y leche y/o derivados.', 'Gluten, Frutos de cáscara, Soja', 'Granos de sésamo', NULL, 385.0, 17.0, 6.2, 52.0, 21.0, NULL, 6.7, 1.0, 0.4, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 20, 4, 'u', NULL, 'en:biscuits-and-cakes', 'Mercadona', 'open_food_facts', 100, 'g', true), ('231027140041500461001912', 'Filetes de lomo de cerdo', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 0.0, 0.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2304332002144', 'Morcilla de cerdo y arroz', NULL, 'mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 209.0, 10.39999961853, 4.5, 24.0, 1.7000000476837, NULL, 5.0, 1.3999999761581, 0.56, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('233028700000100256002562', 'Preparado de carne picada pollo y pavo', NULL, 'mercadona', NULL, '500 g', NULL, 'Sin gluten, Sin lactosa', NULL, NULL, NULL, NULL, NULL, NULL, 137.0, 6.0, 2.0, 1.0, 0.5, NULL, 19.0, 0.4, 0.16, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('8437009925430', '3 barras de pan', NULL, 'Mercadona', 'Alimentos y bebidas de origen vegetal', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 298.0, 1.2, 0.3, 58.0, 1.5, NULL, 10.3, 1.9, 0.76, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 12, NULL, 'u', NULL, 'en:bread', 'Mercadona', 'open_food_facts', 100, 'g', true), ('230035150177600089001587', 'Melón partido', NULL, 'Mercadona', 'Alimentos y bebidas de origen vegetal', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'b', 74, 'en:fruits', 'Mercadona', 'open_food_facts', 100, 'g', true), ('8421610028673', 'Preparado de carne picada de cerdo', NULL, 'mercadona', 'Productos a base de carne', '500 g', NULL, 'Sin gluten, Sin colorantes, Sin lactosa', NULL, NULL, NULL, NULL, NULL, NULL, 212.0, 16.0, 5.0, 1.0, 1.0, NULL, 17.0, 0.2, 0.08, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 4, NULL, 'u', NULL, 'en:meat-other-than-poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2304571003063', 'Chuletas de cerdo Sajonia', NULL, 'mercadona', 'Productos a base de carne', NULL, NULL, 'Sin gluten, Sin lactosa', NULL, NULL, NULL, NULL, NULL, NULL, 135.0, 6.5, 2.3, 1.5, 1.3, NULL, 17.5, 2.2, 0.88, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 13, NULL, 'u', NULL, 'en:meat-other-than-poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2304176002744', 'Medallones de solomillo marinado de cerdo', NULL, 'Mercadona', 'Productos a base de carne', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 100.0, 3.2, 1.1, 0.4, 0.4, NULL, 17.4, 1.0, 0.4, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 4, NULL, 'u', NULL, 'en:meat-other-than-poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('8424465964646', 'Berlinas decoradas DESCATALOGADO', NULL, 'mercadona', 'Botanas', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 425.0, 25.0, 13.0, 41.0, 17.0, NULL, 7.0, 1.1, 0.44, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 24, NULL, 'b', 68, 'en:biscuits-and-cakes', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302787004348', 'Filetes de pechuga de pollo', NULL, 'Mercadona', 'Productos a base de carne', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 108.0, 1.7999999523163, 0.60000002384186, 0.5, 0.0, NULL, 22.0, 0.18999999761581, 0.076, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -6, NULL, 'e', 22, 'en:poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302794003983', 'Filete de pechuga de pavo', NULL, 'mercadona', 'Productos a base de carne', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 113.0, 2.0, 0.72, 0.0, 0.0, NULL, 23.8, 0.35, 0.14, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -5, NULL, 'e', 22, 'en:poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('8436554810048', 'Roscón de Reyes relleno de crema', NULL, 'Mercadona', 'Botanas', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 273.0, 6.6, 3.9, 47.0, 27.0, NULL, 5.7, 0.73, 0.292, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 16, NULL, 'd', 36, 'en:biscuits-and-cakes', 'Mercadona', 'open_food_facts', 100, 'g', true), ('236870140000100560001404', 'Fartons', NULL, 'Mercadona', 'Botanas', '250 g', NULL, NULL, NULL, NULL, 'Harina de trigo, manteca de cerdo (manteca de cerdo en rama, antioxidante: E-306), cobertura (azúcar, jarabe de glucosa, agua y emulsionante: E-471), agua, azúcar, huevo líquido pasteurizado, levadura, mejorante panario (gluten de trigo, harina de trigo, emulgentes: E-471, E-472e y E-481, antioxidante: ácido ascórbico, levadura desactivada y enzimas), sal, aceite de girasol y aroma.', 'Huevos, Gluten', 'Huevos, Gluten, Leche, Frutos de cáscara, Soja, Dióxido de azufre y sulfitos', NULL, 463.0, 27.0, 13.0, 49.0, 13.0, 1.9, 6.2, 0.49, 0.196, 0.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 20, 4, 'u', NULL, 'en:biscuits-and-cakes', 'Mercadona', 'open_food_facts', 100, 'g', true), ('232846580000100100001009', 'Magdalenas de yogur', NULL, 'Mercadona', 'Botanas', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 447.0, 25.0, 3.3, 51.0, 27.0, NULL, 4.7, 0.8, 0.32, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 18, NULL, 'b', 60, 'en:biscuits-and-cakes', 'Mercadona', 'open_food_facts', 100, 'g', true), ('8437008870052', '6 panes artesanos', NULL, 'Mercadona', 'Alimentos y bebidas de origen vegetal', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 270.0, 1.3, 0.3, 57.0, 2.2, NULL, 7.4, 1.2, 0.48, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 5, NULL, 'u', NULL, 'en:bread', 'Mercadona', 'open_food_facts', 100, 'g', true), ('3417514135154', '5 panes integrales', NULL, 'Mercadona', 'Alimentos y bebidas de origen vegetal', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 256.0, 1.3, 0.2, 49.0, 2.9, NULL, 10.0, 1.4, 0.56, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 5, NULL, 'u', NULL, 'en:bread', 'Mercadona', 'open_food_facts', 100, 'g', true), ('8413248303192', 'Panellets DESCATALOGADO', NULL, 'Mercadona', 'Botanas', '275 g', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 499.0, 29.6, 3.2, 44.5, 41.2, NULL, 10.8, 0.01, 0.004, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 21, NULL, 'u', NULL, 'en:sweets', 'Mercadona', 'open_food_facts', 100, 'g', true), ('232846120000100090000905', 'Croissant para rellenar DESCATALOGADO', NULL, 'Mercadona', 'Botanas', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 487.0, 29.0, 16.0, 48.0, 7.1, NULL, 8.5, 0.96, 0.384, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 22, NULL, 'u', NULL, 'en:biscuits-and-cakes', 'Mercadona', 'open_food_facts', 100, 'g', true), ('8480000694768', 'Mix de verduras con setas DESCATALOGADO', NULL, 'Mercadona', 'Aliments et boissons à base de végétaux', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 40.0, 0.3, 0.06, 6.2, 2.1, NULL, 2.3, 0.05, 0.02, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', 0, NULL, 'n', NULL, 'en:vegetables', 'Mercadona', 'open_food_facts', 100, 'g', true), ('232847620000100155001551', 'Focaccia de kale DESCATALOGADO', NULL, 'Mercadona', 'Alimentos y bebidas de origen vegetal', '120 g.', NULL, NULL, NULL, NULL, 'Harina de trigo, Kale 37%, levadura, aceite de Nabina, harina de arroz, sal, aceite de girasol, E 282, E 202.', 'Gluten', 'Apio, Huevos, Altramuces, Leche, Mostaza, Granos de sésamo, Soja, Dióxido de azufre y sulfitos', NULL, 224.0, 3.1, 0.4, 41.0, 1.5, 0.0, 8.2, 0.65, 0.26, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'b', 2, 3, 'u', NULL, 'en:bread', 'Mercadona', 'open_food_facts', 100, 'g', true), ('232846880000100125001252', 'Caracolas rellenas de cacao', NULL, 'Mercadona', 'Botanas', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 451.0, 25.0, 11.0, 50.0, 18.0, NULL, 6.5, 0.87, 0.348, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 24, NULL, 'u', NULL, 'en:biscuits-and-cakes', 'Mercadona', 'open_food_facts', 100, 'g', true), ('8436021411396', 'Burger de pavo y pollo', NULL, 'Mercadona', 'Productos a base de carne', '540 g (6 x 90 g)', NULL, 'Sin gluten, 100% vegetal, Punto Verde, Recicla-amarillo', NULL, 'Valencia,España', 'carne de pavo 55%, carne de pollo 26%, agua, proteína de _soja_, fibras vegetales, sal, vegetales (arroz), aromas, dextrosa, antioxidante E301, antioxidante E331, colorante E120, conservador E221 (_sulfito_), especias.', 'Soja, Dióxido de azufre y sulfitos', 'Leche', 542.0, 129.0, 5.0, 2.0, 2.6, 1.2, NULL, 18.4, 1.7, 0.68, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 3, 4, 'e', 22, 'en:poultry', 'Mercadona', 'open_food_facts', 100, 'g', true)
ON CONFLICT (barcode) WHERE barcode IS NOT NULL DO UPDATE SET
    name = EXCLUDED.name,
    generic_name = COALESCE(EXCLUDED.generic_name, foods.generic_name),
    brand = COALESCE(EXCLUDED.brand, foods.brand),
    category = COALESCE(EXCLUDED.category, foods.category),
    ingredients_text = COALESCE(EXCLUDED.ingredients_text, foods.ingredients_text),
    allergens = COALESCE(EXCLUDED.allergens, foods.allergens),
    calories = COALESCE(EXCLUDED.calories, foods.calories),
    protein_g = COALESCE(EXCLUDED.protein_g, foods.protein_g),
    carbs_g = COALESCE(EXCLUDED.carbs_g, foods.carbs_g),
    fat_g = COALESCE(EXCLUDED.fat_g, foods.fat_g),
    fiber_g = COALESCE(EXCLUDED.fiber_g, foods.fiber_g),
    nutriscore_grade = COALESCE(EXCLUDED.nutriscore_grade, foods.nutriscore_grade),
    nova_group = COALESCE(EXCLUDED.nova_group, foods.nova_group),
    updated_at = now();