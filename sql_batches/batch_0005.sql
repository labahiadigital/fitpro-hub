INSERT INTO foods (barcode, name, generic_name, brand, category, quantity, packaging, labels, origins, manufacturing_places, ingredients_text, allergens, traces, energy_kj, calories, fat_g, saturated_fat_g, carbs_g, sugars_g, fiber_g, protein_g, salt_g, sodium_mg, alcohol_g, monounsaturated_fat_g, polyunsaturated_fat_g, trans_fat_g, cholesterol_mg, omega3_g, added_sugars_g, starch_g, polyols_g, vitamin_a_ug, vitamin_d_ug, vitamin_e_mg, vitamin_k_ug, vitamin_c_mg, vitamin_b1_mg, vitamin_b2_mg, vitamin_b6_mg, vitamin_b9_ug, vitamin_b12_ug, vitamin_pp_mg, pantothenic_acid_mg, potassium_mg, calcium_mg, phosphorus_mg, iron_mg, magnesium_mg, zinc_mg, copper_mg, manganese_mg, selenium_ug, iodine_ug, caffeine_mg, choline_mg, nutriscore_grade, nutriscore_score, nova_group, ecoscore_grade, ecoscore_score, food_groups, source_supermarket, data_source, serving_size, serving_unit, is_global)
VALUES ('0230278900454', 'Contramuslo Deshuesado', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 117.112810707457, 1.7, NULL, 0.5, NULL, NULL, 25.0, 0.1075, 0.043, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('8480000126139', 'Ensalada pollo queso', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 166.108986615679, 12.0, 2.8, 6.3, 5.0, 1.2, 7.9, 0.835, 0.334, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('230084920018602500004651', 'Jamón reserva lonchas', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 247.8, 12.2, NULL, 1.0, NULL, NULL, 33.6, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('8480000094926', 'Muesli 50% frutas y frutos secos', NULL, 'Hacendado, Mercadona', 'Plant-based foods and beverages', '500 g', 'Plastic, Bag', 'Source of fibre, Green Dot, High fibres', NULL, NULL, ',Copos laminados de _cebada_ integral (34%), uvas pasas sultanas (20%), copos laminados de _avena_ integral (10%), trozos de chips de banana azucarados (5%) (banana, aceite de coco, azúcar), trozos de dátil desecados, copos tostados de _trigo_ (5%), (_trigo_, azúcar, sal, extracto de malta de _cebada_), trozos de piña azucarados y desecados (5%) (piña, azúcar, acidulante: ácido cítrico), trozos de chips de coco azucarados (cacao, azúcar), trozos de papaya azucarados y desecados (3%) (papaya, azúcar), semillas de calabaza, _almendras_ (1%), trozos de _nueces pecanas_, trozos de _avellanas_ blanqueadas y tostadas,', 'Banana, Gluten, Nuts, es:Avena, es:Nueces pecanas', 'Milk, Nuts, Peanuts, Sesame seeds, Soybeans', 1542.0, 367.0, 9.3, 5.1, 60.0, 26.0, 7.8, 6.8, 0.11, 0.044, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 10, 3, 'b', 67, 'en:breakfast-cereals', 'Mercadona', 'open_food_facts', 100, 'g', true), ('8402001025518', 'Omega 3 milk', NULL, 'Hacendado, Mercadona', 'Beverages and beverages preparations', '1 l', NULL, 'No gluten, Green Dot', 'Spain', NULL, 'Leche desnatada, aceites vegetales (girasol alto oleico y oliva), aceite rico en DHA y EPA procedente de las microalgas Schizochytrium sp., emulgente (monoglicéridos y diglicéridos de ácidos grasos), estabilizante (E-451) y vitaminas: acetato de retinilo (vitamina A), colecalciferol (vitamina D), acetato de DL-alfa tocoferilo (vitamina E), L-ascorbato de sodio (vitamina C), ácido pteroilmonoglutamático (ácido fólico) y clorhidrato de piridoxina (vitamina B6).', 'Milk', NULL, 212.0, 51.0, 2.1, 0.5, 4.8, 4.8, NULL, 3.1, 0.14, 0.056, NULL, 1.4, 0.1, NULL, NULL, NULL, NULL, NULL, NULL, 0.00012, 7.5e-07, 0.0018, NULL, 0.019, NULL, NULL, 0.00021, 3e-05, NULL, NULL, NULL, NULL, 0.11, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'b', 0, 4, 'u', NULL, 'en:unsweetened-beverages', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302785002650', 'Alas partidas', NULL, 'mercadona', NULL, '12 x 33 cl', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 155.0, 8.5, NULL, 0.6, NULL, NULL, 19.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302860002957', 'Filetes de higado de cordero', NULL, 'mercadona', 'Productos a base de carne', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 135.0, 3.1, 1.4, 5.3, 2.4, NULL, 21.5, 0.173, 0.0692, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', 0, NULL, 'u', NULL, 'en:meat-other-than-poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302860004036', 'Filetes de higado', NULL, 'Mercadona', 'Productos a base de carne', NULL, NULL, 'Punto Verde', 'España', NULL, 'Higado de cordero (en filetes)', NULL, NULL, 570.0, 135.0, 3.1, 1.4, 5.3, 2.4, NULL, 21.5, 0.173, 0.0692, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', 0, NULL, 'u', NULL, 'en:meat-other-than-poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('8402001028373', '3 vienas andaluzas', NULL, 'Mercadona', 'Plant-based foods and beverages', '3x130g', NULL, 'Green Dot', 'Spain', NULL, 'Harina de trigo (gluten), agua, levadura, sal, antiaglomerante (E-170), agente de tratamiento de la harina (E-300), enzimas y fibra de leguminosa.   Puede contener trazas de soja, mostaza, granos de sésamo y frutos de cáscara.', 'Gluten', 'Mustard, Nuts, Sesame seeds, Soybeans', 1005.0, 237.0, 1.0, 0.5, 48.0, 1.7, 2.7, 7.6, 1.2, 0.48, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 4, 4, 'u', NULL, 'en:bread', 'Mercadona', 'open_food_facts', 100, 'g', true), ('8402001007255', 'Pechuga de pavo adobada', NULL, 'Mercadona', 'Productos a base de carne', '37 g', NULL, NULL, NULL, NULL, '8, uds, GS ELABORADOS PAVO LACTOSA CAUTEN FECHA DE CADUCIDAD PECHUGA LAGOSA DATIN DE PAVO ADOBADA FECHA DE CADUCIDAD 21,04,23 R06 Lote: 0000001604 PESO NETO: 21,0 2 Lot 00 X 370 g (2x185 g)', NULL, NULL, NULL, 74.0, 0.8, 0.3, 1.5, 0.6, NULL, 15.3, 1.8, 0.72, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'b', 2, NULL, 'e', 22, 'en:poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('8436009777797', 'Empanada Atun', NULL, 'Mercadona', 'Meals', NULL, NULL, 'PEFC', NULL, NULL, 'Farinha de _trigo_ (_glúten_), cebola (cebola,azeite, espessantes E410 e E412), _atum_ (_peixe_) 19,7% (atum, óleo de girassol, sal), água, óleo de girassol, pimento, vinho branco, curgete, tomate, azeite, açúcar, (_ovo_) pasteurizado, sal, amido de milho pré-gelatinizado, especiarias, fermento (_glúten_), humidificante E420i. Pode conter vestígios de frutos de casca rija e derivados, sésamo, leite e derivados (incluindo lactose), moluscos, soja, aipo, crustáceos, mostarda, sulfitos, tremoço e amendoins.', 'Celery, Crustaceans, Eggs, Fish, Gluten, Lupin, Molluscs, Mustard, Peanuts', 'Celery, Crustaceans, Lupin, Milk, Molluscs, Mustard, Peanuts, Sesame seeds, Soybeans, Sulphur dioxide and sulphites', 976.0, 234.0, 10.0, 1.0, 26.0, 3.0, 1.6, 7.8, 1.1, 0.44, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 4, 4, 'u', NULL, 'en:pizza-pies-and-quiches', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2313706007111', 'Pollo asadi', NULL, 'mercadona', NULL, NULL, NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, 183.0, 10.0, 2.1, 0.8, NULL, NULL, 22.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('8402001025143', 'Queso Fresco Light', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 219.9, 14.4, 10.0, 2.1, 2.05, NULL, 19.91, 3.25, 1.3, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302807004563', 'Vacuno a tacos', NULL, 'mercadona', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 119.0, 35.0, 1.4, 0.5, 0.5, NULL, 21.0, 0.2, 0.08, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302834004864', 'Filete ajillo marinado', NULL, 'mercadona', NULL, NULL, NULL, 'Sin gluten, Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 452.0, 2.8, 1.2, 1.3, 0.5, NULL, 19.2, 0.73, 0.292, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302833003851', 'Pechuga finas hierbas marinada', NULL, 'mercadona', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 86.0, 1.1, 0.4, 1.2, 0.1, NULL, 17.6, 2.0, 0.8, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2304571002868', 'Chuletas de Sajonia', NULL, 'mercadona', NULL, NULL, NULL, 'Sin gluten, Punto Verde, Sin lactosa', NULL, NULL, NULL, NULL, NULL, NULL, 135.0, 6.5, 2.3, 1.5, 1.3, NULL, 17.5, 2.2, 0.88, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('231695870096500094000918', 'Verduras para cocido', NULL, 'Mercadona', 'Alimentos y bebidas de origen vegetal', NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'n', NULL, 'en:vegetables', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302833004025', 'Pechuga finas hierbas marinada', NULL, 'mercadona', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 86.5, 1.1, 0.4, 1.2, 0.1, NULL, 17.6, 2.0, 0.8, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2301283003220', 'Longaniza fresca', NULL, 'mercadona', NULL, NULL, NULL, 'Sin gluten, Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 208.0, 16.0, 5.5, 1.8, 0.9, NULL, 14.1, 2.2, 0.88, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2325972004008', 'Medio conejo troceado', NULL, 'mercadona', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 133.0, 5.74, 2.1, 3.0, 1.0, NULL, 20.25, 0.1, 0.04, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302836004510', 'Elaborados - Pechuga Pavo Pimentón', NULL, 'mercadona', NULL, NULL, NULL, 'Sin gluten, Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 104.0, 1.0, 0.4, 3.2, 0.0, NULL, 20.6, 1.51, 0.604, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2304277002988', 'Filete de contramuslo', NULL, 'Mercadona', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 484.0, 3.1, 1.2, 0.0, 0.0, NULL, 22.0, 0.21, 0.084, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302787004966', 'Filete de pechuga de pollo', NULL, 'mercadona', 'Productos a base de carne', NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 107.0, 1.8, 0.55, 0.4, 0.1, 0.0, 22.0, 0.0, 0.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -6, NULL, 'e', 22, 'en:poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302854002840', 'Gallina', NULL, 'Mercadona', 'Productos a base de carne', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 169.0, 8.8, 2.6, 3.8, 0.0, NULL, 18.6, 0.245, 0.098, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -2, NULL, 'e', 22, 'en:poultry', 'Mercadona', 'open_food_facts', 100, 'g', true)
ON CONFLICT (barcode) WHERE barcode IS NOT NULL DO UPDATE SET
    name = EXCLUDED.name,
    generic_name = COALESCE(EXCLUDED.generic_name, foods.generic_name),
    brand = COALESCE(EXCLUDED.brand, foods.brand),
    category = COALESCE(EXCLUDED.category, foods.category),
    ingredients_text = COALESCE(EXCLUDED.ingredients_text, foods.ingredients_text),
    allergens = COALESCE(EXCLUDED.allergens, foods.allergens),
    calories = COALESCE(EXCLUDED.calories, foods.calories),
    protein_g = COALESCE(EXCLUDED.protein_g, foods.protein_g),
    carbs_g = COALESCE(EXCLUDED.carbs_g, foods.carbs_g),
    fat_g = COALESCE(EXCLUDED.fat_g, foods.fat_g),
    fiber_g = COALESCE(EXCLUDED.fiber_g, foods.fiber_g),
    nutriscore_grade = COALESCE(EXCLUDED.nutriscore_grade, foods.nutriscore_grade),
    nova_group = COALESCE(EXCLUDED.nova_group, foods.nova_group),
    updated_at = now();