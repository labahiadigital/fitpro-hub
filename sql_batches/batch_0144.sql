INSERT INTO foods (barcode, name, generic_name, brand, category, quantity, packaging, labels, origins, manufacturing_places, ingredients_text, allergens, traces, energy_kj, calories, fat_g, saturated_fat_g, carbs_g, sugars_g, fiber_g, protein_g, salt_g, sodium_mg, alcohol_g, monounsaturated_fat_g, polyunsaturated_fat_g, trans_fat_g, cholesterol_mg, omega3_g, added_sugars_g, starch_g, polyols_g, vitamin_a_ug, vitamin_d_ug, vitamin_e_mg, vitamin_k_ug, vitamin_c_mg, vitamin_b1_mg, vitamin_b2_mg, vitamin_b6_mg, vitamin_b9_ug, vitamin_b12_ug, vitamin_pp_mg, pantothenic_acid_mg, potassium_mg, calcium_mg, phosphorus_mg, iron_mg, magnesium_mg, zinc_mg, copper_mg, manganese_mg, selenium_ug, iodine_ug, caffeine_mg, choline_mg, nutriscore_grade, nutriscore_score, nova_group, ecoscore_grade, ecoscore_score, food_groups, source_supermarket, data_source, serving_size, serving_unit, is_global)
VALUES ('2302844003406', 'Pechuga empanada marinada', NULL, 'Mercadona', 'Productos a base de carne', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 136.0, 1.2, 0.4, 17.8, 1.4, NULL, 13.5, 1.4, 0.56, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'b', 2, NULL, 'e', 22, 'en:poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('230030990074200389002898', 'Papaya partida', NULL, 'Mercadona', 'Alimentos y bebidas de origen vegetal', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 0.0, 0.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'a', 77, 'en:fruits', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2304156003501', 'Brocheta de pavo', NULL, 'mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 98.0, 3.1, 1.15, 2.6, 0.0, NULL, 14.9, 0.6, 0.24, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2380856005106', 'Pollo Asado', NULL, 'mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 183.0, 10.0, 2.1, 0.8, 0.5, NULL, 22.0, 0.8, 0.32, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302787004089', 'Filete de Pechuga', NULL, 'mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 107.0, 1.6, 0.5, 0.0, 0.0, NULL, 23.0, 0.16, 0.064, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2304351004099', 'Solomillo Romero', NULL, 'mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 96.0, 2.3, 0.82, 1.2, 1.2, NULL, 17.6, 1.3, 0.52, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302794003686', 'Filete de Pechuga de Pavo', NULL, 'mercadona', 'Filete de Pechuga de Pavo', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 113.0, 2.0, 0.72, 0.0, 0.0, NULL, 23.8, 0.35, 0.14, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -5, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302794003679', 'Filete de pechuga de pavo', NULL, 'mercadona', 'Filete de Pechuga de Pavo', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 113.0, 2.0, 0.72, 0.0, 0.0, NULL, 23.8, 0.35, 0.14, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -5, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302794004058', 'Filete de pechuga de pavo', NULL, 'mercadona', 'Filete de Pechuga de Pavo', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 113.0, 2.0, 0.72, 0.0, 0.0, NULL, 23.8, 0.35, 0.14, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -5, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302839003763', 'Pinchos sin varilla', NULL, 'mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 103.0, 2.7, 1.0, 2.0, 0.5, NULL, 17.7, 2.45, 0.98, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302787003990', 'Filete de pechuga', NULL, 'Mercadona', 'Productos a base de carne', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 94.0, 0.5, 0.1, 0.5, 0.5, NULL, 20.0, 0.2, 0.08, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -6, NULL, 'e', 22, 'en:poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2303735001815', 'Mollejas de pollo', NULL, 'mercadona', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 74.0, 1.2, 0.5, 0.0, 0.0, NULL, 16.0, 0.27, 0.108, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302836003988', 'Pechuga pimenton', NULL, 'mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 104.0, 1.0, 0.35, 3.2, 0.0, NULL, 20.6, 1.51, 0.604, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('8425926000026', 'Barra artesana con masa madre', NULL, 'mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 259.0, 1.2, 0.4, 52.0, 1.8, NULL, 8.8, 1.42, 0.568, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2305061002405', 'Pechuga de Pollo ajillo marinada', NULL, 'mercadona', NULL, NULL, NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, 118.0, 3.1, 0.7, 3.2, 0.7, NULL, 18.9, 1.72, 0.688, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('232835670000100120001203', 'Hogaza 100% natural', NULL, 'Mercadona', 'Alimentos y bebidas de origen vegetal', '365 g', NULL, 'Sin conservantes, Sin azúcares añadidos, Sin lactosa', NULL, 'Alcalá de Henares,España', 'Harina de trigo (gluten), agua, levadura, sal, aceite de girasol, vinagre, masa madre inactiva de trigo (gluten) (4%), masa madre inactiva de centeno (gluten) (0,2%), ácido ascórbico.', 'Gluten', 'Granos de sésamo', NULL, 274.0, 2.4, 0.4, 50.1, 2.5, NULL, 11.9, 0.67, 0.268, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'b', 2, 3, 'u', NULL, 'en:bread', 'Mercadona', 'open_food_facts', 100, 'g', true), ('8436554810055', 'Roscón de Reyes relleno de cabello', NULL, 'Mercadona', 'Botanas', '800 g', NULL, NULL, NULL, 'La Tahona de Utiel S. L.', 'Cabello de ángel triturado (44,87 %) (pulpa de calabaza, azúcar, glucosa, espesantes: E-1420 y E-410; regulador de la acidez: ácido citrico, conservantes: E-202 y E-223, aromas), harina de trigo, fruta confitada (7,30%) (naranja, calabaza roja y verde, cereza roja y verde, azúcar, jarabe de glucosa y fructosa, acidulante: ácido cítrico, conservantes: E-202, E-223 y colorantes: E-100, E-120, E-127 y E-133), huevo liquido pasteurizado, azúcar, agua, almendra (2,79 %), margarina (aceites y grasas vegetales (coco, girasol), agua, emulgente: E-471 y acidulante: ácido citrico), aceite de girasol, azúcar invertido (jarabe de azúcar invertido, conservante: sorbato potásico), levadura, gluten de trigo, sal, suero de leche, humectante: jarabe de sorbitol, mejorante panario (harina de trigo, gluten de trigo, antiaglomerante: E-170, emulgentes: E-481, E-471 y E-472e, agente tratamiento de la harina: E-300 y enzimas), aromas, ralladura de naranja (piel de naranja, jarabe de glucosa y fructosa, azúcar, acidulante: ácido citrico, conservantes: sorbato potásico y metabisulfito sódico) y colorante (extracto de azafrán y maltodextrina natural de maiz)', 'Huevos, Gluten, Leche, Frutos de cáscara, Dióxido de azufre y sulfitos', 'Gluten, Soja', NULL, 299.0, 5.0, 1.7, 56.0, 31.0, 2.7, 6.4, 0.65, 0.26, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 15, 4, 'u', NULL, 'en:biscuits-and-cakes', 'Mercadona', 'open_food_facts', 100, 'g', true), ('231027920051000464002374', 'Pavo a tacos', NULL, 'Mercadona', 'Productos a base de carne', NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 117.9, 3.9, 1.5, 0.0, 0.0, NULL, 20.7, 0.25, 0.1, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -4, NULL, 'e', 22, 'en:poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('230582810011505000005754', 'Taco a cuchillo', NULL, 'Mercadona', NULL, NULL, NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302685003191', 'Secreto de cerdo', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2304251004083', 'FILETE DE PECHUGA', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 475.0, 1.7000000476837, 0.5, 0.89999997615814, 0.69999998807907, NULL, 22.299999237061, 0.30000001192093, 0.12, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302853001202', 'Carcasa y espinazo', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 736.0, 11.0, 3.9000000953674, 0.5, 0.0, NULL, 18.0, 0.28000000119209, 0.112, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('230582710008202600002136', 'Chorizo bellota', NULL, 'Mercadona', 'Productos a base de carne', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 471.4, 41.0, 18.0, 0.6, 0.5, NULL, 25.0, 4.8, 1.92, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 35, NULL, 'e', 15, 'en:processed-meat', 'Mercadona', 'open_food_facts', 100, 'g', true), ('230582730009402600002441', 'Mercadona', NULL, 'Mercadona', 'Productos a base de carne', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 427.0, 36.0, 13.0, 0.9, 0.5, NULL, 25.0, 4.2, 1.68, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 35, NULL, 'u', NULL, 'en:processed-meat', 'Mercadona', 'open_food_facts', 100, 'g', true), ('230583660009212500011509', 'Jamon serrano iberico', NULL, 'Mercadona', 'Productos a base de carne', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 434.0, 40.6, 8.39, 0.1, 0.1, NULL, 17.2, 2.14, 0.856, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 23, NULL, 'f', -13, 'en:processed-meat', 'Mercadona', 'open_food_facts', 100, 'g', true)
ON CONFLICT (barcode) WHERE barcode IS NOT NULL DO UPDATE SET
    name = EXCLUDED.name,
    generic_name = COALESCE(EXCLUDED.generic_name, foods.generic_name),
    brand = COALESCE(EXCLUDED.brand, foods.brand),
    category = COALESCE(EXCLUDED.category, foods.category),
    ingredients_text = COALESCE(EXCLUDED.ingredients_text, foods.ingredients_text),
    allergens = COALESCE(EXCLUDED.allergens, foods.allergens),
    calories = COALESCE(EXCLUDED.calories, foods.calories),
    protein_g = COALESCE(EXCLUDED.protein_g, foods.protein_g),
    carbs_g = COALESCE(EXCLUDED.carbs_g, foods.carbs_g),
    fat_g = COALESCE(EXCLUDED.fat_g, foods.fat_g),
    fiber_g = COALESCE(EXCLUDED.fiber_g, foods.fiber_g),
    nutriscore_grade = COALESCE(EXCLUDED.nutriscore_grade, foods.nutriscore_grade),
    nova_group = COALESCE(EXCLUDED.nova_group, foods.nova_group),
    updated_at = now();