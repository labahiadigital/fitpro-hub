INSERT INTO foods (barcode, name, generic_name, brand, category, quantity, packaging, labels, origins, manufacturing_places, ingredients_text, allergens, traces, energy_kj, calories, fat_g, saturated_fat_g, carbs_g, sugars_g, fiber_g, protein_g, salt_g, sodium_mg, alcohol_g, monounsaturated_fat_g, polyunsaturated_fat_g, trans_fat_g, cholesterol_mg, omega3_g, added_sugars_g, starch_g, polyols_g, vitamin_a_ug, vitamin_d_ug, vitamin_e_mg, vitamin_k_ug, vitamin_c_mg, vitamin_b1_mg, vitamin_b2_mg, vitamin_b6_mg, vitamin_b9_ug, vitamin_b12_ug, vitamin_pp_mg, pantothenic_acid_mg, potassium_mg, calcium_mg, phosphorus_mg, iron_mg, magnesium_mg, zinc_mg, copper_mg, manganese_mg, selenium_ug, iodine_ug, caffeine_mg, choline_mg, nutriscore_grade, nutriscore_score, nova_group, ecoscore_grade, ecoscore_score, food_groups, source_supermarket, data_source, serving_size, serving_unit, is_global)
VALUES ('2602231001009', 'Big dots sugar', NULL, 'Consum', 'Botanas', NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 440.0, 26.1, 12.0, 45.0, 15.0, NULL, 6.2, 0.6, 0.24, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 21, NULL, 'b', 68, 'en:biscuits-and-cakes', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807534057', 'Salteado campestre', NULL, 'Consum', NULL, NULL, NULL, 'Sin gluten, Fuente de vitamina A', NULL, NULL, NULL, NULL, NULL, NULL, 58.0, 3.6, 0.4, 7.3, 4.1, NULL, 1.2, 0.2, 0.08, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807558725', 'Galletas choco cream  oreo', NULL, 'Consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 473.0, 19.0, 5.9, 69.0, 31.0, 2.9, 5.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807540010', 'Pan Casero', NULL, 'Consum', '3', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 2563.0, 15.0, 12.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807519641', 'Refresco Naranja Lata', NULL, 'Consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 24.0, 0.0, 0.0, 5.6, 5.6, NULL, 0.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807559661', 'Gnocchi De patata', NULL, 'Consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 148.0, 0.2, 0.1, 32.0, 0.6, 2.3, 3.5, 1.0825, 0.433, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('2602801001293', 'Pan redondo', NULL, 'Consum', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 54.8, 1.6, 0.8, 53.2, 3.4, NULL, 8.2, 1.4, 0.56, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('2603118001099', 'Palito sobrasada', NULL, 'Consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 424.0, 23.0, 4.2, 42.0, 2.0, 2.4, 2.0, 10.0, 4.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807500434', 'Miel de Milflores', NULL, 'Consum', 'Desayunos', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, 2, 'b', 72, 'en:sweets', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807547897', 'Yogur Sabor Fresa', NULL, 'Consum', 'Lácteos', NULL, NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, 75.0, 1.9, 1.3, 11.3, 11.3, NULL, 3.1, 0.1, 0.04, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 3, NULL, 'b', 73, 'en:milk-and-yogurt', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807547910', 'Yogur sabor coco', NULL, 'Consum', 'Lácteos', NULL, NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, 75.0, 1.9, 1.3, 11.3, 11.3, NULL, 3.1, 0.1, 0.04, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 3, NULL, 'b', 67, 'en:milk-and-yogurt', 'Consum', 'open_food_facts', 100, 'g', true), ('2604198001252', 'Hojaldre de calabacín', NULL, 'Consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 251.0, 14.0, 5.9, 5.9, 3.5, NULL, 4.7, 0.87, 0.348, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('26799155', 'Barra de pan', NULL, 'Consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807522047', 'Tomate frito', 'Tomate frito', 'Consum', 'Condimentos', '390g', NULL, 'Sin gluten, Punto Verde', NULL, NULL, 'Tomate, aceite de girasol, almidón modificado de maíz, azúcar, sal, cebolla, ajo, acidulante (ácido cítrico),', NULL, NULL, NULL, 78.0, 3.7, 0.4, 9.6, 6.4, 1.0, 1.0, 0.935, 0.374, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 4, 4, 'b', 72, 'en:dressings-and-sauces', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807501837', 'Copos de arroz y trigo integral', 'Copos tostados de arroz y trigo integral, enriquecidos con vitaminas y hierro', 'Consum', 'Alimentos y bebidas de origen vegetal', '500 g', NULL, 'Bajo o sin grasas, Bajo en grasas, FSC, FSC Mixto, Punto Verde, Fuente de hierro', NULL, NULL, 'Arroz 53%, _trigo_ integral 26% (_gluten_), azúcar, _gluten_ de _trigo_, _leche_ desnatada en polvo, germen de _trigo_ (_gluten_), sal, extracto de malta de _cebada_ (_gluten_), vitaminas (vitamina E, tiamina, riboflavina, niacina, vitamina B6, ácido fólico, vitamina B12, ácido pantoténico), difosfato férrico.', 'Gluten, Leche', 'Altramuces, Mostaza, Frutos de cáscara, Cacahuetes, Granos de sésamo, Soja', 1595.0, 376.0, 1.3, 0.7, 78.7, 16.1, 4.0, 10.4, 0.93, 0.372, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 12.0, NULL, NULL, 1.1, 1.4, 1.4, 200.0, 2.5, 16.0, 6.0, NULL, NULL, NULL, 7.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 11, 4, 'e', 25, 'en:breakfast-cereals', 'Consum', 'open_food_facts', 100, 'g', true), ('2604700000957', 'Barra Mix Cereales', NULL, 'Consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 263.0, 2.4, 0.3, 49.3, 1.2, 2.1, 10.1, 1.2775, 0.511, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('2602924000371', 'Baguette', NULL, 'Consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 265.0, 1.5, 0.3, 52.0, 2.2, NULL, 9.5, 1.3, 0.52, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807559203', 'Cereales Extrusionados de Maíz y Arroz rellenos de Crema de Leche', NULL, 'Consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 427.0, 13.0, 2.2, 70.0, 24.0, 2.1, 5.2, 0.8075, 0.323, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807540294', 'Leche Condensada', NULL, 'Consum', 'Lácteos', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 274.0, 0.4, 0.0, 59.0, 59.0, NULL, 8.5, 0.4, 0.16, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 14, NULL, 'd', 37, 'en:milk-and-yogurt', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807514967', 'Guindillas', 'Guindillas', 'Consum', 'Alimentos y bebidas de origen vegetal', '380g', NULL, 'Punto Verde', NULL, NULL, 'Guindillas, vinagre de vino (_sulfitos_), sal, antioxidante (_dióxido de azufre_).', 'Dióxido de azufre y sulfitos', 'Apio, Mostaza', 173.0, 41.0, 0.4, 0.2, 7.1, 0.2, 1.1, 2.9, 1.9, 0.76, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 6, 3, 'u', NULL, 'en:salty-and-fatty-products', 'Consum', 'open_food_facts', 100, 'g', true), ('2603305001291', 'Empanadilla De Pisto', NULL, 'Consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 329.0, 18.0, NULL, 31.0, 3.5, 3.5, 7.9, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('2603307000872', 'Empanadilla espinacas', NULL, 'Consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 245.0, 14.6, 1.7, 16.9, 1.7, NULL, 9.2, 1.0, 0.4, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('2601961002256', 'Mini ensaimada hojaldrada', NULL, 'Consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 403.0, 22.0, 10.0, 42.0, 6.9, 2.3, 7.9, 0.55, 0.22, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('2602801001958', 'Pa pagés', NULL, 'Consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 275.0, 1.1, 0.3, 55.2, 3.6, 2.9, 9.6, 1.05, 0.42, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('2604358000729', 'Bocadillos', NULL, 'Consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 251.0, 1.5, 0.3, 50.0, 3.9, 1.5, 8.3, 1.2, 0.48, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true)
ON CONFLICT (barcode) WHERE barcode IS NOT NULL DO UPDATE SET
    name = EXCLUDED.name,
    generic_name = COALESCE(EXCLUDED.generic_name, foods.generic_name),
    brand = COALESCE(EXCLUDED.brand, foods.brand),
    category = COALESCE(EXCLUDED.category, foods.category),
    ingredients_text = COALESCE(EXCLUDED.ingredients_text, foods.ingredients_text),
    allergens = COALESCE(EXCLUDED.allergens, foods.allergens),
    calories = COALESCE(EXCLUDED.calories, foods.calories),
    protein_g = COALESCE(EXCLUDED.protein_g, foods.protein_g),
    carbs_g = COALESCE(EXCLUDED.carbs_g, foods.carbs_g),
    fat_g = COALESCE(EXCLUDED.fat_g, foods.fat_g),
    fiber_g = COALESCE(EXCLUDED.fiber_g, foods.fiber_g),
    nutriscore_grade = COALESCE(EXCLUDED.nutriscore_grade, foods.nutriscore_grade),
    nova_group = COALESCE(EXCLUDED.nova_group, foods.nova_group),
    updated_at = now();