INSERT INTO foods (barcode, name, generic_name, brand, category, quantity, packaging, labels, origins, manufacturing_places, ingredients_text, allergens, traces, energy_kj, calories, fat_g, saturated_fat_g, carbs_g, sugars_g, fiber_g, protein_g, salt_g, sodium_mg, alcohol_g, monounsaturated_fat_g, polyunsaturated_fat_g, trans_fat_g, cholesterol_mg, omega3_g, added_sugars_g, starch_g, polyols_g, vitamin_a_ug, vitamin_d_ug, vitamin_e_mg, vitamin_k_ug, vitamin_c_mg, vitamin_b1_mg, vitamin_b2_mg, vitamin_b6_mg, vitamin_b9_ug, vitamin_b12_ug, vitamin_pp_mg, pantothenic_acid_mg, potassium_mg, calcium_mg, phosphorus_mg, iron_mg, magnesium_mg, zinc_mg, copper_mg, manganese_mg, selenium_ug, iodine_ug, caffeine_mg, choline_mg, nutriscore_grade, nutriscore_score, nova_group, ecoscore_grade, ecoscore_score, food_groups, source_supermarket, data_source, serving_size, serving_unit, is_global)
VALUES ('2303977004636', 'Tacos de cerdo familiar', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 129.0, 3.9, 1.13, 0.0, 0.0, NULL, 23.07, 0.11, 0.044, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('8412610000851', 'Higaditos de pollo', NULL, 'Mercadona', 'Productos a base de carne', NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 115.0, 4.0999999046326, 1.6000000238419, 0.60000002384186, 0.5, NULL, 19.0, 0.25999999046326, 0.104, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -4, NULL, 'e', 22, 'en:poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2304277003114', 'Filete de CONTRAMUSLO de pavo', NULL, 'mercadona', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 115.9, 3.1, 1.2, 0.0, 0.0, NULL, 22.0, 0.21, 0.084, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302833003967', 'Pechuga finas hierbas marinada', NULL, 'mercadona', 'Productos a base de carne', NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 87.0, 1.1, 0.4, 1.2, 0.1, NULL, 17.6, 2.0, 0.8, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 3, NULL, 'e', 22, 'en:poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2303677011620', 'Chuleta mixta', NULL, 'mercadona', 'Chuleta mixta', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2303456003440', 'Pincho de pollo', NULL, 'mercadona', NULL, NULL, NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, 91.0, 1.0, 0.37, 0.8, 0.7, NULL, 19.7, 1.94, 0.776, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('8480490284616', 'Danon de chocolate', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 80.8333333333333, 1.0833332935969, 0.583333323399226, 8.33333333333333, 6.66666666666667, 1.25, 8.33333333333333, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('231028440064000480003078', 'Pechuga pollo empanada', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 577.0, 136.0, 1.2, 0.4, 17.8, 1.4, NULL, 13.5, 1.4, 0.56, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302970003295', 'Contramuslo marinado de pollo', NULL, 'mercadona', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 206.0, 14.8, 4.6, 3.3, 1.1, NULL, 15.3, 1.5, 0.6, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302683004503', 'Churrasco marinado', NULL, 'mercadona', NULL, NULL, NULL, 'Sin gluten, Sin lactosa', NULL, NULL, NULL, NULL, NULL, 982.0, 236.0, 18.0, 8.1, 0.6, 0.5, NULL, 18.6, 1.1, 0.44, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('230157000012201850002265', 'Jamón La charcutería del Mercadona', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 247.8, 12.2, 4.6, 1.0, 0.5, NULL, 33.5, 0.5, 0.2, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2304918003947', 'Filete de lomo ibérico', NULL, 'mercadona', 'Productos a base de carne', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, 'en:meat-other-than-poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302792002674', 'Pavo a tacos', NULL, 'mercadona', NULL, '0.461 kg', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 493.3, 117.9, 3.9, 1.5, 0.0, 0.0, NULL, 20.7, 0.25, 0.1, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('236846950000101400006304', 'Coca de Sant Joan', NULL, 'Mercadona', NULL, '450 g', NULL, NULL, NULL, NULL, 'BASE DE BRIOCHE: harina de trigo, huevo líquido pasteurizado (huevo de gallina, correcto de acidez [E330], conservadores [E202, E211]), margarina (grasa vegetal refinada [palma), aceite vegetal refinado [girasol), aceite de mantequilla [10% ] [leche), agua, emulgente [E471), sal, acidulante [E330), conservador (E200], aroma y colorante [E 160ai]), azúcar, agua, levadura, masa madre de trigo (agua, harina de trigo fermentada), sal, mejorante en polvo (emulgente [E471, E472e, E481], harina de trigo, antiaglomerante [E170], estabilizante [E412], antioxidante (E300) y enzimas (trigo)], aroma de naranja [agua, jarabe de glucosa, preparación aromatizante [aceite natural de naranja], glicerol, espesante [E415), sustancias aromatizantes naturales, conservador [E202], colorante [E100], corrector de acidez [E330], colorante (E160e]), aroma de limón (agua, jarabe de glucosa, preparación aromatizante (aceite natural de cítrico, glicerol, espesante [E415), sustancias aromatizantes naturales, conservador (E202], corrector de acidez [E330]). DECORACIÓN: azúcar insoluble (azúcar en grano, grasa vegetal), piñones (5.5%), huevo líquido pasteurizado [huevo de gallina, corrector de acidez (E330), conservadores (E202, E211)] Puede contener trazas de soja, sésamo y frutos de cáscara.', 'Huevos, Gluten, Leche, Frutos de cáscara', 'Frutos de cáscara, Granos de sésamo, Soja', 1355.0, NULL, 12.6, 2.0, 42.0, 16.8, NULL, 8.9, 0.8, 0.32, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, 4, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2325353001619', 'Solomillo marinado congelado', NULL, 'mercadona', NULL, NULL, NULL, 'Sin gluten, Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 102.0, 1.1, 0.4, 2.7, 0.0, NULL, 20.5, 0.82, 0.328, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302831003648', 'Pechuga marinada', NULL, 'mercadona', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 101.0, 2.0, 0.6, 3.5, 0.5, NULL, 17.2, 2.0, 0.8, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302831003143', 'pechuga marinada', NULL, 'mercadona', NULL, NULL, NULL, 'Sin gluten, Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 101.0, 2.0, 0.6, 3.5, 0.5, NULL, 17.2, 2.0, 0.8, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302820002775', 'Solomillo de cerdo', NULL, 'mercadona', 'Productos a base de carne', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 131.0, 5.1, 2.05, 0.0, 0.0, NULL, 21.0, 0.13, 0.052, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'b', 1, NULL, 'u', NULL, 'en:meat-other-than-poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2203520003768', 'Filete de trucha', NULL, 'mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 123.0, 4.5, 0.8, 0.0, 0.0, NULL, 20.5, 0.15, 0.06, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('08397911', 'Hogaza 100% natural', NULL, 'Mercadona', NULL, NULL, NULL, 'Sin conservantes, Sin azúcares añadidos, Sin lactosa', NULL, NULL, 'Harina de trigo (gluten), agua, levadura, sal, aceite de girasol, vinagre, masa madre inactiva de trigo (gluten) (4%), masa madre inactiva de centeno (gluten) (0,2%), ácido ascórbico', 'Gluten', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2303682006086', 'Pechuga Pollo', NULL, 'mercadona', 'Productos a base de carne', '1.116kg', NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, 452.0, NULL, 1.8, 0.6, 0.5, 0.0, NULL, 22.0, 0.19, 0.076, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -6, NULL, 'u', NULL, 'en:meat-other-than-poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2304176002720', 'Medallones solomillo marinado', NULL, 'mercadona', NULL, NULL, NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, 100.0, 3.2, 1.1, 0.4, 0.4, NULL, 17.4, 1.0, 0.4, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2303456003358', 'Pincho de pollo', NULL, 'mercadona', NULL, NULL, NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, 91.0, 1.0, 0.37, 0.8, 0.7, NULL, 19.7, 1.94, 0.776, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('8424045045048', 'Burger Meat Pavo/Pollo', NULL, 'Mercadona', 'Productos a base de carne', '540 g', NULL, 'Sin gluten, Sin lactosa', NULL, NULL, NULL, NULL, NULL, NULL, 116.0, 3.9, 1.2, 4.8, 0.5, NULL, 15.3, 1.7, 0.68, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 4, NULL, 'u', NULL, 'en:poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2304353004844', 'Solomillo setas', NULL, 'Mercadona', NULL, NULL, NULL, 'Sin gluten, Sin lactosa', NULL, NULL, NULL, NULL, NULL, NULL, 124.3, 5.5, 1.9, 1.1, 1.1, NULL, 17.6, 1.7, 0.68, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true)
ON CONFLICT (barcode) WHERE barcode IS NOT NULL DO UPDATE SET
    name = EXCLUDED.name,
    generic_name = COALESCE(EXCLUDED.generic_name, foods.generic_name),
    brand = COALESCE(EXCLUDED.brand, foods.brand),
    category = COALESCE(EXCLUDED.category, foods.category),
    ingredients_text = COALESCE(EXCLUDED.ingredients_text, foods.ingredients_text),
    allergens = COALESCE(EXCLUDED.allergens, foods.allergens),
    calories = COALESCE(EXCLUDED.calories, foods.calories),
    protein_g = COALESCE(EXCLUDED.protein_g, foods.protein_g),
    carbs_g = COALESCE(EXCLUDED.carbs_g, foods.carbs_g),
    fat_g = COALESCE(EXCLUDED.fat_g, foods.fat_g),
    fiber_g = COALESCE(EXCLUDED.fiber_g, foods.fiber_g),
    nutriscore_grade = COALESCE(EXCLUDED.nutriscore_grade, foods.nutriscore_grade),
    nova_group = COALESCE(EXCLUDED.nova_group, foods.nova_group),
    updated_at = now();