INSERT INTO foods (barcode, name, generic_name, brand, category, quantity, packaging, labels, origins, manufacturing_places, ingredients_text, allergens, traces, energy_kj, calories, fat_g, saturated_fat_g, carbs_g, sugars_g, fiber_g, protein_g, salt_g, sodium_mg, alcohol_g, monounsaturated_fat_g, polyunsaturated_fat_g, trans_fat_g, cholesterol_mg, omega3_g, added_sugars_g, starch_g, polyols_g, vitamin_a_ug, vitamin_d_ug, vitamin_e_mg, vitamin_k_ug, vitamin_c_mg, vitamin_b1_mg, vitamin_b2_mg, vitamin_b6_mg, vitamin_b9_ug, vitamin_b12_ug, vitamin_pp_mg, pantothenic_acid_mg, potassium_mg, calcium_mg, phosphorus_mg, iron_mg, magnesium_mg, zinc_mg, copper_mg, manganese_mg, selenium_ug, iodine_ug, caffeine_mg, choline_mg, nutriscore_grade, nutriscore_score, nova_group, ecoscore_grade, ecoscore_score, food_groups, source_supermarket, data_source, serving_size, serving_unit, is_global)
VALUES ('2380874005782', 'Pollo asado troceado', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 171.0, 5.9, 1.3, 3.0, 0.5, NULL, 26.0, 1.0, 0.4, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302791005690', 'Filete de pechuga', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 540.0, 4.25, 4.25, 1.0, 1.0, NULL, 22.23, 0.01, 0.004, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302809007661', 'Filetes de ternera', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 466.0, 111.0, 3.0, 1.4, 0.5, 0.5, NULL, 20.0, 0.17, 0.068, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('232836530000100150001507', 'Panecillos de queso 10 uds', NULL, 'Mercadona', 'Botanas', NULL, 'Plástico', NULL, NULL, NULL, 'FÉCULA DEYUCA, PATATA,AGUA,QUESO CURADO 16%(LECHE DE VACA PASTEURIZADA SAL CUAJO, CLORURO DE CALCIO.LISOZIMA DE HUEVO Y FERMENTOS LACTEOS) QUESO EDAM 40% (LECHE DEVACA PASTEURIZADA SAL, FERMENTOS LACTEOS, CUAJO MICROBIANO, COLORANTE BETA-CAROTENO) ACEITE VEGETAL (SOJA Y GIRASOL) LECHE,HUEVO PASTEURIZADO, SAL CONTIENE SULFITOS Y DIOXIDO DE AZUFRE.', 'Huevos, Leche, Soja, Dióxido de azufre y sulfitos', 'Crustáceos, Pescado, Apio-y-mostaza, Puede-contenertrazas-de-gluten', NULL, 296.0, 12.0, 5.1, 41.0, 0.0, NULL, 5.9, 1.2, 0.48, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 13, 3, 'u', NULL, 'en:appetizers', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2304277002889', 'Filete de contramuslo de Pavo', NULL, 'mercadona', 'Productos a base de carne', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 112.0, 3.8, 1.4, 0.0, 0.0, NULL, 19.5, 0.7, 0.28, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -2, NULL, 'e', 22, 'en:poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302862002771', 'Longaniza pollo fresca', NULL, 'mercadona', 'Productos a base de carne', NULL, NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, 130.0, 6.0, 1.8, 0.8, 0.5, NULL, 16.0, 1.8, 0.72, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 4, NULL, 'u', NULL, 'en:meat-other-than-poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302794005161', 'Pechuga de pavo', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 103.0, 0.9, 0.3, 0.0, 0.0, NULL, 24.0, 0.26, 0.104, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2303491004921', 'Costilla churrasco', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 279.0, 23.6, 9.3, 0.0, 0.0, NULL, 17.1, 0.18, 0.072, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302833003332', 'Pechuga finas hierbas marinada', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 86.5, 1.1, 0.4, 1.2, 0.1, NULL, 17.6, 2.0, 0.8, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2325242003373', 'Solomillo pollo', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 106.0, 1.8, 1.8, 0.5, 0.5, NULL, 22.0, 0.16, 0.064, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302829003667', 'Filete de pechuca', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 110.0, 2.1, 0.7, 0.0, 0.0, NULL, 22.0, 0.14, 0.056, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302792003121', 'Pavo a tacos', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 118.0, 3.9, 1.5, 0.0, 0.0, NULL, 20.7, 0.2, 0.08, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('230054250078500139001098', 'Piña', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('8435361213806', 'Jamoncitos pollo', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 107.0, 2.8, 0.9, 0.6, 0.5, NULL, 19.8, 0.2, 0.08, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('8480000849816', 'Yakisoba', NULL, 'Mercadona', 'Alimentos y bebidas de origen vegetal', NULL, NULL, 'Punto Verde', NULL, NULL, 'Fideos de trigo [harina de trigo, agua, sal, acidulante (E - 500, E-501), colorante E-101], salsa yakisoba [agua, jarabe de maíz alto en fructosa, melaza, salsa de soja (agua, soja, trigo, sal, alcohol), sal, vinagre destilado, proteína de soja hidrolizada, pasta de tomate, almidón modificado, colorante E-150a, especias (contiene apio), pasta de cebolla, extracto de levadura, pasta de manzana, espesante E-412, extracto de champiñón, polvo de seta shiitake, polvo de ajo, extracto de cebolla, zumo de dátil concentrado], col lisa, cebolleta, secreto de cerdo salteado [secreto de cerdo, salsa yakisoba (agua, jarabe de maíz alto en fructosa, melaza, salsa de soja (agua, soja, trigo, sal, alcohol), sal, vinagre destilado, proteína de soja hidrolizada, pasta de tomate, almidón modificado, colorante E-150a, especias (contiene apio), pasta de cebolla, extracto de levadura, pasta de manzana, espesante E-412, extracto de champiñón, polvo de seta shiitake, polvo de ajo, extracto de cebolla, zumo de dátil concentrado), aceite de girasol], aceite de girasol, tortilla francesa [huevo líquido pasteurizado, aceite de girasol, ajo, clara de huevo, gasificantes (E-450i, E-500i, E-500ii), antiaglomerante E-516, sal, gelificantes (E-407, E-410, E-415), aceite de oliva y corrector de acidez E-330], mayonesa japonesa [mayonesa (aceite de soja, agua, yema de huevo, vinagre de vino blanco, azúcar, sal, almidón modificado de maíz, zumo de limón concentrado, antioxidante E-385, extracto de pimentón, colorante (carotenos)), agua, almidón modificado de patata, mostaza Dijon (agua, semillas de mostaza, vinagre de alcohol, sal, acidulante E-330, conservador E-224 (sulfitos)), estabilizantes (E-412, E-415 y E-440), rábano picante en polvo (sulfitos), conservador E-202, acidulante E-330 y colorante E160a], cebollino, potenciador del sabor E - 621, sal [sal y antiaglomerante E-535] y pimienta blanca. Puede contener trazas de crustáceos, pescado, cacahuete, leche, frutos de cáscara, sésamo y moluscos.', 'Apio, Huevos, Gluten, Mostaza, Soja, Dióxido de azufre y sulfitos', 'Crustáceos, Pescado, Leche, Moluscos, Frutos de cáscara, Cacahuetes, Granos de sésamo', NULL, 190.0, 7.2, 1.1, 26.0, 4.1, NULL, 5.7, 2.1625, 0.865, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, 4, 'b', 62, 'en:cereals', 'Mercadona', 'open_food_facts', 100, 'g', true), ('8425514085619', 'Pan de centeno 51%', NULL, 'Mercadona', 'Alimentos y bebidas de origen vegetal', '465g  6 und', NULL, 'Punto Verde', NULL, NULL, 'centeno, harina, trigo, levadura, agua, sal,', 'Gluten', NULL, NULL, 262.0, 1.7, 1.1, 50.0, 3.2, 4.4, 9.4, 1.5, 0.6, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 9, 3, 'a', 77, 'en:bread', 'Mercadona', 'open_food_facts', 100, 'g', true), ('233041100000100344003449', 'Burger meat Angus gruesa', NULL, 'mercadona', 'Sándwiches', '360 g', NULL, 'Sin gluten, Sin lactosa', NULL, NULL, NULL, NULL, NULL, NULL, 206.0, 14.0, 6.7, 1.5, 0.5, NULL, 19.0, 1.5, 0.6, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 15, NULL, 'u', NULL, 'en:sandwiches', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2303394003472', 'Fiambre lomo', NULL, 'Mercadona', NULL, NULL, NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, 91.0, 2.2, 0.71, 1.6, 0.7, NULL, 16.3, 2.4, 0.96, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302792002421', 'Pavo a tacos', NULL, 'Mercadona', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 493.3, 3.9, 1.5, 0.0, 0.0, NULL, 20.7, 0.25, 0.1, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302787004300', 'Filete de Pechuga', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 107.0, 1.6, 0.5, 0.0, 0.0, NULL, 23.0, 0.16, 0.064, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2304900003122', 'Chuletas de Aguja', NULL, 'Mercadona', NULL, NULL, NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, 186.0, 12.4, 4.9, 0.9, 0.5, NULL, 17.8, 0.2, 0.08, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2380874006222', 'Pollo asado troceado', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 171.0, 5.9, 1.3, 3.0, 0.5, NULL, 26.0, 1.0, 0.4, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2303400004523', 'Filete de pechuga de pollo', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 106.0, 1.54, 0.64, 0.8, 0.0, NULL, 22.18, 0.21, 0.084, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302787004324', 'Filete de pechuga', NULL, 'Mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 108.0, 1.7, 0.5, 0.9, 0.7, NULL, 22.3, 0.3, 0.12, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('233081520000100156001569', 'Burger zanahoria', NULL, 'Mercadona', NULL, '240 g', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 131.0, 5.9, 1.8, 5.3, 1.5, NULL, 14.2, 2.1, 0.84, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true)
ON CONFLICT (barcode) WHERE barcode IS NOT NULL DO UPDATE SET
    name = EXCLUDED.name,
    generic_name = COALESCE(EXCLUDED.generic_name, foods.generic_name),
    brand = COALESCE(EXCLUDED.brand, foods.brand),
    category = COALESCE(EXCLUDED.category, foods.category),
    ingredients_text = COALESCE(EXCLUDED.ingredients_text, foods.ingredients_text),
    allergens = COALESCE(EXCLUDED.allergens, foods.allergens),
    calories = COALESCE(EXCLUDED.calories, foods.calories),
    protein_g = COALESCE(EXCLUDED.protein_g, foods.protein_g),
    carbs_g = COALESCE(EXCLUDED.carbs_g, foods.carbs_g),
    fat_g = COALESCE(EXCLUDED.fat_g, foods.fat_g),
    fiber_g = COALESCE(EXCLUDED.fiber_g, foods.fiber_g),
    nutriscore_grade = COALESCE(EXCLUDED.nutriscore_grade, foods.nutriscore_grade),
    nova_group = COALESCE(EXCLUDED.nova_group, foods.nova_group),
    updated_at = now();