INSERT INTO foods (barcode, name, generic_name, brand, category, quantity, packaging, labels, origins, manufacturing_places, ingredients_text, allergens, traces, energy_kj, calories, fat_g, saturated_fat_g, carbs_g, sugars_g, fiber_g, protein_g, salt_g, sodium_mg, alcohol_g, monounsaturated_fat_g, polyunsaturated_fat_g, trans_fat_g, cholesterol_mg, omega3_g, added_sugars_g, starch_g, polyols_g, vitamin_a_ug, vitamin_d_ug, vitamin_e_mg, vitamin_k_ug, vitamin_c_mg, vitamin_b1_mg, vitamin_b2_mg, vitamin_b6_mg, vitamin_b9_ug, vitamin_b12_ug, vitamin_pp_mg, pantothenic_acid_mg, potassium_mg, calcium_mg, phosphorus_mg, iron_mg, magnesium_mg, zinc_mg, copper_mg, manganese_mg, selenium_ug, iodine_ug, caffeine_mg, choline_mg, nutriscore_grade, nutriscore_score, nova_group, ecoscore_grade, ecoscore_score, food_groups, source_supermarket, data_source, serving_size, serving_unit, is_global)
VALUES ('8414807502049', 'Cacahuetes tostados', 'Cacahuetes cáscara tostados salados', 'Consum', 'Alimentos y bebidas de origen vegetal', '250g', NULL, 'Sin gluten, No recomendado para ciertas personas, Punto Verde, No recomendado a niños menores de 3 años, Fuente de fósforo', 'China', NULL, '_Cacahuetes_, harina de arroz, sal, goma guar.', 'Cacahuetes', 'Frutos de cáscara', 2441.0, 587.0, 49.7, 7.7, 21.3, 4.9, 8.4, 24.4, 3.5, 1.4, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 4.93, NULL, NULL, NULL, NULL, 0.47, 97.0, NULL, 14.35, NULL, 634.0, NULL, 363.0, NULL, 178.0, 2.8, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 16, 4, 'e', 28, 'en:nuts', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807556172', 'Almendras tostadas sin sal', 'Almendra tostada sin sal', 'Consum', 'Alimentos y bebidas de origen vegetal', '200 g', NULL, 'Bajo en sal o sin sal, Sin gluten, No recomendado para ciertas personas, Fuente de calcio, Punto Verde, Sin sal, No recomendado a niños menores de 3 años', 'España', NULL, '_Almendra_.', 'Frutos de cáscara', 'Frutos de cáscara, Cacahuetes', 2499.0, 598.0, 52.5, 4.1, 21.0, 4.8, 10.9, 21.0, 0.01, 0.004, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 23.9, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 268.0, 471.0, 3.73, 279.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -10, 1, 'e', 27, 'en:nuts', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807537843', 'Almendra pelada cruda', 'Almendra sin piel cruda', 'Consum', 'Alimentos y bebidas de origen vegetal', '150 g', NULL, 'Sin gluten, No recomendado para ciertas personas, Fuente de calcio, Punto Verde, No recomendado a niños menores de 3 años', 'España', NULL, '_Almendras_ sin piel.', 'Frutos de cáscara', 'Frutos de cáscara, Cacahuetes', 2604.0, 630.0, 55.0, 5.2, 4.2, 4.2, 7.0, 26.0, 0.01, 0.004, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 0.8, NULL, NULL, NULL, 5.3, NULL, NULL, 248.0, NULL, 3.6, NULL, 3.6, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -9, 1, 'e', 27, 'en:nuts', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807527509', 'Almendras fritas', 'Almendra repelada, frita y salada', 'Consum', 'Alimentos y bebidas de origen vegetal', '200g', NULL, 'Sin gluten, No recomendado para ciertas personas, Fuente de calcio, Punto Verde, No recomendado a niños menores de 3 años', NULL, NULL, '_Almendras_ sin piel, aceite de girasol, sal.', 'Frutos de cáscara, en:Almendras', 'Frutos de cáscara, Cacahuetes', 2588.0, 626.0, 55.0, 5.0, 4.1, 3.4, 9.4, 24.0, 2.1, 0.84, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 17.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 244.0, 537.0, 2.5, 214.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 6, 3, 'e', 19, 'en:nuts', 'Consum', 'open_food_facts', 100, 'g', true), ('2604186000809', 'Hojaldre tomate y orégano 1 unidad', NULL, 'Consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 268.0, 15.0, 8.2, 26.7, 3.5, NULL, 5.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('2603985000942', 'Hojaldre doble Frankfurt', NULL, 'Consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 340.0, 24.2, 11.0, 20.4, 3.4, NULL, 9.6, 1.31, 0.524, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('2603985001109', 'hojaldre doble frankfurt', NULL, 'Consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 340.0, 24.2, 11.0, 20.4, 3.4, NULL, 9.6, 1.31, 0.524, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807514868', 'Frankfurt', NULL, 'Consum', NULL, NULL, NULL, 'Sin gluten, Sin lactosa', NULL, NULL, NULL, NULL, NULL, 899.0, NULL, 14.5, 5.8, 9.3, 1.3, 0.8, 12.0, 2.4, 0.96, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 210.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807529497', 'Filetón de bacalao', NULL, 'Consum', 'Productos del mar', NULL, NULL, NULL, NULL, NULL, 'Bacalao (Godus Morhua) y sal.', 'Pescado', NULL, 295.0, NULL, 0.2, 0.06, 0.7, 0.0, 0.0, 16.2, 3.5, 1.4, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 17, 3, 'u', NULL, 'en:fish-and-seafood', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807502551', 'Menta poleo', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', NULL, NULL, '100% natural', NULL, NULL, NULL, NULL, NULL, NULL, 1.0, 0.0, 0.0, 0.2, 0.0, NULL, 0.1, 0.0, 0.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'b', 0, NULL, 'd', 39, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807502841', 'PAN TOSTADO INTEGRAL', NULL, 'Consum', 'Aliments et boissons à base de végétaux', 'Peut', NULL, 'Source de fibres alimentaires', NULL, NULL, 'Harina integral de _trigo_ 53%, harina de _trigo_ 8%, levadura, aceite vegetal (girasol alto oleico) 2,5%, azúcar, extracto de _cebada_ malteada, sal, agente de tratamiento de harina (E300)', 'Gluten', 'Gluten, Graines de sésame', 1591.0, 380.0, 6.5, 0.7, 62.0, 3.5, 11.0, 13.0, 1.4, 0.56, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 6, 3, 'b', 72, 'en:bread', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807532671', 'Queso  de Oveja', NULL, 'Consum', 'Lácteos', '250 g', NULL, 'Fuente de calcio, Fuente de fósforo', NULL, NULL, NULL, NULL, NULL, NULL, 446.0, 37.0, 25.4, 1.3, 1.3, NULL, 27.0, 2.1, 0.84, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 18, NULL, 'e', 22, 'en:cheese', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807526403', 'Queso curado', NULL, 'Consum', 'Lácteos', '250 g', NULL, 'Fuente de calcio, Punto Verde, Fuente de fósforo', NULL, NULL, NULL, NULL, NULL, NULL, 404.0, 34.0, 23.3, 1.2, 1.2, NULL, 24.0, 2.0, 0.8, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 17, NULL, 'd', 35, 'en:cheese', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807533661', 'Judía verde plana ultracongelada', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', '1 kg', NULL, 'Fuente de fibra alimentaria', NULL, NULL, NULL, NULL, NULL, NULL, 39.0, 0.0, 0.0, 6.1, 1.2, 3.0, 1.9, 0.003, 0.0012, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -5, NULL, 'a', 76, 'en:vegetables', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807547255', 'Jamón Curado “Reserva”  12 meses de curación 25% menos de sal', NULL, 'consum', 'Productos a base de carne', NULL, NULL, 'Sin lactosa, Fuente de fósforo', NULL, NULL, NULL, NULL, NULL, NULL, 209.0, 9.0, 3.5, 0.1, 0.1, NULL, 32.0, 3.5, 1.4, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 22, NULL, 'u', NULL, 'en:processed-meat', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807547200', 'Queso fresco Ecologico', NULL, 'Consum', 'Lácteos', NULL, NULL, 'Ecológico, Ecológico UE, Fuente de calcio, ES-ECO-016-CL, Fuente de fósforo', NULL, NULL, NULL, NULL, NULL, NULL, 179.0, 13.0, 9.0, 3.6, 3.6, NULL, 12.0, 0.8, 0.32, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 10, NULL, 'c', 55, 'en:cheese', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807534255', 'Formatge tipus burgos', NULL, 'Consum', 'Lácteos', NULL, NULL, 'Sin gluten, Sin conservantes, Fuente de calcio, Sin colorantes, Fuente de fósforo', NULL, NULL, 'LECHE desnatada pasteurizada de vaca, sal, cuajo y cloruro cálcico. Origen de la LECHE: ESPAÑA', 'Leche', NULL, NULL, 65.0, 0.3, 0.1, 3.5, 3.5, 0.1, 12.0, 0.8, 0.32, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', 0, 3, 'd', 35, 'en:cheese', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807533166', 'Queso tierno bajo en sal', NULL, 'Consum', 'Lácteos', '250 g', NULL, 'Fuente de fósforo', NULL, NULL, NULL, NULL, NULL, NULL, 384.0, 32.0, 21.6, 1.6, 1.6, NULL, 22.5, 0.3, 0.12, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 8, NULL, 'd', 35, 'en:cheese', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807526427', 'Queso de cabra tierno', NULL, 'Consum', 'Lácteos', '200 g', NULL, 'Fuente de calcio, Fuente de fósforo', NULL, NULL, NULL, NULL, NULL, NULL, 422.0, 35.0, 24.1, 1.8, 1.8, NULL, 25.0, 1.8, 0.72, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 16, NULL, 'f', 8, 'en:cheese', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807519757', 'Queso mezcla tierno', NULL, 'Consum', 'Lácteos', '200 g', NULL, 'Fuente de calcio, Punto Verde, Fuente de fósforo', NULL, NULL, 'Leche pasteurizada de vaca (60% min), oveja (12,5% min) y cabra (12,5% min), fermentos lácticos (leche), sal, cuajo y cloruro de calcio. Origen de la leche: España.', 'Leche', NULL, NULL, 384.0, 32.0, 21.6, 1.6, 1.6, NULL, 22.5, 1.5, 0.6, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 19, 3, 'd', 35, 'en:cheese', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807516312', 'Queso Curado Cosum', NULL, 'Consum', 'Lácteos', '310 g', NULL, 'Fuente de calcio, Punto Verde, Fuente de fósforo', NULL, NULL, NULL, NULL, NULL, NULL, 407.0, 34.0, 23.1, 1.2, 1.2, NULL, 24.0, 2.0, 0.8, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 17, NULL, 'd', 35, 'en:cheese', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807549655', 'Pistachos tostados', NULL, 'consum', 'Alimentos y bebidas de origen vegetal', NULL, NULL, 'Sin gluten, Fuente de hierro', NULL, NULL, NULL, NULL, NULL, NULL, 620.0, 52.0, 6.5, 6.5, 6.4, NULL, 26.0, 0.9, 0.36, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 8, NULL, 'e', 22, 'en:nuts', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807536563', 'Pistachos tostados sal consum', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', '150 g', 'Bolsa', 'Sin gluten, Fuente de hierro', NULL, NULL, NULL, NULL, NULL, NULL, 620.0, 52.0, 6.5, 6.5, 6.4, NULL, 26.0, 1.0, 0.4, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 8, NULL, 'e', 27, 'en:nuts', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807502209', 'Pate de hígado de cerdo', NULL, 'Consum', 'Productos a base de carne', NULL, NULL, 'Fuente de hierro', NULL, NULL, NULL, NULL, NULL, NULL, 300.0, 27.2, 10.7, 5.4, 0.5, 0.5, 8.39, 1.3, 0.52, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 19, NULL, 'u', NULL, 'en:processed-meat', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807510266', 'Garbanzos', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', NULL, NULL, 'Fuente de fibra alimentaria', NULL, NULL, NULL, NULL, NULL, NULL, 332.0, 7.0, 1.0, 36.0, 2.8, NULL, 17.9, 0.01, 0.004, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -6, NULL, 'a', 75, 'en:legumes', 'Consum', 'open_food_facts', 100, 'g', true)
ON CONFLICT (barcode) WHERE barcode IS NOT NULL DO UPDATE SET
    name = EXCLUDED.name,
    generic_name = COALESCE(EXCLUDED.generic_name, foods.generic_name),
    brand = COALESCE(EXCLUDED.brand, foods.brand),
    category = COALESCE(EXCLUDED.category, foods.category),
    ingredients_text = COALESCE(EXCLUDED.ingredients_text, foods.ingredients_text),
    allergens = COALESCE(EXCLUDED.allergens, foods.allergens),
    calories = COALESCE(EXCLUDED.calories, foods.calories),
    protein_g = COALESCE(EXCLUDED.protein_g, foods.protein_g),
    carbs_g = COALESCE(EXCLUDED.carbs_g, foods.carbs_g),
    fat_g = COALESCE(EXCLUDED.fat_g, foods.fat_g),
    fiber_g = COALESCE(EXCLUDED.fiber_g, foods.fiber_g),
    nutriscore_grade = COALESCE(EXCLUDED.nutriscore_grade, foods.nutriscore_grade),
    nova_group = COALESCE(EXCLUDED.nova_group, foods.nova_group),
    updated_at = now();