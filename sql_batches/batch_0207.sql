INSERT INTO foods (barcode, name, generic_name, brand, category, quantity, packaging, labels, origins, manufacturing_places, ingredients_text, allergens, traces, energy_kj, calories, fat_g, saturated_fat_g, carbs_g, sugars_g, fiber_g, protein_g, salt_g, sodium_mg, alcohol_g, monounsaturated_fat_g, polyunsaturated_fat_g, trans_fat_g, cholesterol_mg, omega3_g, added_sugars_g, starch_g, polyols_g, vitamin_a_ug, vitamin_d_ug, vitamin_e_mg, vitamin_k_ug, vitamin_c_mg, vitamin_b1_mg, vitamin_b2_mg, vitamin_b6_mg, vitamin_b9_ug, vitamin_b12_ug, vitamin_pp_mg, pantothenic_acid_mg, potassium_mg, calcium_mg, phosphorus_mg, iron_mg, magnesium_mg, zinc_mg, copper_mg, manganese_mg, selenium_ug, iodine_ug, caffeine_mg, choline_mg, nutriscore_grade, nutriscore_score, nova_group, ecoscore_grade, ecoscore_score, food_groups, source_supermarket, data_source, serving_size, serving_unit, is_global)
VALUES ('8414807503947', 'Spaghetti con vegetales', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 354.0, 2.0, 0.04, 70.0, 3.6, NULL, 12.0, 0.0, 0.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'b', 1, NULL, 'u', NULL, 'en:cereals', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807515797', 'Paté de finas hierbas', NULL, 'Consum', 'Productos a base de carne', NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 295.0, 25.7, 9.4, 2.5, 0.9, NULL, 13.3, 1.4, 0.56, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 18, NULL, 'e', 19, 'en:processed-meat', 'Consum', 'open_food_facts', 100, 'g', true), ('2603475003460', 'Filete extrafino pechuga de pollo', NULL, 'consum', 'Filete de pechuga de pollo', NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807533340', 'Garbanzos', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 332.0, 4.0, 0.6, 59.0, 10.0, NULL, 22.0, 0.6, 0.24, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'b', -2, NULL, 'a', 75, 'en:legumes', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807542618', 'Pan tostado clásico', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 389.0, 5.2, 0.4, 71.0, 6.6, NULL, 12.0, 1.4, 0.56, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 11, NULL, 'b', 72, 'en:bread', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807700100', 'Zumo piña manzana y uva', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', NULL, NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, 47.0, 0.0, 0.0, 11.2, 11.2, NULL, 0.6, 0.01, 0.004, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 7, NULL, 'e', 21, 'en:fruit-juices', 'Consum', 'open_food_facts', 100, 'g', true), ('2603303000395', 'Napolitana de chocolate', NULL, 'Consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 476.0, 28.0, 13.0, 49.0, 14.2, NULL, 6.1, 0.99, 0.396, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('2603427000790', 'Pepito de Choco', NULL, 'Consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 414.0, 24.0, 10.0, 42.0, 20.0, NULL, 6.4, 0.84, 0.336, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807514905', 'Salsa Barbacoa', NULL, 'Consum', 'Condimentos', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 110.0, 0.2, 0.0, 25.8, 22.0, NULL, 1.4, 0.5, 0.2, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 9, NULL, 'b', 67, 'en:dressings-and-sauces', 'Consum', 'open_food_facts', 100, 'g', true), ('2603583000535', 'Pan con fibra', NULL, 'consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 267.0, 1.6, 0.3, 49.7, 3.7, NULL, 11.0, 1.33, 0.532, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('2616686002825', 'Filete Magro Jamón Cerdo', NULL, 'consum', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('2603965000535', 'Barra de pan', NULL, 'Consum', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 321.0, 1.0, 0.3, 68.0, 0.7, NULL, 8.6, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807550583', 'Griego frutas', NULL, 'Consum', 'Lácteos', '2 x 125 g', NULL, 'Sin gluten', NULL, NULL, 'Leche entera pasteurizada, nata, agua, frutas 8,8% (mango y papaya), azúcar (5,7%), almidón modificado, espesantes: E412, E407; concentrado de zanahoria, aroma, fermentos lácticos, proteínas de la leche.', 'Leche', NULL, NULL, 107.0, 6.7, 4.4, 9.4, 8.9, NULL, 2.1, 0.08, 0.032, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 7, 4, 'b', 64, 'en:milk-and-yogurt', 'Consum', 'open_food_facts', 100, 'g', true), ('2604069001190', 'Pan Pavé', NULL, 'consum', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 255.0, 1.4, 0.3, 3.9, 3.6, NULL, 1.3, 0.0, 0.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('2604256001002', 'Mini trigo sarraceno', NULL, 'Consum', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 243.0, 1.0, 0.2, 49.7, 2.8, NULL, 7.2, 0.9, 0.36, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('2603993000996', 'Baguette mantega', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', '210 g', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 1077.0, 255.0, 26.0, 1.1, 47.9, 4.3, 3.0, 8.4, 1.13, 0.452, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 7, NULL, 'a', 77, 'en:bread', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807553126', 'Alubias jardinera', NULL, 'consum', 'Comidas preparadas', '430 g', NULL, NULL, NULL, NULL, 'Alubias blancas (40%), agua, hortalizas en proporción variable (16%) (judías verdes, guisantes. pimiento verde, zanahoria y patata), tomate concentrado, sal, vino blanco aceite de oliva, perejil y laurel.', NULL, NULL, NULL, 76.0, 0.84, 0.2, 11.27, 1.58, 3.24, 4.33, 0.77, 0.308, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -1, 3, 'u', NULL, 'en:one-dish-meals', 'Consum', 'open_food_facts', 100, 'g', true), ('2601717001151', 'Panal de cabello 140gr', NULL, 'Consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 399.0, 20.2, 10.5, 48.1, 23.6, 2.9, 4.7, 0.73, 0.292, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807541123', 'Aceite refinado de girasol', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 900.0, 100.0, 12.0, 0.0, 0.0, NULL, 0.0, 0.0, 0.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 4, 2, 'd', 44, 'en:fats', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807534408', 'Crema de verduras', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', NULL, NULL, 'Sin gluten, Sin conservantes, Sin colorantes', NULL, NULL, NULL, NULL, NULL, NULL, 39.0, 1.3, 0.1, 5.3, 1.7, NULL, 0.8, 0.75, 0.3, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 3, NULL, 'a', 78, 'en:soups', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807540300', 'Leche condensada', NULL, 'Consum', 'Lácteos', '370 g', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 322.0, 8.0, 5.7, 55.0, 55.0, NULL, 7.4, 0.33, 0.132, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 25, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807520449', 'Copos de trigo integral y salvado', NULL, 'Consum', 'Desayunos', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 358.0, 2.6, 0.8, 63.3, 18.3, NULL, 11.2, 0.87, 0.348, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 13, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807518262', 'Capriccio de brotes', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 18.0, 0.4, 0.1, 0.7, 0.2, NULL, 2.0, 0.37, 0.148, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -4, NULL, 'a', 76, 'en:vegetables', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807544414', 'Zumo de naranja con pulpa', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', '0,5 l', NULL, NULL, NULL, NULL, 'Zumo de naranja 97%, pulpa de naranja 3%', NULL, NULL, NULL, 35.0, 0.0, 0.0, 8.1, 8.1, 0.2, 0.6, 0.01, 0.004, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 20.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 3, 1, 'd', 43, 'en:unsweetened-beverages', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807542175', 'Yogurt 0%0% trocitos frutas del bosque', NULL, 'Consum', 'Lácteos', NULL, NULL, 'Sin azúcares añadidos', NULL, NULL, NULL, NULL, NULL, NULL, 40.0, 0.2, 0.1, 5.2, 4.9, NULL, 4.2, 0.14, 0.056, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', 0, NULL, 'b', 64, 'en:milk-and-yogurt', 'Consum', 'open_food_facts', 100, 'g', true)
ON CONFLICT (barcode) WHERE barcode IS NOT NULL DO UPDATE SET
    name = EXCLUDED.name,
    generic_name = COALESCE(EXCLUDED.generic_name, foods.generic_name),
    brand = COALESCE(EXCLUDED.brand, foods.brand),
    category = COALESCE(EXCLUDED.category, foods.category),
    ingredients_text = COALESCE(EXCLUDED.ingredients_text, foods.ingredients_text),
    allergens = COALESCE(EXCLUDED.allergens, foods.allergens),
    calories = COALESCE(EXCLUDED.calories, foods.calories),
    protein_g = COALESCE(EXCLUDED.protein_g, foods.protein_g),
    carbs_g = COALESCE(EXCLUDED.carbs_g, foods.carbs_g),
    fat_g = COALESCE(EXCLUDED.fat_g, foods.fat_g),
    fiber_g = COALESCE(EXCLUDED.fiber_g, foods.fiber_g),
    nutriscore_grade = COALESCE(EXCLUDED.nutriscore_grade, foods.nutriscore_grade),
    nova_group = COALESCE(EXCLUDED.nova_group, foods.nova_group),
    updated_at = now();