INSERT INTO foods (barcode, name, generic_name, brand, category, quantity, packaging, labels, origins, manufacturing_places, ingredients_text, allergens, traces, energy_kj, calories, fat_g, saturated_fat_g, carbs_g, sugars_g, fiber_g, protein_g, salt_g, sodium_mg, alcohol_g, monounsaturated_fat_g, polyunsaturated_fat_g, trans_fat_g, cholesterol_mg, omega3_g, added_sugars_g, starch_g, polyols_g, vitamin_a_ug, vitamin_d_ug, vitamin_e_mg, vitamin_k_ug, vitamin_c_mg, vitamin_b1_mg, vitamin_b2_mg, vitamin_b6_mg, vitamin_b9_ug, vitamin_b12_ug, vitamin_pp_mg, pantothenic_acid_mg, potassium_mg, calcium_mg, phosphorus_mg, iron_mg, magnesium_mg, zinc_mg, copper_mg, manganese_mg, selenium_ug, iodine_ug, caffeine_mg, choline_mg, nutriscore_grade, nutriscore_score, nova_group, ecoscore_grade, ecoscore_score, food_groups, source_supermarket, data_source, serving_size, serving_unit, is_global)
VALUES ('2304277003138', 'Contramuslo de pavo', NULL, 'mercadona', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 115.9, 3.1, 1.2, 0.0, 0.0, NULL, 22.0, 0.21, 0.084, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2303456003617', 'Pinchos', NULL, 'mercadona', 'Productos a base de carne', NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 91.0, 1.0, 0.4, 0.8, 0.7, NULL, 19.7, 1.9, 0.76, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 3, NULL, 'u', NULL, 'en:meat-other-than-poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302794003723', 'Filete de pechuga de Pavo', NULL, 'mercadona', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 469.0, 1.3, 0.5, 0.0, 0.0, NULL, 25.0, 0.2, 0.08, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('5010365001999', 'Alas de pollo congeladas', NULL, 'mercadona', NULL, '1 kg', NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 212.0, 15.0, 3.5, 1.0, 0.1, NULL, 19.0, 0.23, 0.092, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2325460002783', 'Pollo de Corral', NULL, 'mercadona', 'Productos a base de carne', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'e', 22, 'en:poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302815002032', 'PANCETA', NULL, 'mercadona', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 305.0, 26.5, 9.8, 0.5, 0.5, NULL, 16.7, 0.18, 0.072, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('236847320000100434001651', '8 magdalenas', NULL, 'mercadona', 'Botanas', NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 418.0, 23.0, 3.2999999523163, 46.0, 29.0, NULL, 6.8000001907349, 0.33000001311302, 0.132, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 17, NULL, 'b', 60, 'en:biscuits-and-cakes', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302832002770', 'Alas de pollo adobadas', NULL, 'Mercadona', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 140.0, 7.0, 2.2, 3.1, 0.6, NULL, 16.2, 2.0, 0.8, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('232848370000100100001004', 'Mini atún queso', NULL, 'Mercadona', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('230582740011603450004003', 'Jamón serrano a cuchillo reserva', NULL, 'Mercadona', 'Productos a base de carne', NULL, NULL, 'Sin gluten, Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 300.0, 18.7, 6.8, 1.0, 0.5, NULL, 31.8, 3.6, 1.44, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 26, NULL, 'f', -5, 'en:processed-meat', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302833003493', 'Pechuga de pollo finas hierbas marinada', NULL, 'mercadona', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 86.0, 1.1, 0.4, 1.2, 0.1, NULL, 17.6, 2.0, 0.8, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('230583370010012500012506', 'Jamón de bellota ibérico', NULL, 'Mercadona', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 350.2, 23.0, 8.9, 0.8, 0.5, NULL, 35.0, 4.5, 1.8, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('8480000592637', 'Presunto Serrano grande réserva', NULL, 'Mercadona', 'Viandes et dérivés', NULL, NULL, 'Point Vert', NULL, NULL, NULL, NULL, NULL, NULL, 261.0, 13.0, 5.0, 3.5, 0.0, 0.0, 35.0, 5.0, 2.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 27, NULL, 'f', -5, 'en:processed-meat', 'Mercadona', 'open_food_facts', 100, 'g', true), ('7171717867767', 'Mercadona', NULL, 'Mercadona', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2320177006963', 'Pechuga entera', NULL, 'mercadona', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 108.0, 1.7, 0.5, 0.9, 0.7, NULL, 22.3, 0.3, 0.12, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302836003605', 'Pechuga de pavo pimentón', NULL, 'mercadona', NULL, NULL, NULL, 'Sin gluten, Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 104.2, 1.0, 0.4, 3.2, 0.0, NULL, 20.6, 1.51, 0.604, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302862002610', 'Longaniza pollo fresca', NULL, 'mercadona', NULL, NULL, NULL, 'Sin gluten, Punto Verde', NULL, NULL, NULL, NULL, NULL, 545.0, 130.0, 6.0, 1.8, 0.8, 0.5, NULL, 16.0, 1.8, 0.72, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302833003745', 'Pechuga finas hierbas marinadas', NULL, 'mercadona', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 87.0, 1.1, 0.4, 1.2, 0.1, NULL, 17.6, 2.0, 0.8, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('236847280000100700002105', 'Madalena SG sin lactosa', NULL, 'Mercadona', 'Botanas', '300g', 'Plástico  papel', 'Sin gluten, en:Gluten-freeSin lactosa', NULL, 'Tavernes Blanques', 'Español: MAGDALENAS SIN GLUTEN SIN-LACTOSA. INGREDIENTES: HUEVO líquido pasteurizado, azúcar, aceite de girasol, harina de arroz, almidón de maíz, harina de maíz, fécula de tapioca, gasificante (bicarbonato de sodio, difosfato disódico, carbonato cálcico), jarabe de glucosa y fructosa, aroma, espesante (goma xantana, goma guar), humectante (sorbitol), emulgente (mono y diglicéridos de los ácidos grasos). Producto listo para su consumo. Portuges: MADALENA SEM GLÚTEN SEM-LACTOSE. INGREDIENTES: OVO liquido pasteurizado, açúcar, óleo de girassol, farinha de arroz, amido de milho, farinha de milho, amido de tapioca, agente de aumento (bicarbonato de sódio, difosfato dissódico, carbonato de cálcio), xarope de glicose e frutose, aromatizante, espessante (goma xantana, goma guar), umectante (sorbitol), emulsificante (mono e diglicerídeos de ácidos gordos).Prodoto listo para o seu consumo.', 'Huevos, Leche', 'Huevos', 1830.0, 437.0, 22.1, 2.9, 54.1, 26.1, NULL, 4.2, 1.41, 0.564, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 21, 4, 'u', NULL, 'en:biscuits-and-cakes', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2303400005025', 'Pechuga de pollo', NULL, 'Mercadona', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 106.0, 1.8, 0.5, 0.0, 0.0, NULL, 22.0, 0.16, 0.064, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302786003779', 'Solomillos', NULL, 'mercadona', 'Productos a base de carne', NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 457.0, 1.7, 0.5, 0.9, 0.7, NULL, 25.3, 0.3, 0.12, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -1, NULL, 'e', 22, 'en:poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('8436021415035', 'Burger de pollo y zanahoria', NULL, 'mercadona', 'Productos a base de carne', '240 g', NULL, 'Sin gluten, Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 131.0, 5.9, 1.8, 5.3, 1.5, NULL, 14.2, 2.1, 0.84, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 12, NULL, 'e', 22, 'en:poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302811003446', 'Costilla Carnosa', NULL, 'mercadona', 'Productos a base de carne', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 279.0, 23.60000038147, 9.3000001907349, 0.0, 0.0, NULL, 17.10000038147, 0.18, 0.072, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 12, NULL, 'u', NULL, 'en:meat-other-than-poultry', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2325353001640', 'Pavo. Solomillo marinado congelado', NULL, 'mercadona', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 102.0, 1.1, 0.4, 27.0, 0.0, NULL, 20.5, 0.82, 0.328, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302820003352', 'Solomillo de cerdo', NULL, 'mercadona', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 131.0, 5.1, 2.05, 0.0, 0.0, NULL, 21.0, 13.0, 5.2, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true)
ON CONFLICT (barcode) WHERE barcode IS NOT NULL DO UPDATE SET
    name = EXCLUDED.name,
    generic_name = COALESCE(EXCLUDED.generic_name, foods.generic_name),
    brand = COALESCE(EXCLUDED.brand, foods.brand),
    category = COALESCE(EXCLUDED.category, foods.category),
    ingredients_text = COALESCE(EXCLUDED.ingredients_text, foods.ingredients_text),
    allergens = COALESCE(EXCLUDED.allergens, foods.allergens),
    calories = COALESCE(EXCLUDED.calories, foods.calories),
    protein_g = COALESCE(EXCLUDED.protein_g, foods.protein_g),
    carbs_g = COALESCE(EXCLUDED.carbs_g, foods.carbs_g),
    fat_g = COALESCE(EXCLUDED.fat_g, foods.fat_g),
    fiber_g = COALESCE(EXCLUDED.fiber_g, foods.fiber_g),
    nutriscore_grade = COALESCE(EXCLUDED.nutriscore_grade, foods.nutriscore_grade),
    nova_group = COALESCE(EXCLUDED.nova_group, foods.nova_group),
    updated_at = now();