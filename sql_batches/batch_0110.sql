INSERT INTO foods (barcode, name, generic_name, brand, category, quantity, packaging, labels, origins, manufacturing_places, ingredients_text, allergens, traces, energy_kj, calories, fat_g, saturated_fat_g, carbs_g, sugars_g, fiber_g, protein_g, salt_g, sodium_mg, alcohol_g, monounsaturated_fat_g, polyunsaturated_fat_g, trans_fat_g, cholesterol_mg, omega3_g, added_sugars_g, starch_g, polyols_g, vitamin_a_ug, vitamin_d_ug, vitamin_e_mg, vitamin_k_ug, vitamin_c_mg, vitamin_b1_mg, vitamin_b2_mg, vitamin_b6_mg, vitamin_b9_ug, vitamin_b12_ug, vitamin_pp_mg, pantothenic_acid_mg, potassium_mg, calcium_mg, phosphorus_mg, iron_mg, magnesium_mg, zinc_mg, copper_mg, manganese_mg, selenium_ug, iodine_ug, caffeine_mg, choline_mg, nutriscore_grade, nutriscore_score, nova_group, ecoscore_grade, ecoscore_score, food_groups, source_supermarket, data_source, serving_size, serving_unit, is_global)
VALUES ('236845390000100700003506', 'Empanada de atún', NULL, 'Mercadona', 'Empanadas', NULL, NULL, NULL, NULL, 'Lugo', 'HARINA DE TRIGO,CEBOLLA FRITA(CEBOLLA, ACEITE DE OLIVA VIRGEN, SAL, CORRECTOR DE ACIDEZ (E330), ESPESANTES E415, E410, E412) DEXTROSA), ATUN EN ACEITE DE GIRASOL(25% (ATUN, ACEITE DE GIRASOL Y SAL), ACEITE DE GIRASOL, LECHE UHT ENTERA, VINO, PIMIENTO, FRITADA DE VERDURAS EN ACEITE DE OLIVA(BERENJENA, CALABACIN, TOMATE, CEBOLLA, PiMIENTO, ACElTE DE OLIVA VIRGEN, SAL, CORRECTOR DE ACIDEZ E330, ESPESANTES (E410, E412,E415)) HUEVO LIQUIDO ENTERO PASTEURIZADO Y YEMA DE HUEVO LIQUIDA PASTEURIZADA, AZUCAR, SAL(SAL REFINADO Y ANTIAGLOMERANTE E535) PIMENTON DULCE', 'Huevos, Pescado, Gluten, Leche', 'Moluscos', NULL, 263.0, 11.0, 1.4, 32.0, 3.9, NULL, 8.9, 1.1, 0.44, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 7, 4, 'u', NULL, 'en:pizza-pies-and-quiches', 'Mercadona', 'open_food_facts', 100, 'g', true), ('232847810000100350003508', 'Empanada de pollo y setas', NULL, 'Mercadona', 'Pastissos', NULL, NULL, NULL, NULL, NULL, 'FARINA DE BLAT, CEBA FREGIDA (CEBA. OLI D''OLIVA VERGE, SAL CORRECTIU DE L''ACIDESA E330, ESPESSIDORS (E415, E410 E412) DEXTROSA), CARN DE POLLASTRE(14%), FORMATGE BLANC PASTEURITZAT EXTRAGRAS (LET DE MANTEGA, LLET, NATA PASTEURITZADA DE VACA (LLET) SOLIDS LACTIS, SAL, ESTABILITZADOR E410, CONSERVADOR E200, FERMENTS LACTIS) OLI DE GIRA-SOL, LLET UHT SENCERA, VI, BOLET CULTIVAT (3 )(PLEUROTUS OSTREATUS (ORELLANA)), OU LIQUID SENCER PASTÈURITZAT I ROVELL D''OU LIQUID PASTEURITZAT, SUCRE, SAL (SAL REFINADA I ANTIAGLOMERANT E535), ESPECIES.CONTE TRACES DE PEIX, MOL-LUSCS', 'en:Eggs, en:Milk, en:Molluscs', NULL, NULL, 261.0, 12.0, 2.9, 31.0, 3.5, NULL, 7.4, 1.2, 0.48, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 11, 4, 'u', NULL, 'en:pizza-pies-and-quiches', 'Mercadona', 'open_food_facts', 100, 'g', true), ('232845390000100350003507', 'Empanada de atún', NULL, 'Mercadona', 'Empanadas', NULL, NULL, NULL, NULL, NULL, 'HARINA DE TRIGO, CEBOLLA FRITA (CEBOLLA, ACEITE DE OLIVA VIRGEN, SAL, CORRECTOR DE ACIDEZ E330, ESPESANTES (E415, E410, E412), DEXTROSA), ATÚN EN ACEITE DE GIRASOL (15%) (ATÜN ,ACEITE DE GIRASOL Y SAL), ACEITE DE GIRASOL, LECHE UHT ENTERA, VINO, PIMIENTO, FRITADA DE VERDURAS EN ACEITE DE OLIVA (BERENJENA, CALABACÍN,  TOMATE, CEBOLLA, PIMIENTO, ACEITÉ DE OLIVA VIRGEN, SAL, CORRECTOR DE ACIDEZ E330, ESPESANTES (E410 E412, E415)),HUEVO LIQUIDO ENTERO PASTEURIZADO Y YEMA DE HUEVO LIQUIDA PASTEURIZADA, AZÚCAR, SAL (SAL REFINADO Y ANTIAGLOMERANTE E535), PIMENTÓN DULCE', 'Huevos, Pescado, Gluten, Leche', 'Moluscos', NULL, 262.6, 11.0, 1.4, 32.0, 3.9, NULL, 8.9, 1.1, 0.44, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 7, 4, 'u', NULL, 'en:pizza-pies-and-quiches', 'Mercadona', 'open_food_facts', 100, 'g', true), ('232846990000100229002298', 'Bizcocho de chocolate', NULL, 'Mercadona', 'Botanas', '440 g', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 362.0, 17.0, 4.3, 45.0, 30.0, NULL, 6.6, 0.66, 0.264, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 19, NULL, 'd', 40, 'en:biscuits-and-cakes', 'Mercadona', 'open_food_facts', 100, 'g', true), ('8480000584700', 'Chorizo extra Salamanca', NULL, 'mercadona', 'Productos a base de carne', '440 g', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'e', 15, 'en:processed-meat', 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302832002831', 'ALAS ADOBADAS', NULL, 'mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 140.0, 7.0, 2.2, 3.1, 0.6, NULL, 16.2, 2.0, 0.8, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302075002933', 'Longaniza fresca', NULL, 'mercadona', NULL, NULL, NULL, 'Sin gluten, Sin lactosa', NULL, NULL, NULL, NULL, NULL, NULL, 233.0, 19.6, 7.6, 1.6, 0.5, NULL, 12.5, 2.5, 1.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2310000004846', 'Medio Pollo Troceado', NULL, 'mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 129.0, 4.4, 1.4, 0.5, 0.5, NULL, 22.4, 0.1, 0.04, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302862003112', 'Longaniza pollo fresca', NULL, 'mercadona', NULL, NULL, NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, 130.0, 6.0, 1.8, 0.8, 0.5, NULL, 16.0, 1.8, 0.72, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2325926003767', 'Pavo (Solomillo)', NULL, 'mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 455.2, 1.2, 0.4, 0.0, 0.0, NULL, 24.5, 0.0, 0.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('231044160065600540003549', 'Butifarra fresca de pages con pimienta', NULL, 'mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 222.0, 18.0, 6.0, 2.0, 0.5, NULL, 13.0, 1.8, 0.72, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2303753006090', 'Cadera de vacuno', NULL, 'mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 122.0, 3.5, 1.5, 0.5, 0.5, NULL, 23.0, 0.17, 0.068, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('230583510012604000005041', 'Jamón Gran Reserva', NULL, 'mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 250.0, 12.0, 3.8, 0.5, 0.5, NULL, 35.0, 6.0, 2.4, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302848002986', 'Chuleta contramuslo de pavo', NULL, 'mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 148.8, 7.6, 2.7, 0.0, 0.0, NULL, 20.1, 0.23, 0.092, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302857000973', 'Hígados y corazones de pollo', NULL, 'mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 414.0, 3.403, 1.3, 0.5, 0.5, NULL, 16.8, 0.3, 0.12, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2325365001669', 'Solomillo de pavo', NULL, 'mercadona', NULL, NULL, NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, 102.7, 1.1, 0.4, 2.7, 0.0, NULL, 20.5, 0.8, 0.32, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2304398002447', 'Jamoncito de ala', NULL, 'mercadona', NULL, NULL, NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, 156.0, 8.5, 2.4, 2.7, 0.7, NULL, 17.1, 2.4, 0.96, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302815002155', 'Panceta', NULL, 'mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2303682004686', 'Pechuga de pollo', NULL, 'mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2304918004692', 'Filete lomo iberico', NULL, 'mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('231029700062800452002841', 'Contramuslo marinado de pollo con piel', NULL, 'mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 206.0, 14.8, 4.6, 3.3, 1.1, NULL, 15.3, 1.5, 0.6, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302785002667', 'Alas partidas', NULL, 'mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 155.0, 8.5, 2.7, 0.6, 0.0, NULL, 19.0, 0.2, 0.08, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2303724003639', 'Pechuga pollo', NULL, 'mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 90.0, 1.0, 0.0, 0.5, 0.5, NULL, 22.0, 0.177, 0.0708, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('231027930054500320001740', 'Chuleta de Contramuslos de Pavo', NULL, 'mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 148.0, 7.6, 2.7, 0.0, 0.0, NULL, 20.1, 0.23, 0.092, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true), ('2302793002864', 'Pavo chuleta de contramuslo', NULL, 'mercadona', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 149.0, 8.0, 3.0, 0.0, 0.0, NULL, 20.0, 0.23, 0.092, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Mercadona', 'open_food_facts', 100, 'g', true)
ON CONFLICT (barcode) WHERE barcode IS NOT NULL DO UPDATE SET
    name = EXCLUDED.name,
    generic_name = COALESCE(EXCLUDED.generic_name, foods.generic_name),
    brand = COALESCE(EXCLUDED.brand, foods.brand),
    category = COALESCE(EXCLUDED.category, foods.category),
    ingredients_text = COALESCE(EXCLUDED.ingredients_text, foods.ingredients_text),
    allergens = COALESCE(EXCLUDED.allergens, foods.allergens),
    calories = COALESCE(EXCLUDED.calories, foods.calories),
    protein_g = COALESCE(EXCLUDED.protein_g, foods.protein_g),
    carbs_g = COALESCE(EXCLUDED.carbs_g, foods.carbs_g),
    fat_g = COALESCE(EXCLUDED.fat_g, foods.fat_g),
    fiber_g = COALESCE(EXCLUDED.fiber_g, foods.fiber_g),
    nutriscore_grade = COALESCE(EXCLUDED.nutriscore_grade, foods.nutriscore_grade),
    nova_group = COALESCE(EXCLUDED.nova_group, foods.nova_group),
    updated_at = now();