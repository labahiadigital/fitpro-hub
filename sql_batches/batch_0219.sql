INSERT INTO foods (barcode, name, generic_name, brand, category, quantity, packaging, labels, origins, manufacturing_places, ingredients_text, allergens, traces, energy_kj, calories, fat_g, saturated_fat_g, carbs_g, sugars_g, fiber_g, protein_g, salt_g, sodium_mg, alcohol_g, monounsaturated_fat_g, polyunsaturated_fat_g, trans_fat_g, cholesterol_mg, omega3_g, added_sugars_g, starch_g, polyols_g, vitamin_a_ug, vitamin_d_ug, vitamin_e_mg, vitamin_k_ug, vitamin_c_mg, vitamin_b1_mg, vitamin_b2_mg, vitamin_b6_mg, vitamin_b9_ug, vitamin_b12_ug, vitamin_pp_mg, pantothenic_acid_mg, potassium_mg, calcium_mg, phosphorus_mg, iron_mg, magnesium_mg, zinc_mg, copper_mg, manganese_mg, selenium_ug, iodine_ug, caffeine_mg, choline_mg, nutriscore_grade, nutriscore_score, nova_group, ecoscore_grade, ecoscore_score, food_groups, source_supermarket, data_source, serving_size, serving_unit, is_global)
VALUES ('8414807519214', 'Torreznos Consum', NULL, 'Consum', 'Fritos', '150 g', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 621.0, 50.0, 17.4, 0.1, 0.1, NULL, 42.0, 4.44, 1.776, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 37, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807100160', 'Helado vainilla', NULL, 'Consum', 'Postres', '495 g', NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, 187.0, 8.8, 6.4, 24.0, 21.0, NULL, 2.3, 1.6, 0.64, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 21, NULL, 'b', 67, 'en:ice-cream', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807540836', 'Isco go', NULL, 'Consum', NULL, '33 cl', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 22.0, 0.0, 0.0, 5.3, 5.3, NULL, 0.0, 0.1, 0.04, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('2603305000751', 'Empanada de pisto', NULL, 'consum', NULL, NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 329.0, 18.0, 2.2, 31.0, 3.5, NULL, 7.9, 0.96, 0.384, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807547941', 'Palmito entero', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', NULL, NULL, NULL, NULL, NULL, 'Palmito, agua, sal y acidulante: ácido cítrico.', NULL, NULL, NULL, 15.0, 0.0, 0.0, 5.0, 1.0, 1.0, 2.0, 0.5, 0.2, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -3, 3, 'u', NULL, 'en:one-dish-meals', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807514325', 'Sel iodé', NULL, 'Consum', 'Condimentos', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 0.0, 0.0, 0.0, 0.0, 0.0, NULL, 0.0, 0.0, 0.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'n', NULL, 2, 'a', 78, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807520456', 'Gazpacho', NULL, 'Consum', 'Plant-based foods and beverages', '330ml', NULL, 'No gluten', NULL, NULL, 'Hortalizas frescas 96,5% (Tomate, pimiento, pepino y cebolla), aceite de oliva virgen extra 2%, vinagre de vino, sal y ajo,', NULL, NULL, NULL, 37.0, 2.2, 0.3, 2.9, 1.9, NULL, 0.9, 0.8, 0.32, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'b', 1, 3, 'a', 78, 'en:soups', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807500472', 'Miel de azahar', NULL, 'Consum', 'Desayunos', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, 2, 'b', 72, 'en:sweets', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807531612', 'Yogur griego azucarado', NULL, 'Consum', 'Lácteos', NULL, NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, 135.0, 8.5, 5.5, 11.5, 11.5, NULL, 3.2, 0.1, 0.04, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 8, NULL, 'b', 67, 'en:milk-and-yogurt', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807515995', 'Aceitunas verdes', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 153.0, 16.0, 3.0, 0.1, 0.1, NULL, 1.0, 3.7, 1.48, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 21, NULL, 'a', 75, 'en:salty-and-fatty-products', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807520432', 'Copos de maíz azucarados', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 376.0, 0.7, 0.3, 84.5, 24.2, NULL, 6.5, 0.75, 0.3, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 14, NULL, 'e', 25, 'en:breakfast-cereals', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807532008', 'Néctar Piña Light', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', NULL, NULL, 'Sin gluten, Con edulcorantes', NULL, NULL, 'Zumo de piña a partir de concentrado (50%), agua, acidulante: ácido cítrico, estabilizante: pectina, edulcorantes (E-952, E-954) y vitaminas A, C y E.', NULL, NULL, NULL, 23.0, 0.0, 0.0, 5.4, 5.4, 0.1, 0.3, 0.03, 0.012, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 8, 4, 'e', 21, 'en:artificially-sweetened-beverages', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807531094', 'Té verde', NULL, 'Consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 1.0, 0.0, 0.0, 0.2, 0.0, NULL, 0.1, 0.0, 0.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807525925', 'Agua mineral con gas', NULL, 'Consum', 'Bebidas', NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 0.0, 0.0, 0.0, 0.0, 0.0, NULL, 0.0, 0.0, 0.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', 0, 1, 'n', NULL, 'en:waters-and-flavored-waters', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807546029', 'Pate de atún', NULL, 'Consum', 'Productos del mar', NULL, NULL, NULL, NULL, NULL, 'C consum Pale ATUN Tonyina 1', 'Pescado', NULL, NULL, 218.0, 17.0, 1.9, 4.5, 1.0, NULL, 11.0, 1.2, 0.48, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 4, NULL, 'e', 21, 'en:processed-meat', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807544469', 'Cola cero consum', NULL, 'Consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 0.4, 0.0, 0.0, 0.1, 0.1, 0.0, 0.0, 0.0, 0.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807545541', 'Tiramisu', NULL, 'Consum', 'Lácteos', NULL, NULL, NULL, NULL, NULL, 'Leche desnatada reconstituida, azúcar, agua, galleta de Saboya 9,4% (harina de trigo, huevo, azúcar, proteinas de la leche, gasificantes (trigo): difosfatos, carbonatos de sodio), grasa de coco, queso mascarpone 5,5% (nata y acidulante: ácido láctico), proteínas de la leche, alcohol, yema de huevo, estăbilizante: sorbitoles, preparado de cacao 1,3% (cacao en polvo (0,6%), dextrosa, almidón de trigo, azúcar, manteca de cacao), vino marsala, café soluble (0,6%), almidón de tapioca, espesantes: alginato sódico, goma garrofin, goma xantana, emulsionante: mono y diglicéridos de ácidos grasos: aromas, Puede contener trazas de frutos de cáscara (avellana, almendra y pistacho) y soja, Alcohol 1,4%, Alérgenos: Ver destacado en lista de ingredientes (negrita),', 'Huevos, Gluten, Leche, Frutos de cáscara', 'Huevos, Gluten, Leche, Frutos de cáscara, Soja', NULL, 221.0, 9.6, 9.6, 28.0, 21.0, 0.6, 3.4, 0.24, 0.096, 1.4, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 21, 4, 'f', -2, 'en:biscuits-and-cakes', 'Consum', 'open_food_facts', 100, 'g', true), ('2602476002298', 'Pastel de boniato', NULL, 'Consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 306.0, 8.4, 1.1, 53.2, 23.6, NULL, 2.9, 0.39, 0.156, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807511508', 'Jamon cocido extra', NULL, 'Consum', 'Productos a base de carne', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 105.0, 3.0, 0.9, 1.5, 1.5, NULL, 18.0, 2.0, 0.8, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 3, NULL, 'f', 12, 'en:processed-meat', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807541598', 'Yogur cremoso natural edulcorado', NULL, 'Consum', 'Lácteos', NULL, NULL, 'Punto Verde', NULL, NULL, NULL, NULL, NULL, NULL, 50.0, 0.1, 0.1, 6.0, 6.0, NULL, 6.2, 0.2, 0.08, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -1, NULL, 'b', 67, 'en:milk-and-yogurt', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807520388', 'Tomato y orégano', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', '160 g', NULL, 'Punto Verde', NULL, NULL, 'Harina de trigo (gluten), aceite de girasol (15%), tomate deshidratado (6%), aceite de girasol alto oleico (5%), azúcar, extracto de malta de cebada (gluten) y maíz, sal, levadura, orégano (0.3%), y agente de tratamiento de la harina: ácido ascórbico.', 'Gluten', NULL, 2051.0, 490.0, 24.0, 2.5, 59.0, 4.5, 3.0, 8.0, 1.0, 0.4, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 13, 3, 'b', 72, 'en:bread', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807518088', 'Baguette rústica', NULL, 'Consum', 'Plant-based foods and beverages', NULL, NULL, NULL, NULL, NULL, 'Harina de trigo (gluten), agua, levadura, harina de centeno (gluten), sal,', 'Gluten', NULL, NULL, 284.0, 1.7, 0.3, 56.0, 1.6, NULL, 9.1, 1.71, 0.684, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 11, 3, 'u', NULL, 'en:bread', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807541567', 'Yogur Líquido', NULL, 'Consum', 'Bebidas', '1000 g', NULL, 'Sin gluten, Punto Verde, Sin azúcares añadidos', NULL, NULL, NULL, NULL, NULL, NULL, 30.0, 0.1, 0.1, 3.8, 3.6, NULL, 2.9, 0.1, 0.04, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'b', -1, NULL, 'e', 17, 'en:milk-and-yogurt', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807536426', 'Rallado de surimi', NULL, 'Consum', NULL, NULL, NULL, 'Sin gluten, Sin lactosa', NULL, NULL, NULL, NULL, NULL, NULL, 90.0, 3.6, 0.7, 5.2, 1.7, NULL, 9.0, 2.0, 0.8, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807510365', 'Chóvar agua mineral natural', NULL, 'Consum', 'Bebidas', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 0.0, 0.0, 0.0, 0.0, 0.0, NULL, 0.0, 0.0, 0.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', 0, 1, 'n', NULL, 'en:waters-and-flavored-waters', 'Consum', 'open_food_facts', 100, 'g', true)
ON CONFLICT (barcode) WHERE barcode IS NOT NULL DO UPDATE SET
    name = EXCLUDED.name,
    generic_name = COALESCE(EXCLUDED.generic_name, foods.generic_name),
    brand = COALESCE(EXCLUDED.brand, foods.brand),
    category = COALESCE(EXCLUDED.category, foods.category),
    ingredients_text = COALESCE(EXCLUDED.ingredients_text, foods.ingredients_text),
    allergens = COALESCE(EXCLUDED.allergens, foods.allergens),
    calories = COALESCE(EXCLUDED.calories, foods.calories),
    protein_g = COALESCE(EXCLUDED.protein_g, foods.protein_g),
    carbs_g = COALESCE(EXCLUDED.carbs_g, foods.carbs_g),
    fat_g = COALESCE(EXCLUDED.fat_g, foods.fat_g),
    fiber_g = COALESCE(EXCLUDED.fiber_g, foods.fiber_g),
    nutriscore_grade = COALESCE(EXCLUDED.nutriscore_grade, foods.nutriscore_grade),
    nova_group = COALESCE(EXCLUDED.nova_group, foods.nova_group),
    updated_at = now();