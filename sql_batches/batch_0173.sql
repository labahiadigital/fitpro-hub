INSERT INTO foods (barcode, name, generic_name, brand, category, quantity, packaging, labels, origins, manufacturing_places, ingredients_text, allergens, traces, energy_kj, calories, fat_g, saturated_fat_g, carbs_g, sugars_g, fiber_g, protein_g, salt_g, sodium_mg, alcohol_g, monounsaturated_fat_g, polyunsaturated_fat_g, trans_fat_g, cholesterol_mg, omega3_g, added_sugars_g, starch_g, polyols_g, vitamin_a_ug, vitamin_d_ug, vitamin_e_mg, vitamin_k_ug, vitamin_c_mg, vitamin_b1_mg, vitamin_b2_mg, vitamin_b6_mg, vitamin_b9_ug, vitamin_b12_ug, vitamin_pp_mg, pantothenic_acid_mg, potassium_mg, calcium_mg, phosphorus_mg, iron_mg, magnesium_mg, zinc_mg, copper_mg, manganese_mg, selenium_ug, iodine_ug, caffeine_mg, choline_mg, nutriscore_grade, nutriscore_score, nova_group, ecoscore_grade, ecoscore_score, food_groups, source_supermarket, data_source, serving_size, serving_unit, is_global)
VALUES ('8414807552891', 'Burguera mest pollo queso', NULL, 'Consum', NULL, NULL, NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, 184.0, 11.3, 4.1, 4.3, 0.5, NULL, 16.2, 1.93, 0.772, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807514196', 'Berberechos al natural', 'Berberechos al natural. Tamaño pequeño', 'Consum', 'Productos del mar', '111 g', NULL, 'Punto Verde, Fuente de hierro, Fuente de magnesio', NULL, NULL, '_Berberechos_ (_moluscos_), agua, sal.', 'Moluscos, Berberechos', 'Crustáceos', 200.0, 47.0, 0.5, 0.1, 0.0, 0.0, NULL, 10.7, 1.5, 0.6, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 24.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 3, 3, 'u', NULL, 'en:fish-and-seafood', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807520302', 'Tarta Whisky', NULL, 'Consum', 'Lácteos', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 204.0, 8.9, 7.2, 28.0, 24.0, 0.3, 2.5, 0.235, 0.094, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 16, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807557605', 'Turrón De Alicante', NULL, 'Consum', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 557.0, 35.0, NULL, 45.0, 40.0, NULL, 12.0, 0.05, 0.02, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'u', NULL, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807541079', 'Digestive chocolate con leche', 'Galletas de trigo recubiertas de chocolate con leche', 'Consum', 'Botanas', '300 g', NULL, 'Fuente de fibra alimentaria, Punto Verde, Con aceite de girasol', NULL, NULL, 'Harina de _trigo_ 48% (_gluten_), cobertura de chocolate con _leche_ 24% (azúcar, manteca de cacao, pasta de cacao, _leche_ en polvo, suero de _leche_ en polvo, emulgente (lecitina de _soja_), aroma), aceite girasol alto oleico 13%, azúcar, jarabe de glucosa y fructosa, salvado de _trigo_ 4% (_gluten_), gasificantes (carbonato ácido de sodio, carbonato ácido de amonio, ácido tartárico), sal.', 'Gluten, Leche, Soja', 'Mostaza, Frutos de cáscara', 1942.0, 463.0, 20.0, 6.0, 63.0, 26.0, 3.6, 6.0, 1.4, 0.56, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 22, 4, 'd', 37, 'en:biscuits-and-cakes', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807500441', 'Miel de mil flores', 'Miel mil flores', 'Consum', 'Desayunos', '1 kg', NULL, 'FSC, FSC Mixto, Punto Verde', 'Unión Europea y no Unión Europea', NULL, 'Miel.', NULL, NULL, 1411.0, 332.0, 0.0, 0.0, 83.0, 74.3, 0.0, 0.0, 0.0, 0.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 19, 2, 'b', 72, 'en:sweets', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807551597', 'Flan Vainilla 0%', NULL, 'consum', 'Lácteos', NULL, NULL, 'Sin gluten, Sin azúcares añadidos', NULL, NULL, NULL, NULL, NULL, NULL, 54.0, 0.0, 0.0, 10.0, 5.3000001907349, NULL, 3.2999999523163, 0.3, 0.12, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'b', 1, NULL, 'u', NULL, 'en:dairy-desserts', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807546906', 'Ensalada de pasta y pollo', NULL, 'Consum', 'Comidas preparadas', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 182.0, 5.0, 1.4, 24.5, 5.7, NULL, 8.9, 0.55, 0.22, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 3, NULL, 'u', NULL, 'en:one-dish-meals', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807521774', 'Consum L-Casei', NULL, 'Consum', 'Bebidas', NULL, NULL, 'Fuente de vitamina B6, Fuente de vitamina D', NULL, NULL, 'LECHE FERMENTADA CON FRESA. : Leche parcialmente desnatada (90,2%), azúcar, Zumo de fresa (2,1%), dextrosa, aroma, almidón modificado, colorantes: E163, E120; L. casei y otros fermentos lácticos, espesante: goma garrofín; vitamina B6 y D, proteínas de la leche. Origen de la leche: Fsnaña.', 'Leche', NULL, NULL, 78.0, 1.5, 1.0, 13.6, 13.6, NULL, 2.6, 0.09, 0.036, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 12, 4, 'u', NULL, 'en:milk-and-yogurt', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807521781', 'L-Casei natural', NULL, 'Consum', 'Lácteos', '12 x 100 g', NULL, 'Sin gluten, Fuente de vitamina B6, Fuente de vitamina D', NULL, NULL, NULL, NULL, NULL, NULL, 78.0, 1.6, 1.0, 13.2, 13.2, NULL, 2.6, 0.09, 0.036, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'b', 2, NULL, 'b', 67, 'en:milk-and-yogurt', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807542076', 'Avellana cruda', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', NULL, NULL, 'Sin gluten, Fuente de fósforo, Fuente de vitamina E', NULL, NULL, NULL, NULL, NULL, NULL, 683.0, 63.0, 5.1999998092651, 5.5999999046326, 3.2999999523163, NULL, 19.299999237061, 0.0099999997764826, 0.004, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -6, NULL, 'e', 16, 'en:nuts', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807515216', 'pipas', NULL, 'Consum', 'Pipas peladas', NULL, NULL, 'Sin gluten, Fuente de fósforo, Fuente de vitamina E', NULL, NULL, NULL, NULL, NULL, NULL, 606.0, 49.6, 6.2, 6.8, 2.6, NULL, 26.0, 1.7, 0.68, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 21, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807526618', 'Pipas Gigantes Aguasal', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', NULL, NULL, 'Sin gluten, Fuente de fósforo, Fuente de vitamina E', NULL, NULL, NULL, NULL, NULL, NULL, 612.0, 50.1, 5.2, 3.5, 3.5, NULL, 30.9, 2.0, 0.8, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 12, NULL, 'd', 43, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807502087', 'Pipas con sal', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', NULL, NULL, 'Sin gluten, Fuente de fósforo, Fuente de vitamina E', NULL, NULL, NULL, NULL, NULL, NULL, 637.0, 52.5, 5.4000000953674, 8.8999996185303, 0.0, NULL, 28.89999961853, 2.2000000476837, 0.88, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 13, NULL, 'd', 43, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807503534', 'Maíz para palomitas', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', NULL, NULL, 'Sin gluten, Fuente de vitamina E', NULL, NULL, NULL, NULL, NULL, NULL, 334.0, 3.6, 0.6, 59.0, 1.2, NULL, 10.0, 0.0, 0.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'b', -2, NULL, 'u', NULL, 'en:cereals', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807501899', 'Fruta & fibra integral', NULL, 'Consum', 'Alimentos y bebidas de origen vegetal', NULL, NULL, 'Fuente de fibra alimentaria', NULL, NULL, NULL, NULL, NULL, NULL, 379.0, 6.6, 4.2, 65.7, 18.1, NULL, 9.3, 0.57, 0.228, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 15, NULL, 'e', 25, 'en:breakfast-cereals', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807553232', 'Burger meat Potro', NULL, 'Consum', 'Productos a base de carne', NULL, NULL, 'Sin gluten', NULL, NULL, NULL, NULL, NULL, NULL, 158.0, 8.4, 2.9, 2.5, 0.8, NULL, 18.2, 2.1, 0.84, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 13, NULL, 'u', NULL, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807556547', '4 Quesos', NULL, 'Consum', 'Productes làctics', NULL, NULL, 'Font de proteïna', NULL, NULL, NULL, NULL, NULL, NULL, 360.0, 27.0, 18.0, 2.5, 0.5, NULL, 26.0, 1.6725, 0.669, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 15, NULL, 'd', 35, 'en:cheese', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807553003', 'Galleta & tableta chocolate negro', 'Galleta con chocolate negro', 'Consum', 'Botanas', '150 g', NULL, 'Punto Verde', NULL, NULL, 'Chocolate negro 48% (azúcar, pasta de cacao, manteca de cacao, _lactosa_ (_leche_), materia grasa láctea anhidra (_leche_), emulgente (lecitina de _soja_), aroma natural de vainilla), harina de _trigo_ (_gluten_), azúcar, _mantequilla_ concentrada (_leche_), gasificantes (carbonato ácido de amonio, carbonato ácido de sodio, difosfato disódico), jarabe de glucosa y fructosa, sal, antioxidante (ácido cítrico).', 'Gluten, Leche, Soja', 'Mostaza, Frutos de cáscara', 2075.0, 496.0, 23.0, 15.0, 64.0, 34.0, 4.3, 6.0, 0.35, 0.14, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 24, 4, 'd', 32, 'en:biscuits-and-cakes', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807552358', 'Fiambres sanwich', NULL, 'Consum', 'Productos a base de carne', NULL, NULL, 'Sin gluten', NULL, NULL, 'Paleta y magros de cerdo (56%), agua, almidón, azúcar, estabilizantes (E-407, E-420, E-451, E-508), sal, aromas, antioxidante (E-316), conservador (E-250) y colorante (E-120). Puede contener trazas de soja. ALÉRGENOS Ver destacado en la lista de ingredientes (negrita).', NULL, 'Soja', NULL, 120.0, 4.0, 1.6, 8.4, 1.0, 0.0, 12.5, 1.5, 0.6, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'c', 7, 4, 'u', NULL, 'en:processed-meat', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807556615', 'Avellana y cacao', NULL, 'Consum', 'Postres', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 376.0, 25.0, 14.0, 32.0, 30.0, 1.5, 3.7, 0.15, 0.06, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 22, NULL, 'b', 67, 'en:ice-cream', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807556424', 'Helado proteinas choco cookie', NULL, 'consum', 'Postres', '265', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 140.0, 3.7, 2.4, 15.0, 7.9, 4.5, 8.5, 0.24, 0.096, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'b', 1, NULL, 'b', 67, 'en:ice-cream', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807556981', 'Miel azahar', 'Miel azahar', 'Consum', 'Desayunos', '500 g', NULL, 'FSC, FSC Mixto, Punto Verde', 'España', NULL, 'Miel.', NULL, NULL, 1411.0, 332.0, 0.0, 0.0, 83.0, 74.3, 0.0, 0.0, 0.0, 0.0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'e', 19, 2, 'a', 80, 'en:sweets', 'Consum', 'open_food_facts', 100, 'g', true), ('8414807552471', 'Preparado de carne burguer meat de vacuno', NULL, 'consum', 'Productos a base de carne', NULL, NULL, 'Sin gluten, Sin lactosa', NULL, NULL, 'Carne de vacuno (80%), agua, arroz (4%), sal, fibras vegetales, aromas, antioxidantes: citratos de sodio, ascorbato sódico, Conservador: SULFITO de sodio, Colorante: carmin. pimienta.', 'Dióxido de azufre y sulfitos', NULL, NULL, 215.0, 16.3, 7.5, 1.4, 0.5, NULL, 16.0, 1.6, 0.64, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'd', 16, 4, 'f', -2, NULL, 'Consum', 'open_food_facts', 100, 'g', true), ('8414807553843', 'tortitas consum integral', NULL, 'consum', 'Alimentos y bebidas de origen vegetal', '320 g', NULL, 'Fuente de fibra alimentaria, Punto Verde', NULL, NULL, 'Harina de TRIGO integral (64%), agua, aceite vegetal (girasol), estabilizantes (E-422, E-412, E-466), GLUTEN, corrector de acidez (E-296), emulgente (E-471), conservadores (E-281, E-202), sal, gasificante (E-500) y agente de tratamiento de la harina (E-920).', 'Gluten', NULL, 1226.0, 292.0, 7.5, 1.4, 42.0, 1.9, 9.8, 9.7, 0.88, 0.352, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'a', -1, 4, 'b', 73, 'en:bread', 'Consum', 'open_food_facts', 100, 'g', true)
ON CONFLICT (barcode) WHERE barcode IS NOT NULL DO UPDATE SET
    name = EXCLUDED.name,
    generic_name = COALESCE(EXCLUDED.generic_name, foods.generic_name),
    brand = COALESCE(EXCLUDED.brand, foods.brand),
    category = COALESCE(EXCLUDED.category, foods.category),
    ingredients_text = COALESCE(EXCLUDED.ingredients_text, foods.ingredients_text),
    allergens = COALESCE(EXCLUDED.allergens, foods.allergens),
    calories = COALESCE(EXCLUDED.calories, foods.calories),
    protein_g = COALESCE(EXCLUDED.protein_g, foods.protein_g),
    carbs_g = COALESCE(EXCLUDED.carbs_g, foods.carbs_g),
    fat_g = COALESCE(EXCLUDED.fat_g, foods.fat_g),
    fiber_g = COALESCE(EXCLUDED.fiber_g, foods.fiber_g),
    nutriscore_grade = COALESCE(EXCLUDED.nutriscore_grade, foods.nutriscore_grade),
    nova_group = COALESCE(EXCLUDED.nova_group, foods.nova_group),
    updated_at = now();